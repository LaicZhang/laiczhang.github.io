<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>LaicZhang&#39;s Blog</title>
  
  <subtitle>If you&#39;re prepared to adapt and learn, you can transform.</subtitle>
  <link href="https://zyha.cn/atom.xml" rel="self"/>
  
  <link href="https://zyha.cn/"/>
  <updated>2024-06-23T00:34:08.000Z</updated>
  <id>https://zyha.cn/</id>
  
  <author>
    <name>laiczhang</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>通过Cloudflare-Warp为IPv6-Only的VPS添加IPv4</title>
    <link href="https://zyha.cn/add-ipv4-to-ipv6-only-vps-with-cloudflare-warp/"/>
    <id>https://zyha.cn/add-ipv4-to-ipv6-only-vps-with-cloudflare-warp/</id>
    <published>2024-06-23T00:34:08.000Z</published>
    <updated>2024-06-23T00:34:08.000Z</updated>
    
    <content type="html"><![CDATA[<p>大佬送了个免费小🐔，奈何只支持ipv6，很不方便，所以通过warp来添加ipv4。</p><p>纯IPv6的VPS，意思就是没有IPv4入口和出口。</p><p>没有IPv4入口，意味着大概率无法直接通过SSH访问这个机器去操作，除非你本地网络是支持IPv6的，反正我家里和公司的网络都不支持，没得玩。</p><span id="more"></span><h2 id="查看当前网络是否支持ipv6"><a href="#查看当前网络是否支持ipv6" class="headerlink" title="查看当前网络是否支持ipv6"></a>查看当前网络是否支持ipv6</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">❯ curl -6 ip.sb</span><br><span class="line">2408:8466:340:5d5c:3d79:9428:b928:xxx</span><br></pre></td></tr></table></figure><p>如果有ipv6，则继续往下看。</p><p>如果没有，建议使用手机开热点连接。</p><h2 id="一键脚本安装warp"><a href="#一键脚本安装warp" class="headerlink" title="一键脚本安装warp"></a>一键脚本安装warp</h2><p>首次运行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget -N https://gitlab.com/fscarmen/warp/-/raw/main/menu.sh &amp;&amp; bash menu.sh [option] [lisence/url/token]</span><br></pre></td></tr></table></figure><p>再次运行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">warp [option] [lisence]</span><br></pre></td></tr></table></figure><table><thead><tr><th>[option] 变量1 变量2</th><th>具体动作说明</th></tr></thead><tbody><tr><td>h</td><td>帮助</td></tr><tr><td>4</td><td>原无论任何状态 -&gt; WARP IPv4</td></tr><tr><td>4 lisence name</td><td>把 WARP+ Lisence 和设备名添加进去，如 <code>bash menu.sh 4 N5670ljg-sS9jD334-6o6g4M9F Goodluck</code></td></tr><tr><td>6</td><td>原无论任何状态 -&gt; WARP IPv6</td></tr><tr><td>d</td><td>原无论任何状态 -&gt; WARP 双栈</td></tr><tr><td>o</td><td>WARP 开关，脚本主动判断当前状态，自动开或关</td></tr><tr><td>u</td><td>卸载 WARP</td></tr><tr><td>n</td><td>断网时，用于刷WARP网络 (WARP bug)</td></tr><tr><td>b</td><td>升级内核、开启BBR及DD</td></tr><tr><td>a</td><td>免费 WARP 账户升级 WARP+</td></tr><tr><td>a lisence</td><td>在上面基础上把 WARP+ Lisence 添加进去，如 <code>bash menu.sh a N5670ljg-sS9jD334-6o6g4M9F</code></td></tr><tr><td>p</td><td>刷 Warp+ 流量</td></tr><tr><td>c</td><td>安装 WARP Linux Client，开启 Socks5 代理模式</td></tr><tr><td>l</td><td>安装 WARP Linux Client，开启 WARP 模式</td></tr><tr><td>c lisence</td><td>在上面基础上把 WARP+ Lisence 添加进去，如 <code>bash menu.sh c N5670ljg-sS9jD334-6o6g4M9F</code></td></tr><tr><td>r</td><td>WARP Linux Client 开关</td></tr><tr><td>v</td><td>同步脚本至最新版本</td></tr><tr><td>i</td><td>更换 WARP IP</td></tr><tr><td>e</td><td>安装 iptables + dnsmasq + ipset 分流流媒体方案</td></tr><tr><td>w</td><td>安装 WireProxy 解决方案</td></tr><tr><td>y</td><td>WireProxy 开关</td></tr><tr><td>k</td><td>切换 wireguard 内核 &#x2F; wireguard-go-reserved</td></tr><tr><td>g</td><td>切换 warp 全局 &#x2F; 非全局 或首次以 非全局 模式安装</td></tr><tr><td>s</td><td>s 4&#x2F;6&#x2F;d，切换优先级 warp IPv4 &#x2F; IPv6 &#x2F; 默认</td></tr><tr><td>其他或空值</td><td>菜单界面</td></tr></tbody></table><h2 id="手动安装官方warp-cli"><a href="#手动安装官方warp-cli" class="headerlink" title="手动安装官方warp-cli"></a>手动安装官方warp-cli</h2><h3 id="Ubuntu"><a href="#Ubuntu" class="headerlink" title="Ubuntu"></a>Ubuntu</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Install lsb</span></span><br><span class="line">sudo apt update &amp;&amp; sudo apt install lsb-release gpg curl wget</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add cloudflare gpg key</span></span><br><span class="line">curl -fsSL https://pkg.cloudflareclient.com/pubkey.gpg | sudo gpg --<span class="built_in">yes</span> --dearmor --output /usr/share/keyrings/cloudflare-warp-archive-keyring.gpg</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add this repo to your apt repositories</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;deb [arch=amd64 signed-by=/usr/share/keyrings/cloudflare-warp-archive-keyring.gpg] https://pkg.cloudflareclient.com/ <span class="subst">$(lsb_release -cs)</span> main&quot;</span> | sudo <span class="built_in">tee</span> /etc/apt/sources.list.d/cloudflare-client.list</span><br><span class="line"></span><br><span class="line"><span class="comment"># Install</span></span><br><span class="line">sudo apt update &amp;&amp; sudo apt install cloudflare-warp</span><br></pre></td></tr></table></figure><h3 id="Debian"><a href="#Debian" class="headerlink" title="Debian"></a>Debian</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Install lsb</span></span><br><span class="line">apt update &amp;&amp; apt install lsb-release gpg curl wget</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add cloudflare gpg key</span></span><br><span class="line">curl -fsSL https://pkg.cloudflareclient.com/pubkey.gpg | gpg --<span class="built_in">yes</span> --dearmor --output /usr/share/keyrings/cloudflare-warp-archive-keyring.gpg</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add this repo to your apt repositories</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;deb [arch=amd64 signed-by=/usr/share/keyrings/cloudflare-warp-archive-keyring.gpg] https://pkg.cloudflareclient.com/ <span class="subst">$(lsb_release -cs)</span> main&quot;</span> | <span class="built_in">tee</span> /etc/apt/sources.list.d/cloudflare-client.list</span><br><span class="line"></span><br><span class="line"><span class="comment"># Install</span></span><br><span class="line">apt update &amp;&amp; apt install cloudflare-warp</span><br></pre></td></tr></table></figure><h3 id="CentOS"><a href="#CentOS" class="headerlink" title="CentOS"></a>CentOS</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Add cloudflare-warp.repo to /etc/yum.repos.d/</span></span><br><span class="line">curl -fsSl https://pkg.cloudflareclient.com/cloudflare-warp-ascii.repo | <span class="built_in">tee</span> /etc/yum.repos.d/cloudflare-warp.repo</span><br><span class="line"></span><br><span class="line"><span class="comment"># Update repo</span></span><br><span class="line">yum update</span><br><span class="line"></span><br><span class="line"><span class="comment"># Install</span></span><br><span class="line">yum install cloudflare-warp</span><br></pre></td></tr></table></figure><h2 id="连接-warp"><a href="#连接-warp" class="headerlink" title="连接 warp"></a>连接 warp</h2><h3 id="注册warp免费账号"><a href="#注册warp免费账号" class="headerlink" title="注册warp免费账号"></a>注册warp免费账号</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">warp-cli register</span><br></pre></td></tr></table></figure><p>输入 <code>y</code> 回车同意 <code>TOS</code>，出现 <code>success</code> 即成功</p><h3 id="添加排除路由"><a href="#添加排除路由" class="headerlink" title="添加排除路由"></a>添加排除路由</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">warp-cli add-excluded-route ::0/0</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">warp-cli mode warp</span><br><span class="line">warp-cli connect</span><br><span class="line">warp-cli enable-always-on</span><br></pre></td></tr></table></figure><h3 id="测试连接"><a href="#测试连接" class="headerlink" title="测试连接"></a>测试连接</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@selfish-criticism:~<span class="comment"># curl -4 ip.sb</span></span><br><span class="line">104.28.xxx.xxx</span><br></pre></td></tr></table></figure><p>成功添加ipv4。</p><h2 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h2><p>此方法得到的ip由于多人共用，可能存在滥用现象，不要用来访问重要站点，避免被判定为欺诈&#x2F;滥用行为。</p><p>由于ipv6还没得到大力推广，用的人相对更少，所以ipv6的直连体验在部分地区优于ipv4。个人简单使用还是值得尝试的。</p><p>最后，祝大家都能愉快的玩耍ipv6。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;大佬送了个免费小🐔，奈何只支持ipv6，很不方便，所以通过warp来添加ipv4。&lt;/p&gt;
&lt;p&gt;纯IPv6的VPS，意思就是没有IPv4入口和出口。&lt;/p&gt;
&lt;p&gt;没有IPv4入口，意味着大概率无法直接通过SSH访问这个机器去操作，除非你本地网络是支持IPv6的，反正我家里和公司的网络都不支持，没得玩。&lt;/p&gt;</summary>
    
    
    
    <category term="vps" scheme="https://zyha.cn/categories/vps/"/>
    
    
    <category term="vps" scheme="https://zyha.cn/tags/vps/"/>
    
    <category term="cf" scheme="https://zyha.cn/tags/cf/"/>
    
  </entry>
  
  <entry>
    <title>网站优化之图片格式权衡</title>
    <link href="https://zyha.cn/image-format-trade-offs-for-website-optimization/"/>
    <id>https://zyha.cn/image-format-trade-offs-for-website-optimization/</id>
    <published>2024-06-22T03:04:08.000Z</published>
    <updated>2024-06-22T03:04:08.000Z</updated>
    
    <content type="html"><![CDATA[<p>逛论坛的时候发现看不到别人发的图片，我第一反应是他的图床挂了，结果是高贵的Chrome不支持<code>heic</code>格式，It’s only apple can do了属于是。</p><span id="more"></span><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://img.tucang.cc/api/image/show/531ee52a7c90758f589d3f4eba206d92"></p><h2 id="时间线"><a href="#时间线" class="headerlink" title="时间线"></a>时间线</h2><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://img.tucang.cc/api/image/show/5ffa6d974e751dc3f65a4b23a26710b4"></p><h2 id="对比"><a href="#对比" class="headerlink" title="对比"></a>对比</h2><h3 id="示例图片"><a href="#示例图片" class="headerlink" title="示例图片"></a>示例图片</h3><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://img.tucang.cc/api/image/show/a29260d7943879af4279717b8c9a9ef3"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">❯ exiftool /Volumes/TOSHIBA/tg/59190594_p0.jpg </span><br><span class="line">ExifTool Version Number         : 12.76</span><br><span class="line">File Name                       : 59190594_p0.jpg</span><br><span class="line">Directory                       : /Volumes/TOSHIBA/tg</span><br><span class="line">File Size                       : 1759 kB</span><br><span class="line">File Modification Date/Time     : 2024:06:22 13:56:05+08:00</span><br><span class="line">File Access Date/Time           : 2024:06:22 13:56:08+08:00</span><br><span class="line">File Inode Change Date/Time     : 2024:06:22 13:56:05+08:00</span><br><span class="line">File Permissions                : -rwx------</span><br><span class="line">File Type                       : JPEG</span><br><span class="line">File Type Extension             : jpg</span><br><span class="line">MIME Type                       : image/jpeg</span><br><span class="line">JFIF Version                    : 1.01</span><br><span class="line">Resolution Unit                 : None</span><br><span class="line">X Resolution                    : 1</span><br><span class="line">Y Resolution                    : 1</span><br><span class="line">Image Width                     : 1920</span><br><span class="line">Image Height                    : 1080</span><br><span class="line">Encoding Process                : Baseline DCT, Huffman coding</span><br><span class="line">Bits Per Sample                 : 8</span><br><span class="line">Color Components                : 3</span><br><span class="line">Y Cb Cr Sub Sampling            : YCbCr4:4:4 (1 1)</span><br><span class="line">Image Size                      : 1920x1080</span><br><span class="line">Megapixels                      : 2.1</span><br></pre></td></tr></table></figure><h3 id="阿里OSS图片转换结果"><a href="#阿里OSS图片转换结果" class="headerlink" title="阿里OSS图片转换结果"></a>阿里OSS图片转换结果</h3><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://img.tucang.cc/api/image/show/16e064e3fdd0a826db3f63b222fdf5ab"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">image/auto-orient,1/quality,q_100/format,&#123;jpg|jpeg|png|webp|avif|&#125;</span><br></pre></td></tr></table></figure><table><thead><tr><th>原图</th><th>jpg</th><th>jpeg</th><th>png</th><th>webp</th><th>avif</th><th>heic</th></tr></thead><tbody><tr><td>1759 kB</td><td>407 kB</td><td>407 kB</td><td>472 kB</td><td>454 kB</td><td>不支持</td><td>不支持</td></tr><tr><td></td><td>-77%</td><td>-77%</td><td>-73%</td><td>-74%</td><td></td><td></td></tr></tbody></table><ul><li>在大部分情况下，都是用图片的更低的兼容性换更小的体积</li><li>阿里云等对象存储厂商提供了直接添加参数完成图片转换的功能</li><li>以下对比都是将图片相对质量设置为100%，真实场景下一定会更小</li><li>不同图片适合的压缩率不同，此处图片仅做参考</li></ul><h2 id="ffmpeg批量转换"><a href="#ffmpeg批量转换" class="headerlink" title="ffmpeg批量转换"></a>ffmpeg批量转换</h2><p>FFmpeg 是一个可以处理音视频的软件，功能非常强大，主要包括，编解码转换，封装格式转换，滤镜特效。同时也支持 各种网络协议，支持多种高层协议的推拉流，也支持更底层一点的TCP&#x2F;UDP 协议推拉流。</p><p>在多平台系统方面，FFmpeg 的兼容性也优势显著，FFmpeg 可以在 windows，Linux，Mac，ios，android 等等操作系统上运行。</p><p>下面通过 ffmpeg + zsh 批处理，而不是通过 Node.js 之类自动压缩。原因其一，前者比后者性能更高，C 和 JavaScript 不用多说；原因其二，前者比后者相对简单点。</p><h3 id="安装-ffmpeg"><a href="#安装-ffmpeg" class="headerlink" title="安装 ffmpeg"></a>安装 ffmpeg</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install ffmpeg</span><br></pre></td></tr></table></figure><h3 id="查看支持的格式"><a href="#查看支持的格式" class="headerlink" title="查看支持的格式"></a>查看支持的格式</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -formats</span><br></pre></td></tr></table></figure><h3 id="批量转换"><a href="#批量转换" class="headerlink" title="批量转换"></a>批量转换</h3><ul><li>转换为webp</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[[ ! -d ./webp ]] &amp;&amp; <span class="built_in">mkdir</span> ./blog/webp</span><br><span class="line"><span class="keyword">for</span> f (*.(bmp|jpg|jpeg|png)) &#123;</span><br><span class="line">  ffmpeg -i <span class="variable">$f</span> -c:v libwebp -lossless 1 -quality 100 -compression_level 6 ./blog/webp/<span class="variable">$&#123;f%.*&#125;</span>.webp</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>转换为avif</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> %%i <span class="keyword">in</span> (<span class="string">&quot;./blog/png/*.png&quot;</span>) <span class="keyword">do</span> ffmpeg -i <span class="string">&quot;%%i&quot;</span> -c:v av1 -strict experimental -b:v 0 -crf 30 <span class="string">&quot;./blog/avif/%%~ni.avif&quot;</span></span><br></pre></td></tr></table></figure><h2 id="相关"><a href="#相关" class="headerlink" title="相关"></a>相关</h2><ul><li><a href="https://squoosh.app/">Google 出品的图片压缩网站</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/Media/Formats/Image_types">图像文件类型与格式指南</a></li><li><a href="https://www.ffmpeg.org/download.html">ffmpeg官网</a></li><li><a href="https://caniuse.com/">caniuse.com</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;逛论坛的时候发现看不到别人发的图片，我第一反应是他的图床挂了，结果是高贵的Chrome不支持&lt;code&gt;heic&lt;/code&gt;格式，It’s only apple can do了属于是。&lt;/p&gt;</summary>
    
    
    
    <category term="优化" scheme="https://zyha.cn/categories/%E4%BC%98%E5%8C%96/"/>
    
    
    <category term="优化" scheme="https://zyha.cn/tags/%E4%BC%98%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>NuxtHub尝鲜</title>
    <link href="https://zyha.cn/nuxthub-preview/"/>
    <id>https://zyha.cn/nuxthub-preview/</id>
    <published>2024-06-17T16:04:59.000Z</published>
    <updated>2024-06-17T16:04:59.000Z</updated>
    
    <content type="html"><![CDATA[<p>我们<code>Vue</code>也有自己的<code>Vercel</code>了：）</p><span id="more"></span><h2 id="写在最前面"><a href="#写在最前面" class="headerlink" title="写在最前面"></a>写在最前面</h2><ul><li>当前<code>NuxtHub</code>还在<code>beta</code>阶段，请不要用于生产环境。</li><li><code>NuxtHub</code>目前基于<code>Cloudflare</code>的<code>Page</code>,<code>D1</code>,<code>R2</code>等服务，在不做其他优选的情况下网络联通性可能比不上<code>Vercel</code>。</li><li><code>NuxtHub</code>目前仅支持<code>GitHub</code>作为登录方式，并且要绑定<code>Cloudflare</code>账户才能使用。</li></ul><h2 id="关于NuxtHub"><a href="#关于NuxtHub" class="headerlink" title="关于NuxtHub"></a>关于<a href="https://hub.nuxt.com/">NuxtHub</a></h2><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://cdn.zyha.cn/blog/20240618002457.png?x-oss-process=style/blog" alt="20240618002457"></p><ul><li>NuxtHub 是由 Cloudflare 提供支持的 Nuxt 部署和管理平台。</li><li>在 Cloudflare 账户上部署带有数据库、键值和 blob 存储的应用程序，无需任何配置。</li><li>NuxtHub 可让您经济实惠地在任何地方运行高性能 Nuxt 应用程序。</li></ul><h2 id="架构"><a href="#架构" class="headerlink" title="架构"></a>架构</h2><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://img.tucang.cc/api/image/show/a7a98a507e6564ad3f682138e81dbdae"></p><h2 id="价格"><a href="#价格" class="headerlink" title="价格"></a>价格</h2><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://cdn.zyha.cn/blog/20240618002915.png?x-oss-process=style/blog" alt="20240618002915"><br>而<code>Vercel</code>的价格</p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://cdn.zyha.cn/blog/20240618003117.png?x-oss-process=style/blog" alt="20240618003117"><br>对于较大的项目来说，截图中的月费可能并不是最终花费。但由于<code>NuxtHub</code>是基于大善人<code>Cloudflare</code>的服务，所以大概率是更低价的。x上众多吐槽vercel费用高昂的有业务的用户可能会感到开心：）</p><p>PS: 对用量极少的大部分人来说，两者都差不多都是免费的。</p><h2 id="简单对比"><a href="#简单对比" class="headerlink" title="简单对比"></a>简单对比</h2><p>两者的大部分基础功能都是重合的，此处列举一些我认为值得对比的东西。</p><table><thead><tr><th></th><th>NuxtHub</th><th>Vercel</th></tr></thead><tbody><tr><td>官网模板数量</td><td>极少（4个）</td><td>多</td></tr><tr><td>同等较大项目计费</td><td>低</td><td>高</td></tr><tr><td>教程数量</td><td>极少</td><td>多</td></tr><tr><td>所需账号</td><td><code>Github</code>+<code>Cloudflare</code></td><td><code>Vercel</code></td></tr><tr><td>文档质量</td><td>一般</td><td>高</td></tr><tr><td>更新频次</td><td>高</td><td>高</td></tr><tr><td>修改环境变量后</td><td>会提醒重新构建</td><td>无提醒</td></tr><tr><td>流量图表</td><td>无（可在CF查询）</td><td>有</td></tr><tr><td>GitHub Deployments集成</td><td>无</td><td>有</td></tr><tr><td>流量限制</td><td>无限</td><td>免费流出100 GB &#x2F;月，超出$0.15&#x2F;GB；免费回源10GB&#x2F;月， $0.06&#x2F;月</td></tr><tr><td>自定义域名网络联通测试</td><td><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://cdn.zyha.cn/blog/20240618010910.png?x-oss-process=style/blog"></td><td><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://cdn.zyha.cn/blog/20240618010749.png?x-oss-process=style/blog"></td></tr><tr><td>默认域名网络联通测试</td><td><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://img.tucang.cc/api/image/show/cb5619c4fcc002aadc22eba15b396f2a" alt="*.nuxt.dev"></td><td><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://img.tucang.cc/api/image/show/8435375c13d5731541694b931679b4ca" alt="*.vercel.app"></td></tr></tbody></table><ul><li>此为2024.6.17的情况，随时可能变化，以官网内容为准</li><li>虽然目前nuxthub的默认域名还能用，但迟早被滥用，还是会步入<code>*.page.dev</code>和<code>*vercel.app</code>的后尘，还是建议绑定自定义域名进行使用</li></ul><h2 id="总之"><a href="#总之" class="headerlink" title="总之"></a>总之</h2><p> <code>NuxtHub</code>的总体表现不及<code>Vercel</code>，主要原因之一是目前项目还太新了（2024.6.3发布beta），但站在<code>Cloudflare</code>的肩膀上，很多功能会有更多的免费额度，算是未来可期吧。</p><p><code>NuxtHub</code>目前还处于<code>beta</code>阶段，部分功能可能还不完善，但对于海外的个人开发者来说，应该是个不错的选择。</p><h2 id="相关"><a href="#相关" class="headerlink" title="相关"></a>相关</h2><ul><li><a href="https://hub.nuxt.com/changelog">nuxthub’s changelog</a></li><li><a href="https://hub.nuxt.com/blog/beta">Introducing NuxtHub Beta</a></li><li><a href="https://www.cloudflare.com/plans/developer-platform/">Learn more about Cloudflare pricing</a></li><li><a href="https://vercel.com/pricing">Vercel Pricing</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;我们&lt;code&gt;Vue&lt;/code&gt;也有自己的&lt;code&gt;Vercel&lt;/code&gt;了：）&lt;/p&gt;</summary>
    
    
    
    <category term="nuxt" scheme="https://zyha.cn/categories/nuxt/"/>
    
    
    <category term="vue" scheme="https://zyha.cn/tags/vue/"/>
    
    <category term="nuxt" scheme="https://zyha.cn/tags/nuxt/"/>
    
    <category term="建站" scheme="https://zyha.cn/tags/%E5%BB%BA%E7%AB%99/"/>
    
    <category term="开发环境" scheme="https://zyha.cn/tags/%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/"/>
    
    <category term="效率" scheme="https://zyha.cn/tags/%E6%95%88%E7%8E%87/"/>
    
  </entry>
  
  <entry>
    <title>【简单测评】oracle韩国e2</title>
    <link href="https://zyha.cn/oracle-e2-simple-evaluation/"/>
    <id>https://zyha.cn/oracle-e2-simple-evaluation/</id>
    <published>2024-06-15T08:21:29.000Z</published>
    <updated>2024-06-15T08:21:29.000Z</updated>
    
    <content type="html"><![CDATA[<p>丢包极为严重，测完就后悔开韩国区域了。。。</p><span id="more"></span><h2 id="nws-sh"><a href="#nws-sh" class="headerlink" title="nws.sh"></a>nws.sh</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">---------------------------------- nws.sh ---------------------------------</span><br><span class="line">      A simple script to bench network performance using speedtest-cli     </span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line"> Version            : v2024.06.02</span><br><span class="line"> Global Speedtest   : wget -qO- nws.sh | bash</span><br><span class="line"> Region Speedtest   : wget -qO- nws.sh | bash -s -- -r &lt;region&gt;</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line"> Basic System Info</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line"> CPU Model          : AMD EPYC 7551 32-Core Processor</span><br><span class="line"> CPU Cores          : 2 @ 1996.245 MHz</span><br><span class="line"> CPU Cache          : 512 KB</span><br><span class="line"> AES-NI             : ✔ Enabled</span><br><span class="line"> VM-x/AMD-V         : ❌ Disabled</span><br><span class="line"> Total Disk         : 45.1 GB (2.1 GB Used)</span><br><span class="line"> Total RAM          : 947.5 MB (208.3 MB Used)</span><br><span class="line"> System <span class="built_in">uptime</span>      : 0 days, 0 hour 39 min</span><br><span class="line"> Load average       : 0.00, 0.00, 0.00</span><br><span class="line"> OS                 : Ubuntu 22.04.4 LTS</span><br><span class="line"> Arch               : x86_64 (64 Bit)</span><br><span class="line"> Kernel             : 6.5.0-1020-oracle</span><br><span class="line"> Virtualization     : KVM</span><br><span class="line"> TCP Control        : cubic</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line"> Basic Network Info</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line"> Primary Network    : IPv4</span><br><span class="line"> IPv6 Access        : ❌ Offline</span><br><span class="line"> IPv4 Access        : ✔ Online</span><br><span class="line"> ISP                : Oracle Corporation</span><br><span class="line"> ASN                : AS31898 Oracle Corporation</span><br><span class="line"> Host               : Oracle Cloud Infrastructure (ap-chuncheon-1)</span><br><span class="line"> Location           : Chuncheon, Gangwon-do-42, South Korea</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line"> Speedtest.net (Region: GLOBAL)</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line"> Location         Latency     Loss    DL Speed       UP Speed       Server      </span><br><span class="line"></span><br><span class="line"> ISP: Oracle Cloud </span><br><span class="line"></span><br><span class="line"> Nearest          69.91 ms    N/A     50.25 Mbps     5.83 Mbps      ChinaUnicom-5G - TianJin </span><br><span class="line"></span><br><span class="line"> Kochi, IN        124.49 ms   0.0%    50.89 Mbps     48.68 Mbps     Asianet Broadband - Cochin </span><br><span class="line"> Bangalore, IN    113.04 ms   0.0%    49.86 Mbps     47.84 Mbps     Bharti Airtel Ltd - Bangalore </span><br><span class="line"> Chennai, IN      99.80 ms    N/A     51.48 Mbps     50.42 Mbps     Jio - Chennai </span><br><span class="line"> Mumbai, IN       125.04 ms   0.0%    50.44 Mbps     48.83 Mbps     i3D.net - Mumbai </span><br><span class="line"> Delhi, IN        145.54 ms   0.0%    49.06 Mbps     48.55 Mbps     Tata Play Fiber - New Delhi </span><br><span class="line"></span><br><span class="line"> Seattle, US      206.40 ms   N/A     50.64 Mbps     46.43 Mbps     Comcast - Seattle, WA </span><br><span class="line"> Los Angeles, US  133.68 ms   0.0%    48.06 Mbps     31.72 Mbps     ReliableSite Hosting - Los Angeles, CA </span><br><span class="line"> Dallas, US       165.32 ms   0.0%    49.36 Mbps     47.57 Mbps     i3D.net - Dallas, TX </span><br><span class="line"> Miami, US        210.18 ms   N/A     51.30 Mbps     48.97 Mbps     Dish Wireless - Miami, FL </span><br><span class="line"> New York, US     189.08 ms   N/A     51.01 Mbps     50.14 Mbps     fdcservers.net - New York, NY </span><br><span class="line"> Toronto, CA      176.48 ms   0.0%    51.18 Mbps     49.84 Mbps     Rogers - Toronto, ON </span><br><span class="line"> Mexico City, MX  199.31 ms   N/A     50.59 Mbps     49.13 Mbps     INFINITUM - Mexico City </span><br><span class="line"></span><br><span class="line"> London, UK       296.58 ms   0.0%    55.01 Mbps     48.93 Mbps     VeloxServ Communications - London </span><br><span class="line"> Amsterdam, NL    318.54 ms   0.0%    56.56 Mbps     49.40 Mbps     31173 Services AB - Amsterdam </span><br><span class="line"> Paris, FR        FAILED                                                        </span><br><span class="line"> Frankfurt, DE    354.74 ms   0.0%    50.73 Mbps     49.15 Mbps     Clouvider Ltd - Frankfurt am Main </span><br><span class="line"> Warsaw, PL       330.64 ms   0.0%    52.67 Mbps     48.89 Mbps     Play - Warszawa </span><br><span class="line"> Bucharest, RO    309.85 ms   0.0%    51.75 Mbps     49.63 Mbps     Vodafone Romania Fixed – Bucharest - Bucharest </span><br><span class="line"> Moscow, RU       193.46 ms   0.0%    50.32 Mbps     50.47 Mbps     Rostelecom - Moscow </span><br><span class="line"></span><br><span class="line"> Jeddah, SA       328.54 ms   0.0%    55.16 Mbps     49.59 Mbps     Saudi Telecom Company </span><br><span class="line"> Dubai, AE        FAILED                                                        </span><br><span class="line"> Fujairah, AE     150.81 ms   0.0%    53.57 Mbps     47.30 Mbps     ETISALAT-UAE - Fujairah </span><br><span class="line"> Istanbul, TR     360.63 ms   0.0%    51.46 Mbps     49.71 Mbps     Turkcell - Istanbul </span><br><span class="line"> Tehran, IR       773.85 ms   0.0%    53.08 Mbps     49.14 Mbps     Asiatech - Tehran </span><br><span class="line"></span><br><span class="line"> Tokyo, JP        35.64 ms    0.0%    49.05 Mbps     49.34 Mbps     IPA CyberLab 400G - Tokyo </span><br><span class="line"> Shanghai, CU-CN  63.97 ms    1.1%    50.41 Mbps     7.03 Mbps      China Unicom 5G - Shanghai </span><br><span class="line"> Nanjing, CT-CN   129.51 ms   36.2%   49.10 Mbps     0.32 Mbps      China Telecom JiangSu 5G - Nanjing </span><br><span class="line"> Hong Kong, CN    39.47 ms    N/A     49.66 Mbps     49.00 Mbps     STC - Hong Kong </span><br><span class="line"> Singapore, SG    FAILED - IP has been rate limited. Try again after 1 hour.                                                  </span><br><span class="line"> Jakarta, ID      FAILED - IP has been rate limited. Try again after 1 hour.                                                  </span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line"> Avg DL Speed       : 51.21 Mbps</span><br><span class="line"> Avg UL Speed       : 43.40 Mbps</span><br><span class="line"></span><br><span class="line"> Total DL Data      : 1.89 GB</span><br><span class="line"> Total UL Data      : 1.89 GB</span><br><span class="line"> Total Data         : 3.78 GB</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line"> Duration           : 14 min 7 sec</span><br><span class="line"> System Time        : 15/06/2024 - 08:43:51 UTC</span><br><span class="line"> Total Script Runs  : 47892</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line"> Result             : https://result.nws.sh/r/1718440081_HB8VVW_GLOBAL.txt</span><br><span class="line">---------------------------------------------------------------------------</span><br></pre></td></tr></table></figure><h2 id="流媒体平台及游戏区域限制测试"><a href="#流媒体平台及游戏区域限制测试" class="headerlink" title="流媒体平台及游戏区域限制测试"></a>流媒体平台及游戏区域限制测试</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br></pre></td><td class="code"><pre><span class="line"> [流媒体平台及游戏区域限制测试]</span><br><span class="line"></span><br><span class="line">项目地址 https://github.com/lmc999/RegionRestrictionCheck </span><br><span class="line">BUG 反馈或使用交流可加TG群组 https://t.me/gameaccelerate </span><br><span class="line"></span><br><span class="line"> ** 测试时间: Sat Jun 15 08:51:33 UTC 2024</span><br><span class="line"> ** 版本: 1.0.0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> ** 正在测试 IPv4 解锁情况</span><br><span class="line">--------------------------------</span><br><span class="line"> ** 您的网络为: Oracle Cloud (138.2.*.*)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">============[ Multination ]============</span><br><span class="line"> Dazn:                                  Yes (Region: KR)</span><br><span class="line"> Disney+:                               No</span><br><span class="line"> Netflix:                               Originals Only</span><br><span class="line"> YouTube Premium:                       Yes (Region: KR)</span><br><span class="line"> Amazon Prime Video:                    Yes (Region: KR)</span><br><span class="line"> TVBAnywhere+:                          Yes</span><br><span class="line"> Spotify Registration:                  Yes (Region: KR)</span><br><span class="line"> Instagram Licensed Audio:              No</span><br><span class="line"> OneTrust Region:                       KR [Gangwon-<span class="keyword">do</span>]</span><br><span class="line"> iQyi Oversea Region:                   KR</span><br><span class="line"> Bing Region:                           KR</span><br><span class="line"> YouTube CDN:                           Tokyo</span><br><span class="line"> Netflix Preferred CDN:                 [SK Broadband] <span class="keyword">in</span> [Seoul, Korea]</span><br><span class="line"> ChatGPT:                               No (Only Available with Web Browser)</span><br><span class="line"> Wikipedia Editability:                 No</span><br><span class="line"> Google Search CAPTCHA Free:            Yes</span><br><span class="line"> Steam Currency:                        KRW</span><br><span class="line"> ---Forum---</span><br><span class="line"> Reddit:                                No</span><br><span class="line">=======================================</span><br><span class="line">==============[ Taiwan ]===============</span><br><span class="line"> KKTV:                                  No</span><br><span class="line"> LiTV:                                  No</span><br><span class="line"> MyVideo:                               No</span><br><span class="line"> 4GTV.TV:                               No</span><br><span class="line"> LineTV.TW:                             No</span><br><span class="line"> Hami Video:                            No</span><br><span class="line"> CatchPlay+:                            No</span><br><span class="line"> HBO GO Asia:                           No</span><br><span class="line"> Bahamut Anime:                         No</span><br><span class="line"> SonyLiv:                               No</span><br><span class="line"> Bilibili Taiwan Only:                  No</span><br><span class="line">=======================================</span><br><span class="line">=============[ Hong Kong ]=============</span><br><span class="line"> Now E:                                 No</span><br><span class="line"> Viu.com:                               No</span><br><span class="line"> Viu.TV:                                No</span><br><span class="line"> MyTVSuper:                             No</span><br><span class="line"> HBO GO Asia:                           No</span><br><span class="line"> SonyLiv:                               No</span><br><span class="line"> BiliBili Hongkong/Macau/Taiwan:        No</span><br><span class="line"> Bahamut Anime:                         No</span><br><span class="line">=======================================</span><br><span class="line">===============[ Japan ]===============</span><br><span class="line"> DMM:                                   No</span><br><span class="line"> DMM TV:                                No</span><br><span class="line"> Abema.TV:                              No</span><br><span class="line"> Niconico:                              Failed (Error: PAGE ERROR)</span><br><span class="line"> Telasa:                                No</span><br><span class="line"> U-NEXT:                                No</span><br><span class="line"> Hulu Japan:                            No</span><br><span class="line"> TVer:                                  Failed (Network Connection)</span><br><span class="line"> Lemino:                                No</span><br><span class="line"> WOWOW:                                 No</span><br><span class="line"> VideoMarket:                           No</span><br><span class="line"> D Anime Store:                         No</span><br><span class="line"> FOD(Fuji TV):                          No</span><br><span class="line"> Radiko:                                No</span><br><span class="line"> Karaoke@DAM:                           No</span><br><span class="line"> J:com On Demand:                       No</span><br><span class="line"> WATCHA:                                Yes</span><br><span class="line"> Rakuten TV JP:                         No</span><br><span class="line"> ---Game---</span><br><span class="line"> Kancolle Japan:                        No</span><br><span class="line"> Pretty Derby Japan:                    Failed (Network Connection)</span><br><span class="line"> Konosuba Fantastic Days:               No</span><br><span class="line"> Princess Connect Re:Dive Japan:        No</span><br><span class="line"> Project Sekai: Colorful Stage:         No</span><br><span class="line"> ---Music---</span><br><span class="line"> Mora:                                  No</span><br><span class="line"> music.jp:                              No</span><br><span class="line"> ---Forum---</span><br><span class="line"> EroGameSpace:                          Failed (Network Connection)</span><br><span class="line">=======================================</span><br><span class="line">===========[ North America ]===========</span><br><span class="line"> Paramount+:                            No</span><br><span class="line"> Discovery+:                            No (Not Yet Available <span class="keyword">in</span> Asia Pacific)</span><br><span class="line"> Acorn TV:                              No</span><br><span class="line"> BritBox:                               No</span><br><span class="line"> SonyLiv:                               No</span><br><span class="line"> NBA TV:                                Yes</span><br><span class="line"> TLC GO:                                No</span><br><span class="line"> Shudder:                               No</span><br><span class="line"> Fubo TV:                               No</span><br><span class="line"> Tubi TV:                               No</span><br><span class="line"> Pluto TV:                              No</span><br><span class="line"> KOCOWA:                                No</span><br><span class="line"> AMC+:                                  No</span><br><span class="line"> MathsSpot Roblox:                      No</span><br><span class="line"> ---US---</span><br><span class="line"> FOX:                                   No</span><br><span class="line"> Hulu:                                  No</span><br><span class="line"> NFL+:                                  No</span><br><span class="line"> ESPN+:[Sponsored by Jam]               No</span><br><span class="line"> MGM+:                                  No</span><br><span class="line"> Starz:                                 No</span><br><span class="line"> Philo:                                 No</span><br><span class="line"> FXNOW:                                 No</span><br><span class="line"> HBO Max:                               No</span><br><span class="line"> Crackle:                               No</span><br><span class="line"> CW TV:                                 No</span><br><span class="line"> A&amp;E TV:                                No</span><br><span class="line"> NBC TV:                                No</span><br><span class="line"> Sling TV:                              No</span><br><span class="line"> encoreTVB:                             No</span><br><span class="line"> Peacock TV:                            No</span><br><span class="line"> Popcornflix:                           Yes</span><br><span class="line"> Crunchyroll:                           No</span><br><span class="line"> Directv Stream:                        No</span><br><span class="line"> Meta AI:                               No</span><br><span class="line"> ---CA---</span><br><span class="line"> HotStar:                               No</span><br><span class="line"> CBC Gem:                               No</span><br><span class="line"> Crave:                                 No</span><br><span class="line">=======================================</span><br><span class="line">===========[ South America ]===========</span><br><span class="line"> HBO Max:                               No</span><br><span class="line"> DirecTV Go:                            Failed (Error: 404)</span><br><span class="line"> Paramount+:                            No</span><br><span class="line">=======================================</span><br><span class="line">===============[ Europe ]==============</span><br><span class="line"> Rakuten TV:                            No</span><br><span class="line"> SkyShowTime:                           No</span><br><span class="line"> HBO Max:                               No</span><br><span class="line"> Discovery+:                            No (Not Yet Available <span class="keyword">in</span> Asia Pacific)</span><br><span class="line"> Setanta Sports:                        No</span><br><span class="line"> SonyLiv:                               No</span><br><span class="line"> Paramount+:                            No</span><br><span class="line"> ---GB---</span><br><span class="line"> HotStar:                               No</span><br><span class="line"> Sky Go:                                Yes</span><br><span class="line"> BritBox:                               No</span><br><span class="line"> ITV Hub:                               No</span><br><span class="line"> Channel 4:                             No</span><br><span class="line"> Channel 5:                             No</span><br><span class="line"> BBC iPLAYER:                           No</span><br><span class="line"> Acorn TV:                              No</span><br><span class="line"> Shudder:                               No</span><br><span class="line"> ---FR---</span><br><span class="line"> Canal+:                                No</span><br><span class="line"> Molotov:                               No</span><br><span class="line"> ---DE---</span><br><span class="line"> Joyn:                                  No</span><br><span class="line"> SKY DE:                                No</span><br><span class="line"> ZDF:                                   No</span><br><span class="line"> ---NL---</span><br><span class="line"> NLZIET:                                Failed (Error: PAGE ERROR)</span><br><span class="line"> videoland:                             No</span><br><span class="line"> NPO Start Plus:                        No</span><br><span class="line"> ---ES---</span><br><span class="line"> Movistar+:                             No</span><br><span class="line"> ---IT---</span><br><span class="line"> Rai Play:                              No</span><br><span class="line"> ---CH---</span><br><span class="line"> SKY CH:                                No</span><br><span class="line"> ---RU---</span><br><span class="line"> Amediateka:                            No</span><br><span class="line">=======================================</span><br><span class="line">==============[ Oceania ]==============</span><br><span class="line"> NBA TV:                                Yes</span><br><span class="line"> Acorn TV:                              No</span><br><span class="line"> BritBox:                               No</span><br><span class="line"> Paramount+:                            No</span><br><span class="line"> AMC+:                                  No</span><br><span class="line"> SonyLiv:                               No</span><br><span class="line"> ---AU---</span><br><span class="line"> Binge:                                 No</span><br><span class="line"> Docplay:                               No</span><br><span class="line"> 7plus:                                 No</span><br><span class="line"> ABC iView:                             No</span><br><span class="line"> Channel 9:                             No</span><br><span class="line"> Channel 10:                            No</span><br><span class="line"> Optus Sports:                          No</span><br><span class="line"> SBS on Demand:                         No</span><br><span class="line"> Kayo Sports:                           No</span><br><span class="line"> ---NZ---</span><br><span class="line"> Neon TV:                               No</span><br><span class="line"> SkyGo NZ:                              Failed (Error: 401)</span><br><span class="line"> ThreeNow:                              No</span><br><span class="line"> Maori TV:                              No</span><br><span class="line">=======================================</span><br><span class="line">==============[ Korean ]===============</span><br><span class="line"> Wavve:                                 No</span><br><span class="line"> Tving:                                 Yes</span><br><span class="line"> WATCHA:                                Yes</span><br><span class="line"> Coupang Play:                          Yes</span><br><span class="line"> Naver TV:                              Yes</span><br><span class="line"> SPOTV NOW:                             Yes</span><br><span class="line"> Afreeca TV:                            Yes</span><br><span class="line"> KBS Domestic:                          Yes</span><br><span class="line">=======================================</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> ** 正在测试 IPv6 解锁情况 </span><br><span class="line">当前主机不支持 IPv6，跳过...</span><br><span class="line">本次测试已结束，感谢使用此脚本</span><br><span class="line"></span><br><span class="line">检测脚本当天运行次数: 6320; 共计运行次数: 11803997</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;丢包极为严重，测完就后悔开韩国区域了。。。&lt;/p&gt;</summary>
    
    
    
    <category term="vps" scheme="https://zyha.cn/categories/vps/"/>
    
    
    <category term="vps" scheme="https://zyha.cn/tags/vps/"/>
    
    <category term="oracle" scheme="https://zyha.cn/tags/oracle/"/>
    
  </entry>
  
  <entry>
    <title>成功注册甲骨文试用账号</title>
    <link href="https://zyha.cn/signup-oracle-free-trial/"/>
    <id>https://zyha.cn/signup-oracle-free-trial/</id>
    <published>2024-06-15T06:41:41.000Z</published>
    <updated>2024-06-15T06:41:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>几年前注册失败了一次就没继续，今天心血来潮试了一下，注册成功。</p><h2 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h2><ul><li>关掉代理</li><li>由于第一个原因，推荐使用outlook&#x2F;qq&#x2F;163邮箱</li><li>准备好实体外币卡</li><li>翻译好当前地址的英文</li></ul><span id="more"></span><h2 id="正式开始"><a href="#正式开始" class="headerlink" title="正式开始"></a>正式开始</h2><ul><li>打开官网 <a href="https://www.oracle.com/">https://www.oracle.com/</a><br><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://img.tucang.cc/api/image/show/fdd87b4c9b4fe79885268da9a993e7d6"></li></ul><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://img.tucang.cc/api/image/show/b9ab67bece64d0c00b5abe6f102f2e2a"></p><ul><li>通过图形验证码后，点击验证邮箱，去邮箱里找验证邮件</li></ul><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://img.tucang.cc/api/image/show/7e118e352fccb23a73e2f607f4cd1755"></p><ul><li>点击验证链接，进入注册页面。输入密码，选好注册区域，建议选<del>韩国春川或者首尔</del>圣何塞，韩国丢包感人。</li></ul><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://s2.loli.net/2024/06/15/cZkENDhfAH1ad8w.png" alt="20240615145952"></p><ul><li>填写信用卡地址信息，填写准备好的当前地址的英文</li></ul><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://s2.loli.net/2024/06/15/IcaB8gexbkH9w2A.png" alt="20240615150114"></p><ul><li>然后绑卡，注意不要一卡多号</li></ul><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://s2.loli.net/2024/06/15/5DOaJ1dgTxuLQcH.png" alt="20240615150253"></p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://s2.loli.net/2024/06/15/fGM8g7HlProATsd.png" alt="20240615150357"></p><ul><li>绑卡是否成功还可以通过扣款短信判断。</li></ul><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">您的借记卡xxxx于0615发生双信息无卡消费冲正交易，金额1.38新加坡元，已解冻1.04美元。【中国银行】</span><br></pre></td></tr></table></figure><ul><li><p>接下来的情况总共分为两大类，成功与没成功。</p><ul><li>卡信息都填对的情况下，如果直接出现什么预付卡3个提示的时候，多半是IP不行，小概率是卡头被玩坏了，搞点好的IP重来吧</li><li>如果成功跳转了，但是直接到15分钟界面，也是没成功，说明该卡可能之前注册过（常见于虚拟卡），环境也不太好</li></ul></li><li><p>成功界面<br><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://s2.loli.net/2024/06/15/xVkG1uMrYlin3tU.jpg" alt="img_2024_06_15_14_33_16"></p></li><li><p>接着就是漫长的等待（我等了1个小时左右）</p></li><li><p>在邮箱中看到【Your Oracle Cloud Account is Fully Provisioned】的邮件，然后才能登录成功<br><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://s2.loli.net/2024/06/15/sTaKjcnNZE4vHQb.png" alt="20240615151432"></p></li></ul><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://s2.loli.net/2024/06/15/2UWKjnZ9Tk5Go7M.png" alt="20240615151449"><br><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://s2.loli.net/2024/06/15/EB6NP2ir4w9a1YG.png" alt="20240615151641"></p><ul><li>为了方便，我直接用了icloud passkey的指纹验证</li></ul><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://s2.loli.net/2024/06/15/fZonV7av6HGFCxu.png" alt="20240615151800"></p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://img.tucang.cc/api/image/show/808600ffe5ac1e204aaabbbd27782aaa"></p><ul><li>登录成功，随便选个</li></ul><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://s2.loli.net/2024/06/15/BFqAr8aYLwdXNut.png" alt="20240615152328"></p><ul><li><p>可以看到<br><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://s2.loli.net/2024/06/15/9zqLUeyf385xYrh.png" alt="20240615152434"></p></li><li><p>然后就可以开始玩耍了</p></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;几年前注册失败了一次就没继续，今天心血来潮试了一下，注册成功。&lt;/p&gt;
&lt;h2 id=&quot;注意&quot;&gt;&lt;a href=&quot;#注意&quot; class=&quot;headerlink&quot; title=&quot;注意&quot;&gt;&lt;/a&gt;注意&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;关掉代理&lt;/li&gt;
&lt;li&gt;由于第一个原因，推荐使用outlook&amp;#x2F;qq&amp;#x2F;163邮箱&lt;/li&gt;
&lt;li&gt;准备好实体外币卡&lt;/li&gt;
&lt;li&gt;翻译好当前地址的英文&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="vps" scheme="https://zyha.cn/categories/vps/"/>
    
    
    <category term="free" scheme="https://zyha.cn/tags/free/"/>
    
    <category term="vps" scheme="https://zyha.cn/tags/vps/"/>
    
  </entry>
  
  <entry>
    <title>后端简单优化之redis</title>
    <link href="https://zyha.cn/optimizing-redis/"/>
    <id>https://zyha.cn/optimizing-redis/</id>
    <published>2024-06-11T07:52:48.000Z</published>
    <updated>2024-06-11T07:52:48.000Z</updated>
    
    <content type="html"><![CDATA[<p>又去研究了一下redis，想到一些值得优化的地方。</p><span id="more"></span><h2 id="编码-解码"><a href="#编码-解码" class="headerlink" title="编码&#x2F;解码"></a>编码&#x2F;解码</h2><p>如果缓存数据是字符串类型，将数据存储到 Redis 之前，需要进行编码操作，常规的做法是编码为 JSON 字符串，这样从 Redis 读取到缓存的字符串数据后， 如果数据不需要被读取并且不需要被修改，那么就可以直接将数据输出接口，这样可以节省 2 次 CPU 开销:</p><ul><li>将缓存的字符串数据解码为具体对象</li><li>将具体对象再编码为字符串后输出</li></ul><h2 id="key-的命名"><a href="#key-的命名" class="headerlink" title="key 的命名"></a>key 的命名</h2><p>在保证辨识度的前提下，key 的长度越短越好，不仅可以节省存储，还可以提升查询速度。</p><p>作为用户数据的缓存 key，<code>user:xxxx:profile</code> 明显由于 <code>user:profile:xxxx</code>，因为前者的辨识度更高，查询速度更快， 在这个基础上可以对 key 的长度再次优化，例如优化为 <code>u:xxxx:pf</code>。</p><h2 id="读写分离"><a href="#读写分离" class="headerlink" title="读写分离"></a>读写分离</h2><p>这类应用场景的典型特征是只有一端固定的数据生产者，例如:</p><ul><li>运营角色在管理后台完成整个 CMS 网站的内容</li><li>定时任务从第三方同步数据，完成后展示给所有用户</li><li>定时发送通知给特定用户</li></ul><p>这种场景最容易优化，启动一个后台任务，定时刷新数据到缓存即可，这里不再赘述了。</p><h2 id="HyperLogLog"><a href="#HyperLogLog" class="headerlink" title="HyperLogLog"></a>HyperLogLog</h2><p>在<strong>数据量很大</strong>的情况下，</p><ul><li>统计一个 APP 的日活、月活数。</li><li>统计一个页面的每天被多少个不同账户访问量（Unique Visitor，UV）。</li><li>统计用户每天搜索不同词条的个数。</li><li>统计注册&#x2F;登录 IP 数。</li></ul><p>使用 HyperLogLog 实现的唯一计数器可以大大降低内存使用量，比较适合使用在一些应用级别，接口级别的非精确唯一性统计上，比如统计当前某个页面的 uv, 某个接口的请求 uv 等等，而不是特别适合为每个用户进行统计，可以计算一下，每个用户需要 12k 字节的时候，如果你有 1 亿用户，那么内存使用量也比较夸张了。</p><h2 id="时间区间"><a href="#时间区间" class="headerlink" title="时间区间"></a>时间区间</h2><p>这类应用场景的典型特征是不同时间段内的数据组合优化，项目中类似场景之前的做法是使用筛选条件中的 (开始时间 + 结束时间 + 业务 key) 进行拼接作为缓存数据 key, 稍微思考后会发现这其中有很大的潜在问题: 不同的两个日期组合结果集合是一个庞大的数字，除了重复数据导致的巨量内存浪费外，还会造成很大的安全隐患。</p><p>下面举个浪费内存的例子，不同用户查询的时间区间是重叠的:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- 用户A 2024-01-01 ~ 2024-01-10</span><br><span class="line">- 用户B 2024-01-02 ~ 2024-01-05</span><br><span class="line">- 用户C 2024-01-05 ~ 2024-01-08</span><br></pre></td></tr></table></figure><p>通过示例可以看到，虽然有三个用户在查询，但是用户 B 和 用户 C 查询的数据都在 用户 A 的结果集内，也就造成了数据重估存储，白白浪费了内存。</p><p>可以想到的优化方案为:</p><ul><li>根据更小的粒度来缓存 (项目中以天为单位)，这样单个业务场景一年最多 365 个 key</li><li>控制时间范围的上限，不能超过 31 天</li><li>根据请求参数批量从 Redis 读取缓存数据</li><li>将读取到的缓存数据组装完成后输出接口</li></ul><p>注意: 如果项目的数据量很大，就需要调整时间粒度，并且进行数据异步批处理优化，但是整体的思路是不变的。</p><h2 id="使用Lua脚本"><a href="#使用Lua脚本" class="headerlink" title="使用Lua脚本"></a>使用Lua脚本</h2><p>对于复杂的操作，使用Lua脚本可以在Redis内部执行，减少网络往返。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> script = <span class="string">`</span></span><br><span class="line"><span class="string">  if redis.call(&quot;EXISTS&quot;, KEYS[1]) == 1 then</span></span><br><span class="line"><span class="string">    return redis.call(&quot;INCRBY&quot;, KEYS[1], ARGV[1])</span></span><br><span class="line"><span class="string">  else</span></span><br><span class="line"><span class="string">    return 0</span></span><br><span class="line"><span class="string">  end</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> result = <span class="keyword">await</span> redis.<span class="built_in">eval</span>(script, <span class="number">1</span>, <span class="string">&#x27;myCounter&#x27;</span>, <span class="number">1</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result); <span class="comment">// 递增计数器的结果</span></span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>看似写了很多，其实就是几个要点作为主要手段：</p><ul><li>找对数据结构</li><li>减少数据粒度</li><li>异步处理</li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;又去研究了一下redis，想到一些值得优化的地方。&lt;/p&gt;</summary>
    
    
    
    <category term="优化" scheme="https://zyha.cn/categories/%E4%BC%98%E5%8C%96/"/>
    
    
    <category term="优化" scheme="https://zyha.cn/tags/%E4%BC%98%E5%8C%96/"/>
    
    <category term="redis" scheme="https://zyha.cn/tags/redis/"/>
    
    <category term="后端" scheme="https://zyha.cn/tags/%E5%90%8E%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>使用Rclone将阿里云对象存储迁移至缤纷云S4对象存储</title>
    <link href="https://zyha.cn/transfer-oss-to-s4-by-rclone/"/>
    <id>https://zyha.cn/transfer-oss-to-s4-by-rclone/</id>
    <published>2024-06-09T07:38:21.000Z</published>
    <updated>2024-06-09T07:38:21.000Z</updated>
    
    <content type="html"><![CDATA[<p>主要原因是想省钱。。。</p><span id="more"></span><h2 id="Rclone简介"><a href="#Rclone简介" class="headerlink" title="Rclone简介"></a>Rclone简介</h2><p>Rclone 是一个用于和同步云平台同步文件和目录命令行工具。采用 Go 语言开发。</p><p>它允许在文件系统和云存储服务之间或在多个云存储服务之间访问和同步文件，它具有单向同步功能，使目录完全相同，它具有加密、缓存和联合后端，支持 Fuse 安装，并且可以通过 HTTP、WebDAV、FTP、SFTP服务本地或远程文件。</p><p>它支持超过 40 种不同的云存储服务，包括 Amazon S3, Google Drive, Dropbox, Microsoft OneDrive, Google Cloud Storage, Amazon Drive, OpenStack Swift, Backblaze B2, Yandex Disk, SFTP, WebDAV, FTP, SFTP, Minio, Wasabi, Alibaba OSS,, SwiftStack, Tencent COS, Wasabi, Yandex.Disk, Yandex.Files等等。</p><p>rclone 支持多种文件传输方式，包括复制，同步，移动，删除文件。它还支持文件加密和压缩，支持分块上传和分块下载，可以暂停和恢复传输，支持文件的校验和合并。</p><p>rclone 的主要优势在于它的灵活性和可扩展性。它可以用来做很多事情，包括备份，文件同步，数据迁移等。它可以在各种平台上运行，包括 Windows，macOS，Linux，FreeBSD，NetBSD 等。</p><p>rclone 的配置简单，可以使用命令行或者配置文件来配置。使用 rclone 可以非常方便的操作云存储，支持的命令也非常丰富，使用起来非常方便。</p><p>简单来讲，主要的功能如下：</p><ul><li>将文件备份（和加密）到云存储</li><li>从云存储还原（和解密）文件</li><li>将云数据镜像到其他云服务或本地</li><li>将数据迁移到云，或在云存储供应商之间迁移</li><li>将多个、加密、缓存或不同的云存储挂载为磁盘</li><li>使用 lsf、ljson、size、ncdu 分析和核算云存储上保- 存的数据</li><li>将文件系统合并在一起，将多个本地和&#x2F;或云文件系统呈现为一个</li></ul><h2 id="下载安装Rclone"><a href="#下载安装Rclone" class="headerlink" title="下载安装Rclone"></a>下载安装Rclone</h2><p>Rclone官方下载地址：<a href="https://rclone.org/downloads/">https://rclone.org/downloads/</a></p><p>本篇教程使用Mac版本，</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -v ; curl https://rclone.org/install.sh | sudo bash</span><br></pre></td></tr></table></figure><p>安装完成后，查看版本：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">❯ rclone --version</span><br><span class="line">rclone v1.66.0</span><br><span class="line">- os/version: darwin 14.4.1 (64 bit)</span><br><span class="line">- os/kernel: 23.4.0 (arm64)</span><br><span class="line">- os/type: darwin</span><br><span class="line">- os/arch: arm64 (ARMv8 compatible)</span><br><span class="line">- go/version: go1.22.1</span><br><span class="line">- go/linking: dynamic</span><br><span class="line">- go/tags: cmount</span><br></pre></td></tr></table></figure><p>注意，brew安装的rclone可能版本过低，不推荐。</p><p>win版本同样可以在官网找到，<a href="https://downloads.rclone.org/rclone-current-windows-amd64.zip">https://downloads.rclone.org/rclone-current-windows-amd64.zip</a></p><h2 id="Rclone常用操作"><a href="#Rclone常用操作" class="headerlink" title="Rclone常用操作"></a>Rclone常用操作</h2><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">rclone config - 以控制会话的形式添加rclone的配置，配置保存在.rclone.conf文件中。</span><br><span class="line">rclone copy - 将文件从源复制到目的地址，跳过已复制完成的。</span><br><span class="line">rclone sync - 将源数据同步到目的地址，只更新目的地址的数据。</span><br><span class="line">rclone move - 将源数据移动到目的地址。</span><br><span class="line">rclone delete - 删除指定路径下的文件内容。</span><br><span class="line">rclone purge - 清空指定路径下所有文件数据。</span><br><span class="line">rclone mkdir - 创建一个新目录。</span><br><span class="line">rclone rmdir - 删除空目录。</span><br><span class="line">rclone check - 检查源和目的地址数据是否匹配。</span><br><span class="line">rclone ls - 列出指定路径下所有的文件以及文件大小和路径。</span><br><span class="line">rclone lsd - 列出指定路径下所有的目录/容器/桶。</span><br><span class="line">rclone lsl - 列出指定路径下所有文件以及修改时间、文件大小和路径。</span><br><span class="line">rclone md5sum - 为指定路径下的所有文件产生一个md5sum文件。</span><br><span class="line">rclone sha1sum - 为指定路径下的所有文件产生一个sha1sum文件。</span><br><span class="line">rclone size - 获取指定路径下，文件内容的总大小。.</span><br><span class="line">rclone version - 查看当前版本。</span><br><span class="line">rclone cleanup - 清空remote。</span><br><span class="line">rclone dedupe - 交互式查找重复文件，进行删除/重命名操作。</span><br></pre></td></tr></table></figure><h2 id="配置阿里云OSS"><a href="#配置阿里云OSS" class="headerlink" title="配置阿里云OSS"></a>配置阿里云OSS</h2><p>输入命令 <code>rclone config</code> 来进入交互式配置选项，进行添加、删除、管理对象存储等操作。</p><p>然后输入n来新建一个存储，按照提示输入对象存储的信息。</p><p>下面是我的配置信息，可作为参考：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br></pre></td><td class="code"><pre><span class="line">❯ rclone config</span><br><span class="line">No remotes found, make a new one?</span><br><span class="line">n) New remote</span><br><span class="line">s) Set configuration password</span><br><span class="line">q) Quit config</span><br><span class="line">n/s/q&gt; n</span><br><span class="line"></span><br><span class="line">Enter name <span class="keyword">for</span> new remote.</span><br><span class="line">name&gt; oss</span><br><span class="line"></span><br><span class="line">Option Storage.</span><br><span class="line">Type of storage to configure.</span><br><span class="line">Choose a number from below, or <span class="built_in">type</span> <span class="keyword">in</span> your own value.</span><br><span class="line"> 1 / 1Fichier</span><br><span class="line">   \ (fichier)</span><br><span class="line"> 2 / Akamai NetStorage</span><br><span class="line">   \ (netstorage)</span><br><span class="line"> 3 / Alias <span class="keyword">for</span> an existing remote</span><br><span class="line">   \ (<span class="built_in">alias</span>)</span><br><span class="line"> 4 / Amazon S3 Compliant Storage Providers including AWS, Alibaba, ArvanCloud, Ceph, ChinaMobile, Cloudflare, DigitalOcean, Dreamhost, GCS, HuaweiOBS, IBMCOS, IDrive, IONOS, LyveCloud, Leviia, Liara, Linode, Minio, Netease, Petabox, RackCorp, Rclone, Scaleway, SeaweedFS, StackPath, Storj, Synology, TencentCOS, Wasabi, Qiniu and others</span><br><span class="line">   \ (s3)</span><br><span class="line"> 5 / Backblaze B2</span><br><span class="line">   \ (b2)</span><br><span class="line"> 6 / Better checksums <span class="keyword">for</span> other remotes</span><br><span class="line">   \ (hasher)</span><br><span class="line"> 7 / Box</span><br><span class="line">   \ (box)</span><br><span class="line"> 8 / Cache a remote</span><br><span class="line">   \ (cache)</span><br><span class="line"> 9 / Citrix Sharefile</span><br><span class="line">   \ (sharefile)</span><br><span class="line">10 / Combine several remotes into one</span><br><span class="line">   \ (combine)</span><br><span class="line">11 / Compress a remote</span><br><span class="line">   \ (compress)</span><br><span class="line">12 / Dropbox</span><br><span class="line">   \ (dropbox)</span><br><span class="line">13 / Encrypt/Decrypt a remote</span><br><span class="line">   \ (crypt)</span><br><span class="line">14 / Enterprise File Fabric</span><br><span class="line">   \ (filefabric)</span><br><span class="line">15 / FTP</span><br><span class="line">   \ (ftp)</span><br><span class="line">16 / Google Cloud Storage (this is not Google Drive)</span><br><span class="line">   \ (google cloud storage)</span><br><span class="line">17 / Google Drive</span><br><span class="line">   \ (drive)</span><br><span class="line">18 / Google Photos</span><br><span class="line">   \ (google photos)</span><br><span class="line">19 / HTTP</span><br><span class="line">   \ (http)</span><br><span class="line">20 / Hadoop distributed file system</span><br><span class="line">   \ (hdfs)</span><br><span class="line">21 / HiDrive</span><br><span class="line">   \ (hidrive)</span><br><span class="line">22 / ImageKit.io</span><br><span class="line">   \ (imagekit)</span><br><span class="line">23 / In memory object storage system.</span><br><span class="line">   \ (memory)</span><br><span class="line">24 / Internet Archive</span><br><span class="line">   \ (internetarchive)</span><br><span class="line">25 / Jottacloud</span><br><span class="line">   \ (jottacloud)</span><br><span class="line">26 / Koofr, Digi Storage and other Koofr-compatible storage providers</span><br><span class="line">   \ (koofr)</span><br><span class="line">27 / Linkbox</span><br><span class="line">   \ (linkbox)</span><br><span class="line">28 / Local Disk</span><br><span class="line">   \ (<span class="built_in">local</span>)</span><br><span class="line">29 / Mail.ru Cloud</span><br><span class="line">   \ (mailru)</span><br><span class="line">30 / Mega</span><br><span class="line">   \ (mega)</span><br><span class="line">31 / Microsoft Azure Blob Storage</span><br><span class="line">   \ (azureblob)</span><br><span class="line">32 / Microsoft Azure Files</span><br><span class="line">   \ (azurefiles)</span><br><span class="line">33 / Microsoft OneDrive</span><br><span class="line">   \ (onedrive)</span><br><span class="line">34 / OpenDrive</span><br><span class="line">   \ (opendrive)</span><br><span class="line">35 / OpenStack Swift (Rackspace Cloud Files, Blomp Cloud Storage, Memset Memstore, OVH)</span><br><span class="line">   \ (swift)</span><br><span class="line">36 / Oracle Cloud Infrastructure Object Storage</span><br><span class="line">   \ (oracleobjectstorage)</span><br><span class="line">37 / Pcloud</span><br><span class="line">   \ (pcloud)</span><br><span class="line">38 / PikPak</span><br><span class="line">   \ (pikpak)</span><br><span class="line">39 / Proton Drive</span><br><span class="line">   \ (protondrive)</span><br><span class="line">40 / Put.io</span><br><span class="line">   \ (putio)</span><br><span class="line">41 / QingCloud Object Storage</span><br><span class="line">   \ (qingstor)</span><br><span class="line">42 / Quatrix by Maytech</span><br><span class="line">   \ (quatrix)</span><br><span class="line">43 / SMB / CIFS</span><br><span class="line">   \ (smb)</span><br><span class="line">44 / SSH/SFTP</span><br><span class="line">   \ (sftp)</span><br><span class="line">45 / Sia Decentralized Cloud</span><br><span class="line">   \ (sia)</span><br><span class="line">46 / Storj Decentralized Cloud Storage</span><br><span class="line">   \ (storj)</span><br><span class="line">47 / Sugarsync</span><br><span class="line">   \ (sugarsync)</span><br><span class="line">48 / Transparently chunk/split large files</span><br><span class="line">   \ (chunker)</span><br><span class="line">49 / Union merges the contents of several upstream fs</span><br><span class="line">   \ (union)</span><br><span class="line">50 / Uptobox</span><br><span class="line">   \ (uptobox)</span><br><span class="line">51 / WebDAV</span><br><span class="line">   \ (webdav)</span><br><span class="line">52 / Yandex Disk</span><br><span class="line">   \ (yandex)</span><br><span class="line">53 / Zoho</span><br><span class="line">   \ (zoho)</span><br><span class="line">54 / premiumize.me</span><br><span class="line">   \ (premiumizeme)</span><br><span class="line">55 / seafile</span><br><span class="line">   \ (seafile)</span><br><span class="line">Storage&gt; 4</span><br><span class="line"></span><br><span class="line">Option provider.</span><br><span class="line">Choose your S3 provider.</span><br><span class="line">Choose a number from below, or <span class="built_in">type</span> <span class="keyword">in</span> your own value.</span><br><span class="line">Press Enter to leave empty.</span><br><span class="line"> 1 / Amazon Web Services (AWS) S3</span><br><span class="line">   \ (AWS)</span><br><span class="line"> 2 / Alibaba Cloud Object Storage System (OSS) formerly Aliyun</span><br><span class="line">   \ (Alibaba)</span><br><span class="line"> 3 / Arvan Cloud Object Storage (AOS)</span><br><span class="line">   \ (ArvanCloud)</span><br><span class="line"> 4 / Ceph Object Storage</span><br><span class="line">   \ (Ceph)</span><br><span class="line"> 5 / China Mobile Ecloud Elastic Object Storage (EOS)</span><br><span class="line">   \ (ChinaMobile)</span><br><span class="line"> 6 / Cloudflare R2 Storage</span><br><span class="line">   \ (Cloudflare)</span><br><span class="line"> 7 / DigitalOcean Spaces</span><br><span class="line">   \ (DigitalOcean)</span><br><span class="line"> 8 / Dreamhost DreamObjects</span><br><span class="line">   \ (Dreamhost)</span><br><span class="line"> 9 / Google Cloud Storage</span><br><span class="line">   \ (GCS)</span><br><span class="line">10 / Huawei Object Storage Service</span><br><span class="line">   \ (HuaweiOBS)</span><br><span class="line">11 / IBM COS S3</span><br><span class="line">   \ (IBMCOS)</span><br><span class="line">12 / IDrive e2</span><br><span class="line">   \ (IDrive)</span><br><span class="line">13 / IONOS Cloud</span><br><span class="line">   \ (IONOS)</span><br><span class="line">14 / Seagate Lyve Cloud</span><br><span class="line">   \ (LyveCloud)</span><br><span class="line">15 / Leviia Object Storage</span><br><span class="line">   \ (Leviia)</span><br><span class="line">16 / Liara Object Storage</span><br><span class="line">   \ (Liara)</span><br><span class="line">17 / Linode Object Storage</span><br><span class="line">   \ (Linode)</span><br><span class="line">18 / Minio Object Storage</span><br><span class="line">   \ (Minio)</span><br><span class="line">19 / Netease Object Storage (NOS)</span><br><span class="line">   \ (Netease)</span><br><span class="line">20 / Petabox Object Storage</span><br><span class="line">   \ (Petabox)</span><br><span class="line">21 / RackCorp Object Storage</span><br><span class="line">   \ (RackCorp)</span><br><span class="line">22 / Rclone S3 Server</span><br><span class="line">   \ (Rclone)</span><br><span class="line">23 / Scaleway Object Storage</span><br><span class="line">   \ (Scaleway)</span><br><span class="line">24 / SeaweedFS S3</span><br><span class="line">   \ (SeaweedFS)</span><br><span class="line">25 / StackPath Object Storage</span><br><span class="line">   \ (StackPath)</span><br><span class="line">26 / Storj (S3 Compatible Gateway)</span><br><span class="line">   \ (Storj)</span><br><span class="line">27 / Synology C2 Object Storage</span><br><span class="line">   \ (Synology)</span><br><span class="line">28 / Tencent Cloud Object Storage (COS)</span><br><span class="line">   \ (TencentCOS)</span><br><span class="line">29 / Wasabi Object Storage</span><br><span class="line">   \ (Wasabi)</span><br><span class="line">30 / Qiniu Object Storage (Kodo)</span><br><span class="line">   \ (Qiniu)</span><br><span class="line">31 / Any other S3 compatible provider</span><br><span class="line">   \ (Other)</span><br><span class="line">provider&gt; 2</span><br><span class="line"></span><br><span class="line">Option env_auth.</span><br><span class="line">Get AWS credentials from runtime (environment variables or EC2/ECS meta data <span class="keyword">if</span> no <span class="built_in">env</span> vars).</span><br><span class="line">Only applies <span class="keyword">if</span> access_key_id and secret_access_key is blank.</span><br><span class="line">Choose a number from below, or <span class="built_in">type</span> <span class="keyword">in</span> your own boolean value (<span class="literal">true</span> or <span class="literal">false</span>).</span><br><span class="line">Press Enter <span class="keyword">for</span> the default (<span class="literal">false</span>).</span><br><span class="line"> 1 / Enter AWS credentials <span class="keyword">in</span> the next step.</span><br><span class="line">   \ (<span class="literal">false</span>)</span><br><span class="line"> 2 / Get AWS credentials from the environment (<span class="built_in">env</span> vars or IAM).</span><br><span class="line">   \ (<span class="literal">true</span>)</span><br><span class="line">env_auth&gt; 1       </span><br><span class="line"></span><br><span class="line">Option access_key_id.</span><br><span class="line">AWS Access Key ID.</span><br><span class="line">Leave blank <span class="keyword">for</span> anonymous access or runtime credentials.</span><br><span class="line">Enter a value. Press Enter to leave empty.</span><br><span class="line">access_key_id&gt; xxxxxxx</span><br><span class="line"></span><br><span class="line">Option secret_access_key.</span><br><span class="line">AWS Secret Access Key (password).</span><br><span class="line">Leave blank <span class="keyword">for</span> anonymous access or runtime credentials.</span><br><span class="line">Enter a value. Press Enter to leave empty.</span><br><span class="line">secret_access_key&gt; xxxxxxx</span><br><span class="line"></span><br><span class="line">Option endpoint.</span><br><span class="line">Endpoint <span class="keyword">for</span> OSS API.</span><br><span class="line">Choose a number from below, or <span class="built_in">type</span> <span class="keyword">in</span> your own value.</span><br><span class="line">Press Enter to leave empty.</span><br><span class="line"> 1 / Global Accelerate</span><br><span class="line">   \ (oss-accelerate.aliyuncs.com)</span><br><span class="line"> 2 / Global Accelerate (outside mainland China)</span><br><span class="line">   \ (oss-accelerate-overseas.aliyuncs.com)</span><br><span class="line"> 3 / East China 1 (Hangzhou)</span><br><span class="line">   \ (oss-cn-hangzhou.aliyuncs.com)</span><br><span class="line"> 4 / East China 2 (Shanghai)</span><br><span class="line">   \ (oss-cn-shanghai.aliyuncs.com)</span><br><span class="line"> 5 / North China 1 (Qingdao)</span><br><span class="line">   \ (oss-cn-qingdao.aliyuncs.com)</span><br><span class="line"> 6 / North China 2 (Beijing)</span><br><span class="line">   \ (oss-cn-beijing.aliyuncs.com)</span><br><span class="line"> 7 / North China 3 (Zhangjiakou)</span><br><span class="line">   \ (oss-cn-zhangjiakou.aliyuncs.com)</span><br><span class="line"> 8 / North China 5 (Hohhot)</span><br><span class="line">   \ (oss-cn-huhehaote.aliyuncs.com)</span><br><span class="line"> 9 / North China 6 (Ulanqab)</span><br><span class="line">   \ (oss-cn-wulanchabu.aliyuncs.com)</span><br><span class="line">10 / South China 1 (Shenzhen)</span><br><span class="line">   \ (oss-cn-shenzhen.aliyuncs.com)</span><br><span class="line">11 / South China 2 (Heyuan)</span><br><span class="line">   \ (oss-cn-heyuan.aliyuncs.com)</span><br><span class="line">12 / South China 3 (Guangzhou)</span><br><span class="line">   \ (oss-cn-guangzhou.aliyuncs.com)</span><br><span class="line">13 / West China 1 (Chengdu)</span><br><span class="line">   \ (oss-cn-chengdu.aliyuncs.com)</span><br><span class="line">14 / Hong Kong (Hong Kong)</span><br><span class="line">   \ (oss-cn-hongkong.aliyuncs.com)</span><br><span class="line">15 / US West 1 (Silicon Valley)</span><br><span class="line">   \ (oss-us-west-1.aliyuncs.com)</span><br><span class="line">16 / US East 1 (Virginia)</span><br><span class="line">   \ (oss-us-east-1.aliyuncs.com)</span><br><span class="line">17 / Southeast Asia Southeast 1 (Singapore)</span><br><span class="line">   \ (oss-ap-southeast-1.aliyuncs.com)</span><br><span class="line">18 / Asia Pacific Southeast 2 (Sydney)</span><br><span class="line">   \ (oss-ap-southeast-2.aliyuncs.com)</span><br><span class="line">19 / Southeast Asia Southeast 3 (Kuala Lumpur)</span><br><span class="line">   \ (oss-ap-southeast-3.aliyuncs.com)</span><br><span class="line">20 / Asia Pacific Southeast 5 (Jakarta)</span><br><span class="line">   \ (oss-ap-southeast-5.aliyuncs.com)</span><br><span class="line">21 / Asia Pacific Northeast 1 (Japan)</span><br><span class="line">   \ (oss-ap-northeast-1.aliyuncs.com)</span><br><span class="line">22 / Asia Pacific South 1 (Mumbai)</span><br><span class="line">   \ (oss-ap-south-1.aliyuncs.com)</span><br><span class="line">23 / Central Europe 1 (Frankfurt)</span><br><span class="line">   \ (oss-eu-central-1.aliyuncs.com)</span><br><span class="line">24 / West Europe (London)</span><br><span class="line">   \ (oss-eu-west-1.aliyuncs.com)</span><br><span class="line">25 / Middle East 1 (Dubai)</span><br><span class="line">   \ (oss-me-east-1.aliyuncs.com)</span><br><span class="line">endpoint&gt; 13</span><br><span class="line"></span><br><span class="line">Option acl.</span><br><span class="line">Canned ACL used when creating buckets and storing or copying objects.</span><br><span class="line">This ACL is used <span class="keyword">for</span> creating objects and <span class="keyword">if</span> bucket_acl isn<span class="string">&#x27;t set, for creating buckets too.</span></span><br><span class="line"><span class="string">For more info visit https://docs.aws.amazon.com/AmazonS3/latest/dev/acl-overview.html#canned-acl</span></span><br><span class="line"><span class="string">Note that this ACL is applied when server-side copying objects as S3</span></span><br><span class="line"><span class="string">doesn&#x27;</span>t copy the ACL from the <span class="built_in">source</span> but rather writes a fresh one.</span><br><span class="line">If the acl is an empty string <span class="keyword">then</span> no X-Amz-Acl: header is added and</span><br><span class="line">the default (private) will be used.</span><br><span class="line">Choose a number from below, or <span class="built_in">type</span> <span class="keyword">in</span> your own value.</span><br><span class="line">Press Enter to leave empty.</span><br><span class="line">   / Owner gets FULL_CONTROL.</span><br><span class="line"> 1 | No one <span class="keyword">else</span> has access rights (default).</span><br><span class="line">   \ (private)</span><br><span class="line">   / Owner gets FULL_CONTROL.</span><br><span class="line"> 2 | The AllUsers group gets READ access.</span><br><span class="line">   \ (public-read)</span><br><span class="line">   / Owner gets FULL_CONTROL.</span><br><span class="line"> 3 | The AllUsers group gets READ and WRITE access.</span><br><span class="line">   | Granting this on a bucket is generally not recommended.</span><br><span class="line">   \ (public-read-write)</span><br><span class="line">   / Owner gets FULL_CONTROL.</span><br><span class="line"> 4 | The AuthenticatedUsers group gets READ access.</span><br><span class="line">   \ (authenticated-read)</span><br><span class="line">   / Object owner gets FULL_CONTROL.</span><br><span class="line"> 5 | Bucket owner gets READ access.</span><br><span class="line">   | If you specify this canned ACL when creating a bucket, Amazon S3 ignores it.</span><br><span class="line">   \ (bucket-owner-read)</span><br><span class="line">   / Both the object owner and the bucket owner get FULL_CONTROL over the object.</span><br><span class="line"> 6 | If you specify this canned ACL when creating a bucket, Amazon S3 ignores it.</span><br><span class="line">   \ (bucket-owner-full-control)</span><br><span class="line">acl&gt; 1</span><br><span class="line"></span><br><span class="line">Option storage_class.</span><br><span class="line">The storage class to use when storing new objects <span class="keyword">in</span> OSS.</span><br><span class="line">Choose a number from below, or <span class="built_in">type</span> <span class="keyword">in</span> your own value.</span><br><span class="line">Press Enter to leave empty.</span><br><span class="line"> 1 / Default</span><br><span class="line">   \ ()</span><br><span class="line"> 2 / Standard storage class</span><br><span class="line">   \ (STANDARD)</span><br><span class="line"> 3 / Archive storage mode</span><br><span class="line">   \ (GLACIER)</span><br><span class="line"> 4 / Infrequent access storage mode</span><br><span class="line">   \ (STANDARD_IA)</span><br><span class="line">storage_class&gt; 2</span><br><span class="line"></span><br><span class="line">Edit advanced config?</span><br><span class="line">y) Yes</span><br><span class="line">n) No (default)</span><br><span class="line">y/n&gt; n</span><br><span class="line"></span><br><span class="line">Configuration complete.</span><br><span class="line">Options:</span><br><span class="line">- <span class="built_in">type</span>: s3</span><br><span class="line">- provider: Alibaba</span><br><span class="line">- access_key_id: xxxx</span><br><span class="line">- secret_access_key: xxxx</span><br><span class="line">- endpoint: oss-cn-chengdu.aliyuncs.com</span><br><span class="line">- acl: private</span><br><span class="line">- storage_class: STANDARD</span><br><span class="line">Keep this <span class="string">&quot;oss&quot;</span> remote?</span><br><span class="line">y) Yes this is OK (default)</span><br><span class="line">e) Edit this remote</span><br><span class="line">d) Delete this remote</span><br><span class="line">y/e/d&gt; y</span><br><span class="line"></span><br><span class="line">Current remotes:</span><br><span class="line"></span><br><span class="line">Name                 Type</span><br><span class="line">====                 ====</span><br><span class="line">oss                  s3</span><br><span class="line"></span><br><span class="line">e) Edit existing remote</span><br><span class="line">n) New remote</span><br><span class="line">d) Delete remote</span><br><span class="line">r) Rename remote</span><br><span class="line">c) Copy remote</span><br><span class="line">s) Set configuration password</span><br><span class="line">q) Quit config</span><br><span class="line">e/n/d/r/c/s/q&gt; q</span><br></pre></td></tr></table></figure><h2 id="配置S4"><a href="#配置S4" class="headerlink" title="配置S4"></a>配置S4</h2><p>S4也是支持S3协议的对象存储，配置方法与阿里云对象存储大致相同，这里不再赘述。</p><p>其中<code>key</code>和<code>secret</code>可以在 <a href="https://console.bitiful.com/accessKey">https://console.bitiful.com/accessKey</a> 处设置。</p><ul><li>注意，此处用户权限不仅要给<code>读</code>,<code>写</code>,还要给<code>列表</code>。</li></ul><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://img.tucang.cc/api/image/show/d2ecf1a42b483f00109a8f911ceb0931"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br></pre></td><td class="code"><pre><span class="line">❯ rclone config   </span><br><span class="line">Current remotes:</span><br><span class="line"></span><br><span class="line">Name                 Type</span><br><span class="line">====                 ====</span><br><span class="line">oss                  s3</span><br><span class="line"></span><br><span class="line">e) Edit existing remote</span><br><span class="line">n) New remote</span><br><span class="line">d) Delete remote</span><br><span class="line">r) Rename remote</span><br><span class="line">c) Copy remote</span><br><span class="line">s) Set configuration password</span><br><span class="line">q) Quit config</span><br><span class="line">e/n/d/r/c/s/q&gt; n</span><br><span class="line"></span><br><span class="line">Enter name <span class="keyword">for</span> new remote.</span><br><span class="line">name&gt; s4</span><br><span class="line"></span><br><span class="line">Option Storage.</span><br><span class="line">Type of storage to configure.</span><br><span class="line">Choose a number from below, or <span class="built_in">type</span> <span class="keyword">in</span> your own value.</span><br><span class="line"> 1 / 1Fichier</span><br><span class="line">   \ (fichier)</span><br><span class="line"> 2 / Akamai NetStorage</span><br><span class="line">   \ (netstorage)</span><br><span class="line"> 3 / Alias <span class="keyword">for</span> an existing remote</span><br><span class="line">   \ (<span class="built_in">alias</span>)</span><br><span class="line"> 4 / Amazon S3 Compliant Storage Providers including AWS, Alibaba, ArvanCloud, Ceph, ChinaMobile, Cloudflare, DigitalOcean, Dreamhost, GCS, HuaweiOBS, IBMCOS, IDrive, IONOS, LyveCloud, Leviia, Liara, Linode, Minio, Netease, Petabox, RackCorp, Rclone, Scaleway, SeaweedFS, StackPath, Storj, Synology, TencentCOS, Wasabi, Qiniu and others</span><br><span class="line">   \ (s3)</span><br><span class="line"> 5 / Backblaze B2</span><br><span class="line">   \ (b2)</span><br><span class="line"> 6 / Better checksums <span class="keyword">for</span> other remotes</span><br><span class="line">   \ (hasher)</span><br><span class="line"> 7 / Box</span><br><span class="line">   \ (box)</span><br><span class="line"> 8 / Cache a remote</span><br><span class="line">   \ (cache)</span><br><span class="line"> 9 / Citrix Sharefile</span><br><span class="line">   \ (sharefile)</span><br><span class="line">10 / Combine several remotes into one</span><br><span class="line">   \ (combine)</span><br><span class="line">11 / Compress a remote</span><br><span class="line">   \ (compress)</span><br><span class="line">12 / Dropbox</span><br><span class="line">   \ (dropbox)</span><br><span class="line">13 / Encrypt/Decrypt a remote</span><br><span class="line">   \ (crypt)</span><br><span class="line">14 / Enterprise File Fabric</span><br><span class="line">   \ (filefabric)</span><br><span class="line">15 / FTP</span><br><span class="line">   \ (ftp)</span><br><span class="line">16 / Google Cloud Storage (this is not Google Drive)</span><br><span class="line">   \ (google cloud storage)</span><br><span class="line">17 / Google Drive</span><br><span class="line">   \ (drive)</span><br><span class="line">18 / Google Photos</span><br><span class="line">   \ (google photos)</span><br><span class="line">19 / HTTP</span><br><span class="line">   \ (http)</span><br><span class="line">20 / Hadoop distributed file system</span><br><span class="line">   \ (hdfs)</span><br><span class="line">21 / HiDrive</span><br><span class="line">   \ (hidrive)</span><br><span class="line">22 / ImageKit.io</span><br><span class="line">   \ (imagekit)</span><br><span class="line">23 / In memory object storage system.</span><br><span class="line">   \ (memory)</span><br><span class="line">24 / Internet Archive</span><br><span class="line">   \ (internetarchive)</span><br><span class="line">25 / Jottacloud</span><br><span class="line">   \ (jottacloud)</span><br><span class="line">26 / Koofr, Digi Storage and other Koofr-compatible storage providers</span><br><span class="line">   \ (koofr)</span><br><span class="line">27 / Linkbox</span><br><span class="line">   \ (linkbox)</span><br><span class="line">28 / Local Disk</span><br><span class="line">   \ (<span class="built_in">local</span>)</span><br><span class="line">29 / Mail.ru Cloud</span><br><span class="line">   \ (mailru)</span><br><span class="line">30 / Mega</span><br><span class="line">   \ (mega)</span><br><span class="line">31 / Microsoft Azure Blob Storage</span><br><span class="line">   \ (azureblob)</span><br><span class="line">32 / Microsoft Azure Files</span><br><span class="line">   \ (azurefiles)</span><br><span class="line">33 / Microsoft OneDrive</span><br><span class="line">   \ (onedrive)</span><br><span class="line">34 / OpenDrive</span><br><span class="line">   \ (opendrive)</span><br><span class="line">35 / OpenStack Swift (Rackspace Cloud Files, Blomp Cloud Storage, Memset Memstore, OVH)</span><br><span class="line">   \ (swift)</span><br><span class="line">36 / Oracle Cloud Infrastructure Object Storage</span><br><span class="line">   \ (oracleobjectstorage)</span><br><span class="line">37 / Pcloud</span><br><span class="line">   \ (pcloud)</span><br><span class="line">38 / PikPak</span><br><span class="line">   \ (pikpak)</span><br><span class="line">39 / Proton Drive</span><br><span class="line">   \ (protondrive)</span><br><span class="line">40 / Put.io</span><br><span class="line">   \ (putio)</span><br><span class="line">41 / QingCloud Object Storage</span><br><span class="line">   \ (qingstor)</span><br><span class="line">42 / Quatrix by Maytech</span><br><span class="line">   \ (quatrix)</span><br><span class="line">43 / SMB / CIFS</span><br><span class="line">   \ (smb)</span><br><span class="line">44 / SSH/SFTP</span><br><span class="line">   \ (sftp)</span><br><span class="line">45 / Sia Decentralized Cloud</span><br><span class="line">   \ (sia)</span><br><span class="line">46 / Storj Decentralized Cloud Storage</span><br><span class="line">   \ (storj)</span><br><span class="line">47 / Sugarsync</span><br><span class="line">   \ (sugarsync)</span><br><span class="line">48 / Transparently chunk/split large files</span><br><span class="line">   \ (chunker)</span><br><span class="line">49 / Union merges the contents of several upstream fs</span><br><span class="line">   \ (union)</span><br><span class="line">50 / Uptobox</span><br><span class="line">   \ (uptobox)</span><br><span class="line">51 / WebDAV</span><br><span class="line">   \ (webdav)</span><br><span class="line">52 / Yandex Disk</span><br><span class="line">   \ (yandex)</span><br><span class="line">53 / Zoho</span><br><span class="line">   \ (zoho)</span><br><span class="line">54 / premiumize.me</span><br><span class="line">   \ (premiumizeme)</span><br><span class="line">55 / seafile</span><br><span class="line">   \ (seafile)</span><br><span class="line">Storage&gt; 4</span><br><span class="line"></span><br><span class="line">Option provider.</span><br><span class="line">Choose your S3 provider.</span><br><span class="line">Choose a number from below, or <span class="built_in">type</span> <span class="keyword">in</span> your own value.</span><br><span class="line">Press Enter to leave empty.</span><br><span class="line"> 1 / Amazon Web Services (AWS) S3</span><br><span class="line">   \ (AWS)</span><br><span class="line"> 2 / Alibaba Cloud Object Storage System (OSS) formerly Aliyun</span><br><span class="line">   \ (Alibaba)</span><br><span class="line"> 3 / Arvan Cloud Object Storage (AOS)</span><br><span class="line">   \ (ArvanCloud)</span><br><span class="line"> 4 / Ceph Object Storage</span><br><span class="line">   \ (Ceph)</span><br><span class="line"> 5 / China Mobile Ecloud Elastic Object Storage (EOS)</span><br><span class="line">   \ (ChinaMobile)</span><br><span class="line"> 6 / Cloudflare R2 Storage</span><br><span class="line">   \ (Cloudflare)</span><br><span class="line"> 7 / DigitalOcean Spaces</span><br><span class="line">   \ (DigitalOcean)</span><br><span class="line"> 8 / Dreamhost DreamObjects</span><br><span class="line">   \ (Dreamhost)</span><br><span class="line"> 9 / Google Cloud Storage</span><br><span class="line">   \ (GCS)</span><br><span class="line">10 / Huawei Object Storage Service</span><br><span class="line">   \ (HuaweiOBS)</span><br><span class="line">11 / IBM COS S3</span><br><span class="line">   \ (IBMCOS)</span><br><span class="line">12 / IDrive e2</span><br><span class="line">   \ (IDrive)</span><br><span class="line">13 / IONOS Cloud</span><br><span class="line">   \ (IONOS)</span><br><span class="line">14 / Seagate Lyve Cloud</span><br><span class="line">   \ (LyveCloud)</span><br><span class="line">15 / Leviia Object Storage</span><br><span class="line">   \ (Leviia)</span><br><span class="line">16 / Liara Object Storage</span><br><span class="line">   \ (Liara)</span><br><span class="line">17 / Linode Object Storage</span><br><span class="line">   \ (Linode)</span><br><span class="line">18 / Minio Object Storage</span><br><span class="line">   \ (Minio)</span><br><span class="line">19 / Netease Object Storage (NOS)</span><br><span class="line">   \ (Netease)</span><br><span class="line">20 / Petabox Object Storage</span><br><span class="line">   \ (Petabox)</span><br><span class="line">21 / RackCorp Object Storage</span><br><span class="line">   \ (RackCorp)</span><br><span class="line">22 / Rclone S3 Server</span><br><span class="line">   \ (Rclone)</span><br><span class="line">23 / Scaleway Object Storage</span><br><span class="line">   \ (Scaleway)</span><br><span class="line">24 / SeaweedFS S3</span><br><span class="line">   \ (SeaweedFS)</span><br><span class="line">25 / StackPath Object Storage</span><br><span class="line">   \ (StackPath)</span><br><span class="line">26 / Storj (S3 Compatible Gateway)</span><br><span class="line">   \ (Storj)</span><br><span class="line">27 / Synology C2 Object Storage</span><br><span class="line">   \ (Synology)</span><br><span class="line">28 / Tencent Cloud Object Storage (COS)</span><br><span class="line">   \ (TencentCOS)</span><br><span class="line">29 / Wasabi Object Storage</span><br><span class="line">   \ (Wasabi)</span><br><span class="line">30 / Qiniu Object Storage (Kodo)</span><br><span class="line">   \ (Qiniu)</span><br><span class="line">31 / Any other S3 compatible provider</span><br><span class="line">   \ (Other)</span><br><span class="line">provider&gt; 31</span><br><span class="line"></span><br><span class="line">Option env_auth.</span><br><span class="line">Get AWS credentials from runtime (environment variables or EC2/ECS meta data <span class="keyword">if</span> no <span class="built_in">env</span> vars).</span><br><span class="line">Only applies <span class="keyword">if</span> access_key_id and secret_access_key is blank.</span><br><span class="line">Choose a number from below, or <span class="built_in">type</span> <span class="keyword">in</span> your own boolean value (<span class="literal">true</span> or <span class="literal">false</span>).</span><br><span class="line">Press Enter <span class="keyword">for</span> the default (<span class="literal">false</span>).</span><br><span class="line"> 1 / Enter AWS credentials <span class="keyword">in</span> the next step.</span><br><span class="line">   \ (<span class="literal">false</span>)</span><br><span class="line"> 2 / Get AWS credentials from the environment (<span class="built_in">env</span> vars or IAM).</span><br><span class="line">   \ (<span class="literal">true</span>)</span><br><span class="line">env_auth&gt; 1</span><br><span class="line"></span><br><span class="line">Option access_key_id.</span><br><span class="line">AWS Access Key ID.</span><br><span class="line">Leave blank <span class="keyword">for</span> anonymous access or runtime credentials.</span><br><span class="line">Enter a value. Press Enter to leave empty.</span><br><span class="line">access_key_id&gt; xxxx</span><br><span class="line"></span><br><span class="line">Option secret_access_key.</span><br><span class="line">AWS Secret Access Key (password).</span><br><span class="line">Leave blank <span class="keyword">for</span> anonymous access or runtime credentials.</span><br><span class="line">Enter a value. Press Enter to leave empty.</span><br><span class="line">secret_access_key&gt; xxxx</span><br><span class="line"></span><br><span class="line">Option region.</span><br><span class="line">Region to connect to.</span><br><span class="line">Leave blank <span class="keyword">if</span> you are using an S3 <span class="built_in">clone</span> and you don<span class="string">&#x27;t have a region.</span></span><br><span class="line"><span class="string">Choose a number from below, or type in your own value.</span></span><br><span class="line"><span class="string">Press Enter to leave empty.</span></span><br><span class="line"><span class="string">   / Use this if unsure.</span></span><br><span class="line"><span class="string"> 1 | Will use v4 signatures and an empty region.</span></span><br><span class="line"><span class="string">   \ ()</span></span><br><span class="line"><span class="string">   / Use this only if v4 signatures don&#x27;</span>t work.</span><br><span class="line"> 2 | E.g. pre Jewel/v10 CEPH.</span><br><span class="line">   \ (other-v2-signature)</span><br><span class="line">region&gt; 1</span><br><span class="line"></span><br><span class="line">Option endpoint.</span><br><span class="line">Endpoint <span class="keyword">for</span> S3 API.</span><br><span class="line">Required when using an S3 <span class="built_in">clone</span>.</span><br><span class="line">Enter a value. Press Enter to leave empty.</span><br><span class="line">endpoint&gt; https://s3.bitiful.net</span><br><span class="line"></span><br><span class="line">Option location_constraint.</span><br><span class="line">Location constraint - must be <span class="built_in">set</span> to match the Region.</span><br><span class="line">Leave blank <span class="keyword">if</span> not sure. Used when creating buckets only.</span><br><span class="line">Enter a value. Press Enter to leave empty.</span><br><span class="line">location_constraint&gt; </span><br><span class="line"></span><br><span class="line">Option acl.</span><br><span class="line">Canned ACL used when creating buckets and storing or copying objects.</span><br><span class="line">This ACL is used <span class="keyword">for</span> creating objects and <span class="keyword">if</span> bucket_acl isn<span class="string">&#x27;t set, for creating buckets too.</span></span><br><span class="line"><span class="string">For more info visit https://docs.aws.amazon.com/AmazonS3/latest/dev/acl-overview.html#canned-acl</span></span><br><span class="line"><span class="string">Note that this ACL is applied when server-side copying objects as S3</span></span><br><span class="line"><span class="string">doesn&#x27;</span>t copy the ACL from the <span class="built_in">source</span> but rather writes a fresh one.</span><br><span class="line">If the acl is an empty string <span class="keyword">then</span> no X-Amz-Acl: header is added and</span><br><span class="line">the default (private) will be used.</span><br><span class="line">Choose a number from below, or <span class="built_in">type</span> <span class="keyword">in</span> your own value.</span><br><span class="line">Press Enter to leave empty.</span><br><span class="line">   / Owner gets FULL_CONTROL.</span><br><span class="line"> 1 | No one <span class="keyword">else</span> has access rights (default).</span><br><span class="line">   \ (private)</span><br><span class="line">   / Owner gets FULL_CONTROL.</span><br><span class="line"> 2 | The AllUsers group gets READ access.</span><br><span class="line">   \ (public-read)</span><br><span class="line">   / Owner gets FULL_CONTROL.</span><br><span class="line"> 3 | The AllUsers group gets READ and WRITE access.</span><br><span class="line">   | Granting this on a bucket is generally not recommended.</span><br><span class="line">   \ (public-read-write)</span><br><span class="line">   / Owner gets FULL_CONTROL.</span><br><span class="line"> 4 | The AuthenticatedUsers group gets READ access.</span><br><span class="line">   \ (authenticated-read)</span><br><span class="line">   / Object owner gets FULL_CONTROL.</span><br><span class="line"> 5 | Bucket owner gets READ access.</span><br><span class="line">   | If you specify this canned ACL when creating a bucket, Amazon S3 ignores it.</span><br><span class="line">   \ (bucket-owner-read)</span><br><span class="line">   / Both the object owner and the bucket owner get FULL_CONTROL over the object.</span><br><span class="line"> 6 | If you specify this canned ACL when creating a bucket, Amazon S3 ignores it.</span><br><span class="line">   \ (bucket-owner-full-control)</span><br><span class="line">acl&gt; 1</span><br><span class="line"></span><br><span class="line">Edit advanced config?</span><br><span class="line">y) Yes</span><br><span class="line">n) No (default)</span><br><span class="line">y/n&gt; n</span><br><span class="line"></span><br><span class="line">Configuration complete.</span><br><span class="line">Options:</span><br><span class="line">- <span class="built_in">type</span>: s3</span><br><span class="line">- provider: Other</span><br><span class="line">- access_key_id: xxx</span><br><span class="line">- secret_access_key: xxx</span><br><span class="line">- endpoint: https://s3.bitiful.net</span><br><span class="line">- acl: private</span><br><span class="line">Keep this <span class="string">&quot;s4&quot;</span> remote?</span><br><span class="line">y) Yes this is OK (default)</span><br><span class="line">e) Edit this remote</span><br><span class="line">d) Delete this remote</span><br><span class="line">y/e/d&gt; y</span><br><span class="line"></span><br><span class="line">Current remotes:</span><br><span class="line"></span><br><span class="line">Name                 Type</span><br><span class="line">====                 ====</span><br><span class="line">oss                  s3</span><br><span class="line">s4                   s3</span><br><span class="line"></span><br><span class="line">e) Edit existing remote</span><br><span class="line">n) New remote</span><br><span class="line">d) Delete remote</span><br><span class="line">r) Rename remote</span><br><span class="line">c) Copy remote</span><br><span class="line">s) Set configuration password</span><br><span class="line">q) Quit config</span><br><span class="line">e/n/d/r/c/s/q&gt; q</span><br></pre></td></tr></table></figure><h2 id="最终结果"><a href="#最终结果" class="headerlink" title="最终结果"></a>最终结果</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">❯ rclone config   </span><br><span class="line">Current remotes:</span><br><span class="line"></span><br><span class="line">Name                 Type</span><br><span class="line">====                 ====</span><br><span class="line">oss                  s3</span><br><span class="line">s4                   s3</span><br><span class="line"></span><br><span class="line">e) Edit existing remote</span><br><span class="line">n) New remote</span><br><span class="line">d) Delete remote</span><br><span class="line">r) Rename remote</span><br><span class="line">c) Copy remote</span><br><span class="line">s) Set configuration password</span><br><span class="line">q) Quit config</span><br><span class="line">e/n/d/r/c/s/q&gt; </span><br></pre></td></tr></table></figure><h2 id="迁移数据"><a href="#迁移数据" class="headerlink" title="迁移数据"></a>迁移数据</h2><ul><li>在迁移前，确定oss中已经删除了不需要备份的数据。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># rclone sync oss:laic-cdn s4:laic-cdn --progress</span></span><br><span class="line"><span class="comment"># rclone sync 源（配置文件名称）: 源数据Bucket  目标源名称：目标bucket</span></span><br><span class="line"></span><br><span class="line">❯ rclone <span class="built_in">sync</span> oss:laic-cdn s4:laic-cdn --progress</span><br><span class="line">2024/06/09 23:54:53 ERROR : public/upload/: Entry doesn<span class="string">&#x27;t belong in directory &quot;public/upload&quot; (same as directory) - ignoring</span></span><br><span class="line"><span class="string">2024/06/09 23:54:53 ERROR : public/upload/: Entry doesn&#x27;</span>t belong <span class="keyword">in</span> directory <span class="string">&quot;public/upload&quot;</span> (same as directory) - ignoring</span><br><span class="line">Transferred:     146.137 MiB / 146.137 MiB, 100%, 93.290 KiB/s, ETA 0s</span><br><span class="line">Transferred:         8635 / 8635, 100%</span><br><span class="line">Elapsed time:      6m33.3s</span><br></pre></td></tr></table></figure><p>同步时间长达6分半的主要原因就是忘了删除oss中的log文件。</p><p>再次执行只会对比差异然后同步，不会重复上传。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">❯ rclone <span class="built_in">sync</span> oss:laic-cdn s4:laic-cdn --progress</span><br><span class="line">2024/06/10 00:33:58 ERROR : public/upload/: Entry doesn<span class="string">&#x27;t belong in directory &quot;public/upload&quot; (same as directory) - ignoring</span></span><br><span class="line"><span class="string">2024/06/10 00:33:58 ERROR : public/upload/: Entry doesn&#x27;</span>t belong <span class="keyword">in</span> directory <span class="string">&quot;public/upload&quot;</span> (same as directory) - ignoring</span><br><span class="line">Transferred:      15.793 KiB / 15.793 KiB, 100%, 1.972 KiB/s, ETA 0s</span><br><span class="line">Checks:               730 / 730, 100%</span><br><span class="line">Transferred:            2 / 2, 100%</span><br><span class="line">Elapsed time:         9.2s</span><br><span class="line">~ 9s </span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;主要原因是想省钱。。。&lt;/p&gt;</summary>
    
    
    
    <category term="网站" scheme="https://zyha.cn/categories/%E7%BD%91%E7%AB%99/"/>
    
    
    <category term="优化" scheme="https://zyha.cn/tags/%E4%BC%98%E5%8C%96/"/>
    
    <category term="迁移" scheme="https://zyha.cn/tags/%E8%BF%81%E7%A7%BB/"/>
    
  </entry>
  
  <entry>
    <title>终端环境下GitHub无法链接</title>
    <link href="https://zyha.cn/cannot-link-github-in-terminal/"/>
    <id>https://zyha.cn/cannot-link-github-in-terminal/</id>
    <published>2024-06-08T06:22:23.000Z</published>
    <updated>2024-06-08T06:22:23.000Z</updated>
    
    <content type="html"><![CDATA[<p>之前github在网页端和terminal中都是可以正常打开的，今天忽然报错无法链接，提示：</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">git push origin main</span><br><span class="line">kex_exchange_identification: Connection closed by remote host</span><br><span class="line">Connection closed by 198.18.0.21 port 22</span><br><span class="line">fatal: Could not read from remote repository.</span><br><span class="line"></span><br><span class="line">Please make sure you have the correct access rights</span><br><span class="line">and the repository exists.</span><br></pre></td></tr></table></figure><span id="more"></span><h2 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h2><p>之前在win上遇到过这个问题，通过修改ssh的config文件解决了。</p><p>在终端输入：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code ~/.ssh/config</span><br></pre></td></tr></table></figure><p>在vscode中打开，</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Include ~/.orbstack/ssh/config</span><br></pre></td></tr></table></figure><p>发现仅有一行导入orbstack的配置的信息，需要添加github的配置：</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Host github.com</span><br><span class="line">    Hostname ssh.github.com</span><br><span class="line">    Port 443</span><br><span class="line">    User git</span><br></pre></td></tr></table></figure><p>保存后，再次尝试push，应该就可以正常链接了。</p><p>v2ex也早就有大佬@lostberryzz给出了解释，</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">机场屏蔽了落地机到 22 端口的连接，这是很多机场的一贯作坊，防止你通过机场的 IP 去扫描爆破。</span><br><span class="line">而小火箭接管了所有流量导致 git push 用不了，而用 CFW 终端走的是直连自然可以用。</span><br><span class="line"></span><br><span class="line">另外 tun 模式下，ping google 和 github 都返回的是 fake ip ，并不代表真的能 ping 通。</span><br></pre></td></tr></table></figure><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://docs.github.com/en/authentication/troubleshooting-ssh/using-ssh-over-the-https-port">Using SSH over the HTTPS port</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;之前github在网页端和terminal中都是可以正常打开的，今天忽然报错无法链接，提示：&lt;/p&gt;
&lt;figure class=&quot;highlight txt&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;git push origin main&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;kex_exchange_identification: Connection closed by remote host&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Connection closed by 198.18.0.21 port 22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;fatal: Could not read from remote repository.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Please make sure you have the correct access rights&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;and the repository exists.&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="优化" scheme="https://zyha.cn/categories/%E4%BC%98%E5%8C%96/"/>
    
    
    <category term="github" scheme="https://zyha.cn/tags/github/"/>
    
    <category term="ssh" scheme="https://zyha.cn/tags/ssh/"/>
    
  </entry>
  
  <entry>
    <title>黑神话悟空已开启预售</title>
    <link href="https://zyha.cn/Black-Myth-wukong-has-opened-pre-sale/"/>
    <id>https://zyha.cn/Black-Myth-wukong-has-opened-pre-sale/</id>
    <published>2024-06-08T05:28:11.000Z</published>
    <updated>2024-06-08T05:28:11.000Z</updated>
    
    <content type="html"><![CDATA[<p>目前国区就是最便宜的了。</p><p>直达链接：<a href="https://store.steampowered.com/app/2358720/">https://store.steampowered.com/app/2358720/</a></p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://cdn.zyha.cn/blog/20240608133242.png?x-oss-process=style/blog" alt="数字豪华版"></p><span id="more"></span><h2 id="各区比价"><a href="#各区比价" class="headerlink" title="各区比价"></a>各区比价</h2><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://cdn.zyha.cn/blog/20240608144636.png?x-oss-process=style/blog" alt="20240608144636"></p><h2 id="官方推荐配置（Windows）"><a href="#官方推荐配置（Windows）" class="headerlink" title="官方推荐配置（Windows）"></a>官方推荐配置（Windows）</h2><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://cdn.zyha.cn/blog/20240608145024.png?x-oss-process=style/blog" alt="20240608145024"></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;目前国区就是最便宜的了。&lt;/p&gt;
&lt;p&gt;直达链接：&lt;a href=&quot;https://store.steampowered.com/app/2358720/&quot;&gt;https://store.steampowered.com/app/2358720/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://cdn.zyha.cn/blog/20240608133242.png?x-oss-process=style/blog&quot; alt=&quot;数字豪华版&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="游戏" scheme="https://zyha.cn/categories/%E6%B8%B8%E6%88%8F/"/>
    
    
    <category term="游戏" scheme="https://zyha.cn/tags/%E6%B8%B8%E6%88%8F/"/>
    
  </entry>
  
  <entry>
    <title>个体户0申报及工商年报提交教程</title>
    <link href="https://zyha.cn/0-report-and-business-license-submission-tutorial-for-individual-entrepreneurs/"/>
    <id>https://zyha.cn/0-report-and-business-license-submission-tutorial-for-individual-entrepreneurs/</id>
    <published>2024-05-28T03:34:42.000Z</published>
    <updated>2024-05-28T03:34:42.000Z</updated>
    
    <content type="html"><![CDATA[<p>重要提醒：根据《个体工商户年度报告暂行办法》规定：个体工商户应当于每年1月1日至6月30日向负责工商行政管理部门报送上一年度年度报告+税务申报（无业务申请0申报即可）</p><p>很多人开电商店铺的时候，办理个体户营业执照，但是因为没有相关经验，不知道自己的义务所在，导致企业状态经营异常，被市场监督管理部门处1万元以下的罚款。在外边请专业的记账报税，其实就是帮你O申报，点点鼠标的事情，一年最少500元+，甚至有的一年，因为这个信息差花1000+元。</p><span id="more"></span><h2 id="0申报"><a href="#0申报" class="headerlink" title="0申报"></a>0申报</h2><ul><li>国家税务局深圳市电子税务局：<a href="https://etax.shenzhen.chinatax.gov.cn/">https://etax.shenzhen.chinatax.gov.cn/</a></li><li>四川电子税务局：<a href="https://tpass.sichuan.chinatax.gov.cn:8443/">https://tpass.sichuan.chinatax.gov.cn:8443/</a></li></ul><p>此处以深圳为例，其他地方的请自行查找。</p><h2 id="工商年报"><a href="#工商年报" class="headerlink" title="工商年报"></a>工商年报</h2><p>按实际填写即可，和税务不关联，主要帮助国家了解你的企业经营状况。</p><h3 id="国家企业信用信息公示系统"><a href="#国家企业信用信息公示系统" class="headerlink" title="国家企业信用信息公示系统"></a>国家企业信用信息公示系统</h3><p>全国统一网址：<a href="http://www.gsxt.gov.cn,选择相应的地区即可,点击“企业信息填报”./">www.gsxt.gov.cn，选择相应的地区即可，点击“企业信息填报”。</a></p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://cdn.zyha.cn/blog/20240528114255.png?x-oss-process=style/blog" alt="20240528114255"></p><h3 id="直达四川工商年报"><a href="#直达四川工商年报" class="headerlink" title="直达四川工商年报"></a>直达四川工商年报</h3><p>登录界面： <a href="http://182.131.3.111:8000/noticerpt/user/popup_login">http://182.131.3.111:8000/noticerpt/user/popup_login</a></p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://cdn.zyha.cn/blog/20240528114450.png?x-oss-process=style/blog" alt="20240528114450"></p><p>选择【年度报告填写】<br><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://cdn.zyha.cn/blog/20240528114744.png?x-oss-process=style/blog" alt="20240528114744"></p><p>勾选确认</p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://cdn.zyha.cn/blog/20240528114919.png?x-oss-process=style/blog" alt="20240528114919"></p><p>选择最新一年，</p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://cdn.zyha.cn/blog/20240528115016.png?x-oss-process=style/blog" alt="20240528115016"></p><p>如果往年已经填写，大致情况没有变，可以直接选择上方的【导入上一年年度信息】<br><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://cdn.zyha.cn/blog/20240528115424.png?x-oss-process=style/blog" alt="20240528115424"></p><p>根据实际情况填写不公示信息<br><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://cdn.zyha.cn/blog/20240528115123.png?x-oss-process=style/blog" alt="20240528115123"></p><p>资产信息，根据我家的情况，填写如下：</p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://cdn.zyha.cn/blog/20240528115225.png?x-oss-process=style/blog" alt="20240528115225"><br>最后点击保存</p><p>完成填写后，点击左侧【预览并公示】，滑动到最下方，选择【提交并公示】</p><p>最后可以看到公示【已公示】即完成年报的提交。</p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://cdn.zyha.cn/blog/20240528115818.png?x-oss-process=style/blog" alt="20240528115818"></p><h3 id="个体户公示说明"><a href="#个体户公示说明" class="headerlink" title="个体户公示说明"></a>个体户公示说明</h3><p>6月30日前，可以修改当年报的年报。</p><p>6月30日以后，不能修改年报。6月30日前未完成年报，将面临1万元以下罚款。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;重要提醒：根据《个体工商户年度报告暂行办法》规定：个体工商户应当于每年1月1日至6月30日向负责工商行政管理部门报送上一年度年度报告+税务申报（无业务申请0申报即可）&lt;/p&gt;
&lt;p&gt;很多人开电商店铺的时候，办理个体户营业执照，但是因为没有相关经验，不知道自己的义务所在，导致企业状态经营异常，被市场监督管理部门处1万元以下的罚款。在外边请专业的记账报税，其实就是帮你O申报，点点鼠标的事情，一年最少500元+，甚至有的一年，因为这个信息差花1000+元。&lt;/p&gt;</summary>
    
    
    
    <category term="税务" scheme="https://zyha.cn/categories/%E7%A8%8E%E5%8A%A1/"/>
    
    
    <category term="税务" scheme="https://zyha.cn/tags/%E7%A8%8E%E5%8A%A1/"/>
    
    <category term="个体户" scheme="https://zyha.cn/tags/%E4%B8%AA%E4%BD%93%E6%88%B7/"/>
    
  </entry>
  
  <entry>
    <title>【简单测评】ali成都轻量云年付99元</title>
    <link href="https://zyha.cn/ali-chengdu-light-year-pay-99/"/>
    <id>https://zyha.cn/ali-chengdu-light-year-pay-99/</id>
    <published>2024-05-27T12:15:58.000Z</published>
    <updated>2024-05-27T12:15:58.000Z</updated>
    
    <content type="html"><![CDATA[<p>99元一年的阿里轻量云，还是没忍住下手了。</p><span id="more"></span><h2 id="bench-sh"><a href="#bench-sh" class="headerlink" title="bench.sh"></a>bench.sh</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget -qO- bench.sh | bash</span><br></pre></td></tr></table></figure><p>运行结果如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">-------------------- A Bench.sh Script By Teddysun -------------------</span><br><span class="line"> Version            : v2023-10-15</span><br><span class="line"> Usage              : wget -qO- bench.sh | bash</span><br><span class="line">----------------------------------------------------------------------</span><br><span class="line"> CPU Model          : Intel(R) Xeon(R) Platinum</span><br><span class="line"> CPU Cores          : 2 @ 2499.998 MHz</span><br><span class="line"> CPU Cache          : 33792 KB</span><br><span class="line"> AES-NI             : ✓ Enabled</span><br><span class="line"> VM-x/AMD-V         : ✗ Disabled</span><br><span class="line"> Total Disk         : 39.2 GB (6.4 GB Used)</span><br><span class="line"> Total Mem          : 1.7 GB (619.2 MB Used)</span><br><span class="line"> System <span class="built_in">uptime</span>      : 74 days, 8 hour 33 min</span><br><span class="line"> Load average       : 0.15, 0.04, 0.01</span><br><span class="line"> OS                 : Ubuntu 22.04.4 LTS</span><br><span class="line"> Arch               : x86_64 (64 Bit)</span><br><span class="line"> Kernel             : 5.15.0-94-generic</span><br><span class="line"> TCP CC             : cubic</span><br><span class="line"> Virtualization     : KVM</span><br><span class="line"> IPv4/IPv6          : ✓ Online / ✗ Offline</span><br><span class="line"> Organization       : AS37963 Hangzhou Alibaba Advertising Co.,Ltd.</span><br><span class="line"> Location           : Chengdu / CN</span><br><span class="line"> Region             : Sichuan</span><br><span class="line">----------------------------------------------------------------------</span><br><span class="line"> I/O Speed(1st run) : 109 MB/s</span><br><span class="line"> I/O Speed(2nd run) : 105 MB/s</span><br><span class="line"> I/O Speed(3rd run) : 110 MB/s</span><br><span class="line"> I/O Speed(average) : 108.0 MB/s</span><br><span class="line">----------------------------------------------------------------------</span><br><span class="line"> Node Name        Upload Speed      Download Speed      Latency     </span><br><span class="line"> Speedtest.net    3.32 Mbps         102.46 Mbps         2.30 ms     </span><br><span class="line"> Los Angeles, US  3.47 Mbps         111.97 Mbps         185.89 ms   </span><br><span class="line"> Dallas, US       3.56 Mbps         112.24 Mbps         202.24 ms   </span><br><span class="line"> Montreal, CA     3.68 Mbps         110.89 Mbps         248.25 ms   </span><br><span class="line"> Amsterdam, NL    3.57 Mbps         108.68 Mbps         250.85 ms   </span><br><span class="line"> Shanghai, CN     3.35 Mbps         100.61 Mbps         36.12 ms    </span><br><span class="line"> Chongqing, CN    3.31 Mbps         100.70 Mbps         9.04 ms     </span><br><span class="line"> Hongkong, CN     3.37 Mbps         4.85 Mbps           53.34 ms    </span><br><span class="line"> Mumbai, IN       3.61 Mbps         107.89 Mbps         224.83 ms   </span><br><span class="line"> Singapore, SG    3.41 Mbps         42.95 Mbps          112.87 ms   </span><br><span class="line"> Tokyo, JP        3.36 Mbps         3.77 Mbps           96.99 ms    </span><br><span class="line">----------------------------------------------------------------------</span><br><span class="line"> Finished <span class="keyword">in</span>        : 6 min 17 sec</span><br><span class="line"> Timestamp          : 2024-05-27 20:24:50 CST</span><br><span class="line">----------------------------------------------------------------------</span><br></pre></td></tr></table></figure><h2 id="ping测试"><a href="#ping测试" class="headerlink" title="ping测试"></a>ping测试</h2><h3 id="全球ping"><a href="#全球ping" class="headerlink" title="全球ping"></a>全球ping</h3><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://img.tucang.cc/api/image/show/d17cc72b40ecb7365501c081ee994608" alt="ping.pe"></p><h3 id="国内ping"><a href="#国内ping" class="headerlink" title="国内ping"></a>国内ping</h3><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://img.tucang.cc/api/image/show/989cf81bc801f551806898ae9b9ebdb0" alt="itdog.cn"></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;99元一年的阿里轻量云，还是没忍住下手了。&lt;/p&gt;</summary>
    
    
    
    <category term="vps" scheme="https://zyha.cn/categories/vps/"/>
    
    
    <category term="vps" scheme="https://zyha.cn/tags/vps/"/>
    
    <category term="ali" scheme="https://zyha.cn/tags/ali/"/>
    
    <category term="cn" scheme="https://zyha.cn/tags/cn/"/>
    
  </entry>
  
  <entry>
    <title>开发中遇到的那些nestjs相关问题</title>
    <link href="https://zyha.cn/some-problems-in-nestjs/"/>
    <id>https://zyha.cn/some-problems-in-nestjs/</id>
    <published>2024-04-20T16:48:23.000Z</published>
    <updated>2024-04-20T16:48:23.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>最近在开发nestjs项目，遇到了一些问题，记录一下。</p><span id="more"></span><h2 id="Nest-静态文件服务"><a href="#Nest-静态文件服务" class="headerlink" title="Nest 静态文件服务"></a>Nest 静态文件服务</h2><p>虽然并没有使用nestjs的静态文件服务作为默认的静态资源地址，但还是可以当作备用方案。很久前就遇到了这个问题，只是看官方的issue和网上的一些blog也没有解决就先放到了一边开发其他功能去了，今天想起来了，解决一下。</p><p>根据官方文档，Nest 静态文件服务需要在项目根目录下创建一个 <code>public</code> 文件夹，然后将静态文件放到这个文件夹下。</p><p>文件路径为：</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── package.json</span><br><span class="line">├── public</span><br><span class="line">│   └── foo.png</span><br><span class="line">├── src</span><br><span class="line">│   ├── app.controller.spec.ts</span><br><span class="line">│   ├── app.controller.ts</span><br><span class="line">│   ├── app.module.ts</span><br><span class="line">│   ├── app.service.ts</span><br><span class="line">│   ├── main.ts</span><br><span class="line">├── tsconfig.build.json</span><br><span class="line">├── tsconfig.json</span><br><span class="line">└── yarn.lock</span><br></pre></td></tr></table></figure><p>根据官网示例配置一下import，</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Module</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/common&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">AppController</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./app.controller&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">AppService</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./app.service&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ServeStaticModule</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/serve-static&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; join &#125; <span class="keyword">from</span> <span class="string">&#x27;path&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Module</span>(&#123;</span><br><span class="line">  <span class="attr">imports</span>: [</span><br><span class="line">    <span class="title class_">ServeStaticModule</span>.<span class="title function_">forRoot</span>(&#123;</span><br><span class="line">      <span class="attr">rootPath</span>: <span class="title function_">join</span>(__dirname, <span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;public&#x27;</span>),</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">controllers</span>: [<span class="title class_">AppController</span>],</span><br><span class="line">  <span class="attr">providers</span>: [<span class="title class_">AppService</span>],</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">AppModule</span> &#123;&#125;</span><br></pre></td></tr></table></figure><p>但当打开url <code>http://localhost:3000/public/foo.png</code> 时，浏览器和日志都提示 <code>ENOENT: no such file or directory, stat xxxx/index.html</code>。</p><p>解决方案：</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">imports</span>: [ </span><br><span class="line">  <span class="title class_">ServeStaticModule</span>.<span class="title function_">forRoot</span>(&#123;</span><br><span class="line">    <span class="attr">rootPath</span>: <span class="title function_">join</span>(__dirname, <span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;../public&#x27;</span>),</span><br><span class="line">    <span class="attr">serveRoot</span>: <span class="string">&#x27;/public/&#x27;</span></span><br><span class="line">  &#125;),</span><br><span class="line">],</span><br></pre></td></tr></table></figure><p>这样就可以通过 <code>http://localhost:3000/public/foo.png</code> 访问静态文件了。</p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;最近在开发nestjs项目，遇到了一些问题，记录一下。&lt;/p&gt;</summary>
    
    
    
    <category term="后端" scheme="https://zyha.cn/categories/%E5%90%8E%E7%AB%AF/"/>
    
    
    <category term="node" scheme="https://zyha.cn/tags/node/"/>
    
    <category term="后端" scheme="https://zyha.cn/tags/%E5%90%8E%E7%AB%AF/"/>
    
    <category term="nestjs" scheme="https://zyha.cn/tags/nestjs/"/>
    
    <category term="ts" scheme="https://zyha.cn/tags/ts/"/>
    
  </entry>
  
  <entry>
    <title>浏览器从A到Z</title>
    <link href="https://zyha.cn/a-z-of-browser/"/>
    <id>https://zyha.cn/a-z-of-browser/</id>
    <published>2024-04-17T11:18:23.000Z</published>
    <updated>2024-04-17T11:18:23.000Z</updated>
    
    <content type="html"><![CDATA[<p>看到<a href="blog.skk.moe/post/2023-browser-from-a-to-z/">Sukka</a>大佬的博客，觉得很有意思。于是就想着自己也写一篇。</p><span id="more"></span><h2 id="A"><a href="#A" class="headerlink" title="A"></a>A</h2><ul><li>apad.pro</li></ul><p>开源项目EasyMosdns官方的DNS分流API</p><p>提供DoH协议，仅限研究用途，不承诺SLA</p><p>虽然已经从2019年稳定运行到现在，但是目前每日请求数已经过亿，体验已经远不如前。</p><ul><li>aliyun.com</li></ul><p>阿里云，国内的头部云厂商。</p><h2 id="B"><a href="#B" class="headerlink" title="B"></a>B</h2><ul><li>bilibili.com</li></ul><p>叔叔我啊。。。。</p><ul><li><a href="http://www.bitiful.com/">www.bitiful.com</a></li></ul><p>缤纷云是之前在用的dogedoge搜索的创始人的新项目，目前只有对象村粗和CDN，号称S4，面向国内，功能不及阿里腾讯等，但是价格更便宜，而且有免费的套餐。</p><h2 id="C"><a href="#C" class="headerlink" title="C"></a>C</h2><ul><li>chat.openai.com</li></ul><p>OpenAI提供的聊天机器人平台，可以用它来聊天，也可以用它来写作。</p><ul><li><a href="http://www.caniuse.com/">www.caniuse.com</a></li></ul><p>caniuse.com是一个查询浏览器兼容性的网站，可以查询到各个浏览器的最新版本是否支持某个功能。</p><ul><li>cloud.tencent.com</li></ul><p>腾讯云提供的云计算服务，包括云服务器、云数据库、云函数等。</p><h2 id="D"><a href="#D" class="headerlink" title="D"></a>D</h2><ul><li>dash.cloudflare.com</li></ul><p>大慈善家，无需多言。</p><ul><li><a href="http://www.deepl.com/">www.deepl.com</a></li></ul><p>DeepL翻译，免费的网页翻译。虽然有了easydict之后已经很久没有用过了。</p><h2 id="E"><a href="#E" class="headerlink" title="E"></a>E</h2><ul><li>element-plus.org</li></ul><p>ElementPlus，一款基于Vue3的UI组件库，提供了丰富的组件，适合开发PC端和移动端应用。可能是目前Vue生态中最强大的UI组件库。</p><h2 id="F"><a href="#F" class="headerlink" title="F"></a>F</h2><ul><li>fly.io</li></ul><p>Fly.io，一家基于容器技术的云服务提供商，提供免费的静态网站托管服务。但是目前免费服务有限且需要绑卡验证，想要深度体验任然需要付费购买。</p><h2 id="G"><a href="#G" class="headerlink" title="G"></a>G</h2><ul><li>github.com</li></ul><p>世界最大的代码存储库，无需多言。</p><h2 id="H"><a href="#H" class="headerlink" title="H"></a>H</h2><ul><li>hostloc.com</li></ul><p>主机论坛，还算是vps领域最活跃的几个论坛之一了。</p><h2 id="I"><a href="#I" class="headerlink" title="I"></a>I</h2><ul><li><a href="http://www.itdog.cn/">www.itdog.cn</a></li></ul><p>好用的测速工具，可以测出网站在全国范围的响应速度。</p><ul><li>ip.sb&#x2F;</li></ul><p>IP查询，可以查询到当前IP的地理位置。</p><h2 id="J"><a href="#J" class="headerlink" title="J"></a>J</h2><ul><li>juejin.cn</li></ul><p>掘金，前端为主的技术社区，提供优质的技术文章。但是近期我了解到其项目负责人及部分成员已经被优化，前路漫漫。。。</p><h2 id="K"><a href="#K" class="headerlink" title="K"></a>K</h2><ul><li>koajs.com</li></ul><p>Koa，一个基于Node.js的Web框架，提供了一系列功能，包括路由、中间件、插件等。</p><p>曾经基于koa2完成了毕业设计，但是近年来koa的更新其实已经放慢，且更强的框架nest的出现让koa的热度大幅下降。</p><h2 id="L"><a href="#L" class="headerlink" title="L"></a>L</h2><ul><li>localhost</li></ul><p>本地测试，可以用来测试网站的本地运行效果。</p><ul><li>lightsail.aws.amazon.com</li></ul><p>AWS的Lightsail，一款提供免费的云服务器的服务，可以用来快速部署网站。</p><h2 id="M"><a href="#M" class="headerlink" title="M"></a>M</h2><ul><li>my.racknerd.com</li></ul><p>Racknerd，一家提供服务器托管、VPS等服务的公司，提供各种套餐，性价比极高。</p><h2 id="N"><a href="#N" class="headerlink" title="N"></a>N</h2><ul><li><a href="http://www.npmjs.com/">www.npmjs.com</a></li></ul><p>npm，世界上最大的node存储库，提供了大量的开源库，可以用来快速开发项目。</p><h2 id="O"><a href="#O" class="headerlink" title="O"></a>O</h2><ul><li><p><a href="http://www.office.com/">www.office.com</a></p></li><li><p>outlook.live.com</p></li></ul><p>微软提供的办公服务，国内虽然可用，但听说outlook有丢件风险。</p><h2 id="P"><a href="#P" class="headerlink" title="P"></a>P</h2><ul><li><a href="http://www.prisma.io/">www.prisma.io</a></li></ul><p>Prisma，一款基于TypeScript的ORM框架，可以用来快速开发数据库应用。</p><h2 id="Q"><a href="#Q" class="headerlink" title="Q"></a>Q</h2><ul><li>docs.qq.com</li></ul><p>腾讯QQ文档，提供各种技术文档，包括教程、API文档、FAQ等。</p><h2 id="R"><a href="#R" class="headerlink" title="R"></a>R</h2><ul><li>react.dev</li></ul><p>最近想学React，看看官方教程。</p><h2 id="S"><a href="#S" class="headerlink" title="S"></a>S</h2><ul><li><a href="http://www.socpk.com/">www.socpk.com</a></li></ul><p>b站知名up主【极客湾】制作的手机芯片评测网站，可以用来评测手机芯片性能。</p><ul><li><a href="http://www.speedtest.net/">www.speedtest.net</a></li></ul><p>Speedtest，一款测速网站，可以用来测试下载&#x2F;上传&#x2F;延迟等。</p><h2 id="T"><a href="#T" class="headerlink" title="T"></a>T</h2><ul><li>tailwindui.com</li></ul><p>TailwindUI，一款基于TailwindCSS的UI组件库，提供了丰富的组件，适合开发PC端和移动端应用。</p><p>github上有很多TailwindUI的模板，可以参考。</p><p>PS：别人写的样式是真好看。。。</p><h2 id="U"><a href="#U" class="headerlink" title="U"></a>U</h2><ul><li>u.sb</li></ul><p>域名大佬烧饼的博客。</p><h2 id="V"><a href="#V" class="headerlink" title="V"></a>V</h2><ul><li>vercel.com</li></ul><p>Vercel，一家提供静态网站托管、服务器托管、CDN等服务的公司，提供免费的静态网站托管服务。</p><p>对处于vue生态的我真的是很羡慕。</p><ul><li>v2ex.com</li></ul><p>也是一个很知名的程序员社区。</p><h2 id="W"><a href="#W" class="headerlink" title="W"></a>W</h2><ul><li>wordpress.com</li></ul><p>由于谷歌域名业务被出售的原因，我将我的部分域名迁移到来wp，有一说一，界面UI不好看。</p><ul><li>wiki.biligame.com</li></ul><p>B站游戏社区，有很多游戏攻略，可以用来学习游戏攻略。</p><p>而我，原神，启动！</p><h2 id="X"><a href="#X" class="headerlink" title="X"></a>X</h2><ul><li>x.com</li></ul><p>境外微博：）</p><h2 id="Y"><a href="#Y" class="headerlink" title="Y"></a>Y</h2><ul><li><a href="http://www.youtube.com/">www.youtube.com</a></li></ul><p>。。。</p><h2 id="Z"><a href="#Z" class="headerlink" title="Z"></a>Z</h2><ul><li>zhihu.com</li></ul><p>知乎，分享你刚编好的故事。</p><p>已经很久没有登录账号了。一直都是匿名访问。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;看到&lt;a href=&quot;blog.skk.moe/post/2023-browser-from-a-to-z/&quot;&gt;Sukka&lt;/a&gt;大佬的博客，觉得很有意思。于是就想着自己也写一篇。&lt;/p&gt;</summary>
    
    
    
    <category term="浏览器" scheme="https://zyha.cn/categories/%E6%B5%8F%E8%A7%88%E5%99%A8/"/>
    
    
    <category term="前端" scheme="https://zyha.cn/tags/%E5%89%8D%E7%AB%AF/"/>
    
    <category term="浏览器" scheme="https://zyha.cn/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>使用什么作为数据库的ID？</title>
    <link href="https://zyha.cn/what-is-the-best-id-for-a-database/"/>
    <id>https://zyha.cn/what-is-the-best-id-for-a-database/</id>
    <published>2024-04-07T01:19:23.000Z</published>
    <updated>2024-05-07T01:19:23.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>ID 是计算机系统中的重要概念，它用于标识不同的数据实体和交互过程。ID 生成方案是指用于生成唯一标识符（ID）的算法或方法。这些标识符通常用于唯一标识数据库中的记录、消息队列中的消息、分布式系统中的节点等。</p><p>本文建立在本人对过往项目的总结，主要是<code>nestjs+prisma</code>技术栈的代码实现，希望能对大家有所帮助。</p><span id="more"></span><h2 id="理论上ID需要具备的特性"><a href="#理论上ID需要具备的特性" class="headerlink" title="理论上ID需要具备的特性"></a>理论上ID需要具备的特性</h2><p>数据库中的唯一ID（或称为主键）通常需要具备以下特性：</p><ul><li>唯一性（Uniqueness）：每个ID值必须是唯一的，不允许重复。这是主键的最基本特性，确保每行数据都可以通过唯一的标识进行识别和访问。</li><li>不变性（Immutability）：一旦分配给某行数据，ID就不能被更改或重用。这保证了数据的稳定性和一致性，避免了混淆或错误。</li><li>简短性（Shortness）：ID应该足够短以节省存储空间和提高检索效率，同时要足够长以确保唯一性。通常采用自增数字或UUID（通用唯一标识符）等方式生成。</li><li>简单性（Simplicity）：ID应该易于生成、理解和处理，不应过于复杂。这有助于简化开发和维护过程，并提高系统的可靠性。</li><li>可排序性（Sortable）：ID的生成方式应当考虑到其在排序操作中的性能和效率，以便支持一些需要基于ID进行排序的查询操作。</li><li>可读性（Readability）：尽管主键通常是内部使用的标识符，但在某些情况下，例如调试或日志记录，可读性也是一个有用的特性。因此，ID应该以一种可读的格式表示，使其易于识别和理解。</li><li>不含业务含义（No business meaning）：主键应当是无意义的值，不应当包含业务相关的信息。这有助于避免在业务规则变化时引起的问题，并提高系统的灵活性和可扩展性。</li><li>可扩展性（Scalability）：ID生成方式应当能够满足系统的扩展需求，即使在高并发或大规模数据量的情况下也能保持高效和稳定。</li><li>全局唯一性（Global uniqueness）：如果系统是分布式的，那么主键需要保证在全局范围内的唯一性，而不仅仅是在单个数据库或表中。</li></ul><p>综合考虑这些特性，可以选择合适的主键生成方式和存储策略，以满足数据库设计的需求和业务规则的要求。</p><h2 id="常见的ID生成方式"><a href="#常见的ID生成方式" class="headerlink" title="常见的ID生成方式"></a>常见的ID生成方式</h2><h3 id="1-自增ID"><a href="#1-自增ID" class="headerlink" title="1. 自增ID"></a>1. 自增ID</h3><p>最简单的ID生成方式就是自增ID。这种方式的实现方式是，在数据库中创建一个计数器，每次插入新记录时，都将计数器的值加1，作为新记录的ID值。</p><p>优点是简单、易于实现，依赖于所使用数据库的本身机制。分表操作时，下一张表需要知道上一张表最后的id；当存储敏感信息时，可能被他人利用这一特性。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id                Int           @id @default(autoincrement())</span><br></pre></td></tr></table></figure><h3 id="2-UUID"><a href="#2-UUID" class="headerlink" title="2. UUID"></a>2. UUID</h3><p>UUID（通用唯一标识符）是一种由算法生成的字符串，它保证全局唯一性、全球唯一性、时间戳连续性、随机性。</p><p>优点是简单、易于生成、可读性好、无序性。但UUID的长度较长，占用空间也比较大。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id                String        @id @default(uuid())</span><br></pre></td></tr></table></figure><p>常用的uuid版本为v4，但随着大佬们的改进，v7逐渐展现优势。</p><p>与随机前缀的 UUIDv4 相比，UUIDv7 的时间有序性使数据库性能大大提高。第 2 象限博客的这篇文章对随机 UUID 和顺序 UUID 进行了基准测试，结果不仅显示了写入性能的提高，还显示了读取性能的提高。</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">// 10个uuid v4</span><br><span class="line">275b31eb-0945-4f40-92f3-8354a00acb12</span><br><span class="line">668a54bc-6f9d-4cbe-be6e-58fbaf836841</span><br><span class="line">b0a474eb-d27a-4fb0-af4d-44779d4fc7ee</span><br><span class="line">62a0f416-59b9-4ce6-ba9c-70715a260fb1</span><br><span class="line">200b2f08-67ae-4bdb-89f4-4d7af74321bf</span><br><span class="line">df6fe932-c9c1-4612-bcce-1963e53dd589</span><br><span class="line">fbc48dc4-0b15-4482-bf40-da084a4ab918</span><br><span class="line">48c361d2-bbf5-4643-a415-1c7a145c72be</span><br><span class="line">d13ab0fb-4037-4b3d-ac85-fc30fd31ad33</span><br><span class="line">36349ca7-7672-48e3-b482-82751afe4db5</span><br><span class="line"></span><br><span class="line">// 10个uuid v7</span><br><span class="line">019034cd-2fb4-7080-a9b4-2ca24d3c5e84</span><br><span class="line">019034cd-2fb4-7080-a9b4-2ca3c4c681a6</span><br><span class="line">019034cd-2fb4-7080-a9b4-2ca4a19af464</span><br><span class="line">019034cd-2fb4-7080-a9b4-2ca55e5db91a</span><br><span class="line">019034cd-2fb4-7080-a9b4-2ca622adb595</span><br><span class="line">019034cd-2fb4-7080-a9b4-2ca7aae879ae</span><br><span class="line">019034cd-2fb4-7080-a9b4-2ca89bfe79ad</span><br><span class="line">019034cd-2fb4-7080-a9b4-2ca9c6c29183</span><br><span class="line">019034cd-2fb4-7080-a9b4-2caa7953bee1</span><br><span class="line">019034cd-2fb4-7080-a9b4-2cab494ef6a9</span><br></pre></td></tr></table></figure><p>UUIDv7 继续与标准 UUID 格式保持一致，因此从实际使用的角度来看，它们可以被视为任何其他 UUID。这种兼容性使我们可以使用现有的 Postgres UUID 列，并轻松地将列从存储 UUIDv4 值过渡到 UUIDv7。</p><h3 id="3-雪花-Snowflake-算法"><a href="#3-雪花-Snowflake-算法" class="headerlink" title="3. 雪花(Snowflake)算法"></a>3. 雪花(Snowflake)算法</h3><p>Snowflake 是由 Twitter 开发的一种分布式 ID 生成算法，可以保证 ID 的唯一性和足够的可排序性。Snowflake 的 ID 格式为 64 位整数，其中第 1 位为符号位，接下来的 41 位为时间戳，10 位为节点 ID，12 位为序列号。</p><p>Snowflake算法的特性如下：</p><ul><li>唯一性（Uniqueness）：Snowflake算法生成的ID在整个分布式系统中保持唯一性。这是通过将不同的组件（时间戳、机器标识符、序列号）结合在一起生成ID来实现的。</li><li>趋势递增（Increasing trend）：Snowflake生成的ID通常是趋势递增的，即后生成的ID比先生成的ID大。这种特性有助于提高数据库索引效率，减少磁盘碎片等问题。</li><li>可排序性（Sortable）：Snowflake生成的ID可以根据时间戳部分进行排序，因为时间戳部分占据了ID的高位。这使得Snowflake生成的ID在存储和检索时更加高效。</li><li>精度（Precision）：Snowflake算法使用了41位的时间戳，10位的机器标识符和12位的序列号，总共64位。这提供了高达69年的时间精度（2^41 毫秒，约为69年），可以在大多数应用场景下满足需求。</li><li>分布式生成（Distributed generation）：Snowflake算法的设计目标之一是支持分布式生成，即不同的机器可以独立生成ID，而不会发生冲突。这通过在ID中包含机器标识符来实现。</li><li>简单性（Simplicity）：Snowflake算法相对简单，易于实现和部署。它基于时间戳、机器标识符和序列号的组合，使用位运算进行ID的生成，逻辑清晰。</li><li>灵活性（Flexibility）：Snowflake算法允许根据需求调整时间戳的位数、机器标识符的位数和序列号的位数，以适应不同规模和需求的系统。</li><li>可逆性（Reversibility）：Snowflake生成的ID本身不具有可逆性。但是，可以根据ID的结构将其分解为时间戳、机器标识符和序列号等部分，从而了解ID的生成信息。</li></ul><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; env &#125; <span class="keyword">from</span> <span class="string">&#x27;process&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">SnowFlake</span> &#123;</span><br><span class="line">  <span class="comment">// 系统上线的时间戳，此处为 2023-06-22 00:00:00 的时间戳</span></span><br><span class="line">  epoch = <span class="title class_">BigInt</span>(<span class="number">1687392000000</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 数据中心的位数</span></span><br><span class="line">  dataCenterIdBits = <span class="number">5</span>;</span><br><span class="line">  <span class="comment">// 机器id的位数</span></span><br><span class="line">  workerIdBits = <span class="number">5</span>;</span><br><span class="line">  <span class="comment">// 自增序列号的位数</span></span><br><span class="line">  sequenceBits = <span class="number">12</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 最大的数据中心id 这段位运算可以理解为2^5-1 = 31</span></span><br><span class="line">  maxDataCenterId = (<span class="title class_">BigInt</span>(<span class="number">1</span>) &lt;&lt; <span class="title class_">BigInt</span>(<span class="variable language_">this</span>.<span class="property">workerIdBits</span>)) - <span class="title class_">BigInt</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="comment">// 最大的机器id 这段位运算可以理解为2^5-1 = 31</span></span><br><span class="line">  maxWorkerId = (<span class="title class_">BigInt</span>(<span class="number">1</span>) &lt;&lt; <span class="title class_">BigInt</span>(<span class="variable language_">this</span>.<span class="property">workerIdBits</span>)) - <span class="title class_">BigInt</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 时间戳偏移位数</span></span><br><span class="line">  timestampShift = <span class="title class_">BigInt</span>(</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">dataCenterIdBits</span> + <span class="variable language_">this</span>.<span class="property">workerIdBits</span> + <span class="variable language_">this</span>.<span class="property">sequenceBits</span>,</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 数据中心偏移位数</span></span><br><span class="line">  dataCenterIdShift = <span class="title class_">BigInt</span>(<span class="variable language_">this</span>.<span class="property">workerIdBits</span> + <span class="variable language_">this</span>.<span class="property">sequenceBits</span>);</span><br><span class="line">  <span class="comment">// 机器id偏移位数</span></span><br><span class="line">  workerIdShift = <span class="title class_">BigInt</span>(<span class="variable language_">this</span>.<span class="property">sequenceBits</span>);</span><br><span class="line">  <span class="comment">// 自增序列号的掩码</span></span><br><span class="line">  sequenceMask = (<span class="title class_">BigInt</span>(<span class="number">1</span>) &lt;&lt; <span class="title class_">BigInt</span>(<span class="variable language_">this</span>.<span class="property">sequenceBits</span>)) - <span class="title class_">BigInt</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="comment">// 记录上次生成id的时间戳</span></span><br><span class="line">  lastTimestamp = <span class="title class_">BigInt</span>(-<span class="number">1</span>);</span><br><span class="line">  <span class="comment">// 数据中心id</span></span><br><span class="line">  dataCenterId = <span class="title class_">BigInt</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="comment">// 机器id</span></span><br><span class="line">  workerId = <span class="title class_">BigInt</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="comment">// 自增序列号</span></span><br><span class="line">  sequence = <span class="title class_">BigInt</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">dataCenterId: <span class="built_in">number</span>, workerId: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">    <span class="comment">// 校验数据中心 ID 和工作节点 ID 的范围</span></span><br><span class="line">    <span class="keyword">if</span> (dataCenterId &gt; <span class="variable language_">this</span>.<span class="property">maxDataCenterId</span> || dataCenterId &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(</span><br><span class="line">        <span class="string">`Data center ID must be between 0 and <span class="subst">$&#123;<span class="variable language_">this</span>.maxDataCenterId&#125;</span>`</span>,</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (workerId &gt; <span class="variable language_">this</span>.<span class="property">maxWorkerId</span> || workerId &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">`Worker ID must be between 0 and <span class="subst">$&#123;<span class="variable language_">this</span>.maxWorkerId&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">dataCenterId</span> = <span class="title class_">BigInt</span>(dataCenterId);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">workerId</span> = <span class="title class_">BigInt</span>(workerId);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">nextId</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> timestamp = <span class="title class_">BigInt</span>(<span class="title class_">Date</span>.<span class="title function_">now</span>());</span><br><span class="line">    <span class="comment">// 如果上一次生成id的时间戳比下一次生成的还大，说明服务器时间有问题，出现了回退，这时候再生成id，可能会生成重复的id，所以直接抛出异常。</span></span><br><span class="line">    <span class="keyword">if</span> (timestamp &lt; <span class="variable language_">this</span>.<span class="property">lastTimestamp</span>) &#123;</span><br><span class="line">      <span class="comment">// 时钟回拨，抛出异常并拒绝生成 ID</span></span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Clock moved backwards. Refusing to generate ID.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果当前时间戳和上一次的时间戳相等，序列号加一</span></span><br><span class="line">    <span class="keyword">if</span> (timestamp === <span class="variable language_">this</span>.<span class="property">lastTimestamp</span>) &#123;</span><br><span class="line">      <span class="comment">// 同一毫秒内生成多个 ID，递增序列号，防止冲突</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">sequence</span> = (<span class="variable language_">this</span>.<span class="property">sequence</span> + <span class="title class_">BigInt</span>(<span class="number">1</span>)) &amp; <span class="variable language_">this</span>.<span class="property">sequenceMask</span>;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">sequence</span> === <span class="title class_">BigInt</span>(<span class="number">0</span>)) &#123;</span><br><span class="line">        <span class="comment">// 序列号溢出，等待下一毫秒</span></span><br><span class="line">        timestamp = <span class="variable language_">this</span>.<span class="title function_">waitNextMillis</span>(<span class="variable language_">this</span>.<span class="property">lastTimestamp</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 不同毫秒，重置序列号</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">sequence</span> = <span class="title class_">BigInt</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">lastTimestamp</span> = timestamp;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 组合各部分生成最终的 ID，可以理解为把64位二进制转换位十进制数字</span></span><br><span class="line">    <span class="keyword">const</span> id =</span><br><span class="line">      ((timestamp - <span class="variable language_">this</span>.<span class="property">epoch</span>) &lt;&lt; <span class="variable language_">this</span>.<span class="property">timestampShift</span>) |</span><br><span class="line">      (<span class="variable language_">this</span>.<span class="property">dataCenterId</span> &lt;&lt; <span class="variable language_">this</span>.<span class="property">dataCenterIdShift</span>) |</span><br><span class="line">      (<span class="variable language_">this</span>.<span class="property">workerId</span> &lt;&lt; <span class="variable language_">this</span>.<span class="property">workerIdShift</span>) |</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">sequence</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> id.<span class="title function_">toString</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">waitNextMillis</span>(<span class="params">lastTimestamp</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> timestamp = <span class="title class_">BigInt</span>(<span class="title class_">Date</span>.<span class="title function_">now</span>());</span><br><span class="line">    <span class="keyword">while</span> (timestamp &lt;= lastTimestamp) &#123;</span><br><span class="line">      <span class="comment">// 主动等待，直到当前时间超过上次记录的时间戳</span></span><br><span class="line">      timestamp = <span class="title class_">BigInt</span>(<span class="title class_">Date</span>.<span class="title function_">now</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> timestamp;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果有pm_id，把pm_id当机器id传进去</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> snowFlake = <span class="keyword">new</span> <span class="title class_">SnowFlake</span>(<span class="number">0</span>, +env.<span class="property">pm_id</span> || <span class="number">0</span>);</span><br></pre></td></tr></table></figure><p>综合来看，Snowflake算法是一种在分布式系统中生成唯一ID的高效且可靠的算法，具有较好的唯一性、可排序性和趋势递增性，适用于各种规模的分布式系统。</p><h2 id="4-nanoid"><a href="#4-nanoid" class="headerlink" title="4. nanoid"></a>4. nanoid</h2><p>Nano ID 是一种轻量级、高性能的 ID 生成器，采用了类似 Twitter 的 Snowflake 算法。Nano ID 的长度为 21 个字符，其中 15 个字符用于表示时间戳，6 个字符用于生成随机数，可以保证 ID 的唯一性和足够的随机性。</p><p>适用于高并发环境下的 ID 生成，例如 URL 缩短服务等。但是，Nano ID 不适用于需要支持排序或时间相关操作的场景。</p><p>给<code>prisma</code>提了issue，希望像uuid和自增id那样集成，但根据官方近几个月的release记录来看，目前开发重心是在和<code>drizzle-orm</code>抢市场，至今并未考虑支持。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; nanoid &#125; <span class="keyword">from</span> <span class="string">&#x27;nanoid&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getNanoid</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">nanoid</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="5-Redis生成id"><a href="#5-Redis生成id" class="headerlink" title="5. Redis生成id"></a>5. Redis生成id</h2><p>Redis是一个高性能的内存数据库，可以用来存储键值对数据，其中值可以是字符串、列表、集合、散列等。Redis的incr命令可以用来生成自增ID，但由于Redis的单线程特性，性能上可能不如其他方案。</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>本文只列举了常见的ID生成方式，实际上还有很多种方式，此处不再列举。在实际的项目中，需要根据实际情况选择合适的ID生成方式，并根据业务规则和性能需求进行优化。</p><p>就个人项目经历，目前uuid已经可以满足大部分需求，其本身由于开源早，所以生态更加丰富，比如<code>class-validator</code>的<code>IsUUID</code>和<code>nestjs</code>的<code>ParseUUIDPipe</code>。当然，如果哪天prisma集成nanoid或snowflake，那我可能就会在新项目中考虑替换了。</p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;ID 是计算机系统中的重要概念，它用于标识不同的数据实体和交互过程。ID 生成方案是指用于生成唯一标识符（ID）的算法或方法。这些标识符通常用于唯一标识数据库中的记录、消息队列中的消息、分布式系统中的节点等。&lt;/p&gt;
&lt;p&gt;本文建立在本人对过往项目的总结，主要是&lt;code&gt;nestjs+prisma&lt;/code&gt;技术栈的代码实现，希望能对大家有所帮助。&lt;/p&gt;</summary>
    
    
    
    <category term="数据库" scheme="https://zyha.cn/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="数据库" scheme="https://zyha.cn/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    <category term="sql" scheme="https://zyha.cn/tags/sql/"/>
    
    <category term="database" scheme="https://zyha.cn/tags/database/"/>
    
  </entry>
  
  <entry>
    <title>docker相关容器配置</title>
    <link href="https://zyha.cn/docker-container-configurations/"/>
    <id>https://zyha.cn/docker-container-configurations/</id>
    <published>2024-03-28T07:24:31.000Z</published>
    <updated>2024-03-28T07:24:31.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>一不小心选错了选项，docker直接给我重置了，重新安装一些常用镜像，下面记录一下正在使用的容器和相关配置内容。</p><span id="more"></span><h3 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">--name nginx \</span><br><span class="line">-p 80:80 \</span><br><span class="line">-p 443:443 \</span><br><span class="line">-v $PWD/nginx/html:/usr/share/nginx/html \</span><br><span class="line">-v $PWD/nginx/nginx.conf:/etc/nginx/nginx.conf \</span><br><span class="line">-v $PWD/nginx/log:/var/log/nginx \</span><br><span class="line">-v $PWD/nginx/cert:/etc/nginx/cert \</span><br><span class="line">-v $PWD/nginx/conf.d/default.conf:/etc/nginx/conf.d/default.conf \</span><br><span class="line">--restart=always \</span><br><span class="line">nginx</span><br></pre></td></tr></table></figure><h3 id="postgres"><a href="#postgres" class="headerlink" title="postgres"></a>postgres</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">    -e POSTGRES_PASSWORD=mypassword \</span><br><span class="line">    -e POSTGRES_USER=myuser \</span><br><span class="line">    -p 5432:5432 \</span><br><span class="line">    --name mypostgres postgres </span><br></pre></td></tr></table></figure><ul><li>参数POSTGRES_PASSWORD是必需的， POSTGRES_USER它在参数中定义用户的密码。</li><li>参数POSTGRES_USER是可选的，如果未定义，postgres将使用默认用户，可以使用用户名和密码访问数据库。</li></ul><h3 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h3><p>创建目录：<br>mkdir -p $PWD&#x2F;redis&#x2F;conf</p><p>创建文件：<br>touch $PWD&#x2F;redis&#x2F;conf&#x2F;redis.conf</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">--name redis \</span><br><span class="line">-p 6379:6379 \</span><br><span class="line">--network individual \</span><br><span class="line">-v $PWD/redis/data:/data \</span><br><span class="line">-v $PWD/redis/conf:/etc/redis \</span><br><span class="line">--restart=always \</span><br><span class="line">redis \</span><br><span class="line">redis-server /etc/redis/redis.conf \</span><br><span class="line">--appendonly yes</span><br></pre></td></tr></table></figure><h3 id="minio"><a href="#minio" class="headerlink" title="minio"></a>minio</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker run  -p 9000:9000 --name minio \</span><br><span class="line"> -d --restart=always \</span><br><span class="line"> -e MINIO_ACCESS_KEY=minio \</span><br><span class="line"> -e MINIO_SECRET_KEY=minio@123 \</span><br><span class="line"> -v /usr/local/minio/data:/data \</span><br><span class="line"> -v /usr/local/minio/config:/root/.minio \</span><br><span class="line">  minio/minio server /data  --console-address &quot;:9000&quot; --address &quot;:9090&quot;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;一不小心选错了选项，docker直接给我重置了，重新安装一些常用镜像，下面记录一下正在使用的容器和相关配置内容。&lt;/p&gt;</summary>
    
    
    
    <category term="docker" scheme="https://zyha.cn/categories/docker/"/>
    
    
    <category term="vps" scheme="https://zyha.cn/tags/vps/"/>
    
    <category term="docker" scheme="https://zyha.cn/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>关于ApiPost的一些技巧</title>
    <link href="https://zyha.cn/some-tips-about-apipost/"/>
    <id>https://zyha.cn/some-tips-about-apipost/</id>
    <published>2024-03-27T09:53:19.000Z</published>
    <updated>2024-03-27T09:53:19.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="关于ApiPost"><a href="#关于ApiPost" class="headerlink" title="关于ApiPost"></a>关于ApiPost</h2><p>ApiPost是一个国产的类Postman的API调试工具。由于Postman的一些限制，我开始尝试使用ApiPost，在这里记录一些我在使用ApiPost过程中发现的一些技巧。</p><ul><li>2024.6.20更新，8.0版本发布，主要优化启动时间，离谱的是v7和v8数据不互通。。。<span id="more"></span></li></ul><h2 id="1-添加Header参数"><a href="#1-添加Header参数" class="headerlink" title="1. 添加Header参数"></a>1. 添加Header参数</h2><p>有两种常用方式，下面以<code>User-Agent</code>字段为例子，</p><h3 id="1-1-添加全局Header参数"><a href="#1-1-添加全局Header参数" class="headerlink" title="1.1 添加全局Header参数"></a>1.1 添加全局Header参数</h3><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://cdn.zyha.cn/blog/20240327175713.png?x-oss-process=style/blog" alt="20240327175713"></p><h3 id="1-2-动态添加请求头"><a href="#1-2-动态添加请求头" class="headerlink" title="1.2 动态添加请求头"></a>1.2 动态添加请求头</h3><p>在预执行脚本中添加，</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt.setRequestHeader(&quot;User-Agent&quot;, UA);</span><br></pre></td></tr></table></figure><h2 id="2-添加全局token认证"><a href="#2-添加全局token认证" class="headerlink" title="2. 添加全局token认证"></a>2. 添加全局token认证</h2><h3 id="2-1-添加全局参数"><a href="#2-1-添加全局参数" class="headerlink" title="2.1 添加全局参数"></a>2.1 添加全局参数</h3><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://cdn.zyha.cn/blog/20240327180531.png?x-oss-process=style/blog" alt="20240327180531"></p><h3 id="2-2-动态添加请求头"><a href="#2-2-动态添加请求头" class="headerlink" title="2.2 动态添加请求头"></a>2.2 动态添加请求头</h3><p>在预执行脚本中添加，</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt.setRequestHeader(&quot;Authorization&quot;, token);</span><br></pre></td></tr></table></figure><h2 id="3-同步Swagger文档并分享"><a href="#3-同步Swagger文档并分享" class="headerlink" title="3. 同步Swagger文档并分享"></a>3. 同步Swagger文档并分享</h2><p>ApiPost支持同步Swagger文档，可以通过<code>导入</code>功能导入Swagger文档，也可以通过<code>分享</code>功能分享Swagger文档。</p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://cdn.zyha.cn/blog/20240327175830.png?x-oss-process=style/blog" alt="20240327175830"></p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://cdn.zyha.cn/blog/20240327175914.png?x-oss-process=style/blog" alt="20240327175914"></p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;关于ApiPost&quot;&gt;&lt;a href=&quot;#关于ApiPost&quot; class=&quot;headerlink&quot; title=&quot;关于ApiPost&quot;&gt;&lt;/a&gt;关于ApiPost&lt;/h2&gt;&lt;p&gt;ApiPost是一个国产的类Postman的API调试工具。由于Postman的一些限制，我开始尝试使用ApiPost，在这里记录一些我在使用ApiPost过程中发现的一些技巧。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;2024.6.20更新，8.0版本发布，主要优化启动时间，离谱的是v7和v8数据不互通。。。</summary>
    
    
    
    <category term="测试" scheme="https://zyha.cn/categories/%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="api" scheme="https://zyha.cn/tags/api/"/>
    
    <category term="测试" scheme="https://zyha.cn/tags/%E6%B5%8B%E8%AF%95/"/>
    
  </entry>
  
  <entry>
    <title>2024选择适合的公共DNS</title>
    <link href="https://zyha.cn/select-a-good-public-dns-in-2024/"/>
    <id>https://zyha.cn/select-a-good-public-dns-in-2024/</id>
    <published>2024-03-20T04:46:36.000Z</published>
    <updated>2024-06-14T04:46:36.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><ul><li>2024.6.14 update： 更新小众DNS服务，增加了一些小厂商的DNS服务。</li></ul><p>由于之前用的公共DNS开始变得不稳定，所以重新找一下目前市面上常见的和可能好用的DNS Server。</p><p>选择适合的公共 DNS 对于在中国大陆使用互联网是非常重要的，因为它可以影响到你的网络连接速度、安全性和稳定性。</p><p>主要需要考虑以下因素：</p><ul><li>速度和稳定性：选择一个能够提供良好速度和稳定性的公共 DNS 服务，以确保你的网络连接畅通。</li><li>隐私和安全：一些公共 DNS 提供商可能会收集用户数据，因此你需要选择一个信誉良好、注重隐私保护的服务。</li><li>支持的功能：一些公共 DNS 可能支持额外的功能，如安全过滤、家长控制等，根据你的需求选择合适的服务。</li></ul><span id="more"></span><h2 id="先来了解一下DoT和DoH"><a href="#先来了解一下DoT和DoH" class="headerlink" title="先来了解一下DoT和DoH"></a>先来了解一下DoT和DoH</h2><p>DoT (DNS over TLS) 和 DoH (DNS over HTTPS) 都是用于加密 DNS 流量的协议，它们之间有几个区别：</p><ul><li>传输层协议：<ul><li>DoT：使用传输层安全性协议（TLS）来加密 DNS 查询和响应数据。通常在传输层的 853 端口上运行。</li><li>DoH：将 DNS 查询和响应封装在 HTTPS 请求中，因此可以通过常用的 HTTPS 端口（443）来传输。</li></ul></li><li>部署和支持：<ul><li>DoT：较早被广泛采用，但在某些环境下配置稍微复杂，需要特定的 DNS 服务器支持。</li><li>DoH：由于使用 HTTPS，可以通过现有的 Web 服务器基础架构轻松部署，也更容易穿透防火墙。</li></ul></li><li>性能和适用性：<ul><li>DoT：通常被认为在性能方面稍微优于 DoH，因为 TLS 协议的轻量级封装和较少的额外开销。</li><li>DoH：由于使用 HTTPS，可能会在性能上产生额外的开销，但它的优势在于更易于穿透某些网络配置，尤其是防火墙和代理服务器。</li></ul></li><li>隐私和安全：<ul><li>DoT 和 DoH 都提供了加密传输，从而提高了用户的隐私和安全性，防止了窃听和篡改 DNS 流量的可能性。</li></ul></li></ul><p>综上所述，虽然 DoT 和 DoH 都是用于加密 DNS 流量的有效协议，但它们在实现细节、部署和性能上略有不同，用户可以根据自己的需求和网络环境选择合适的协议。</p><p>于我而言，不缺少那点DNS的解析速度，所以我更倾向于选择更加隐蔽的DoH，因为它更容易穿透防火墙。</p><p>仅列出相对可靠的，其余服务的暂不加入。</p><h2 id="各个厂商对比"><a href="#各个厂商对比" class="headerlink" title="各个厂商对比"></a>各个厂商对比</h2><h3 id="境内"><a href="#境内" class="headerlink" title="境内"></a>境内</h3><table><thead><tr><th>提供方</th><th>国内测速平均响应时间</th><th>IPv4</th><th>IPv6</th><th>稳定性</th><th>DoT</th><th>DoH</th></tr></thead><tbody><tr><td>腾讯 DNSPod</td><td>23ms</td><td>119.29.29.29</td><td>2402:4e00::</td><td>🌟🌟🌟🌟🌟</td><td>dot.pub</td><td><a href="https://doh.pub/dns-query">https://doh.pub/dns-query</a></td></tr><tr><td>阿里巴巴(Alidns)</td><td>21ms</td><td>223.5.5.5, 223.6.6.6</td><td>2400:3200::1, 2400:3200:baba::1</td><td>🌟🌟🌟🌟🌟</td><td>dns.alidns.com</td><td><a href="https://dns.alidns.com/dns-query">https://dns.alidns.com/dns-query</a></td></tr><tr><td>南京信风公共 DNS</td><td>24ms</td><td>114.114.114.114,114.114.115.115</td><td>❌</td><td>🌟🌟🌟🌟</td><td>❌</td><td>❌</td></tr></tbody></table><h3 id="境外"><a href="#境外" class="headerlink" title="境外"></a>境外</h3><table><thead><tr><th>提供方</th><th>国内测速平均响应时间</th><th>IPv4</th><th>IPv6</th><th>稳定性</th><th>DoT</th><th>DoH</th></tr></thead><tbody><tr><td>Google</td><td>108ms</td><td>8.8.8.8,8.8.4.4</td><td>2001:4860:4860::8888 ,2001:4860:4860::8844</td><td>🌟🌟🌟🌟🌟</td><td>dns.google</td><td><a href="https://dns.google/dns-query">https://dns.google/dns-query</a></td></tr><tr><td>Cloudflare</td><td>190ms</td><td>1.0.0.1 ,1.1.1.1</td><td>2606:4700:4700::1111, 2606:4700:4700::1001</td><td>🌟🌟🌟🌟🌟</td><td>cloudflare-dns.com</td><td><a href="https://cloudflare-dns.com/dns-query">https://cloudflare-dns.com/dns-query</a></td></tr></tbody></table><h3 id="小厂商"><a href="#小厂商" class="headerlink" title="小厂商"></a>小厂商</h3><table><thead><tr><th>提供方</th><th>测速截图（DOH）</th><th>IPv4</th><th>IPv6</th><th>稳定性</th><th>DoT</th><th>DoH</th></tr></thead><tbody><tr><td>dns.sb</td><td><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://s2.loli.net/2024/06/14/2tNCL6mhKbJVvf3.png" alt="20240614135104"></td><td><code>185.222.222.222</code> <code>45.11.45.11</code></td><td><code>2a09::</code> <code>2a11::</code></td><td>🌟🌟🌟🌟</td><td>dot.sb</td><td><a href="https://doh.sb/dns-query">https://doh.sb/dns-query</a></td></tr><tr><td>EasyMosdns</td><td><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://s2.loli.net/2024/06/14/DNGzb7APk21oO5Y.png" alt="20240614135709"></td><td>❌</td><td>❌</td><td>🌟🌟🌟</td><td>❌</td><td><a href="https://doh.apad.pro/dns-query">https://doh.apad.pro/dns-query</a></td></tr><tr><td><del>cooluc</del></td><td>❌</td><td>❌</td><td>❌</td><td>❌</td><td>dns.cooluc.com</td><td><a href="https://dns.cooluc.com/dns-query">https://dns.cooluc.com/dns-query</a></td></tr><tr><td>ipv4dns.com</td><td><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://s2.loli.net/2024/06/14/dh7iSMjoafQXlBV.png" alt="20240614140216"></td><td>❌</td><td>❌</td><td>🌟🌟🌟</td><td>dns.ipv4dns.com</td><td><a href="https://dns.ipv4dns.com/dns-query">https://dns.ipv4dns.com/dns-query</a></td></tr><tr><td>66a.net</td><td><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://s2.loli.net/2024/06/14/EtZMJfHIyFBx5rQ.png"></td><td>❌</td><td>❌</td><td>🌟🌟🌟</td><td>❌</td><td><a href="https://dns.66a.net/sc.html">https://dns.66a.net/sc.html</a> 自助生成</td></tr><tr><td>18bit.cn</td><td><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://s2.loli.net/2024/06/14/NTXnPrbVQLsYmAj.png"></td><td>❌</td><td>❌</td><td>🌟🌟🌟</td><td>❌</td><td><a href="https://doh.18bit.cn/dns-query">https://doh.18bit.cn/dns-query</a></td></tr></tbody></table><ul><li>cooluc是OpenWRT Mosdns Luci插件作者搭的，大神比较低调，<del>虽然部署在国内，但在特殊时期也会关机保平安</del> 该 DNS 服务将于 2024-08-20 停止服务</li></ul><h2 id="综上所述"><a href="#综上所述" class="headerlink" title="综上所述"></a>综上所述</h2><p>如果你需要选择公共 <code>DNS</code> 的话同时需要获得尽可能友好的 CDN 解析结果，解析国内站点推荐使用阿里 <code>DNS</code> 和腾讯 <code>DNSPod</code>（注重稳定请用前者、注重准确请用后者）；解析海外网站推荐主 <code>DNS</code> <code>1.1.1.1</code>。</p><p>而我个人是目前使用的<code>18bit</code>，之前用的EasyMosdns免费版由于负载过高导致体验变差，而付费版本需要25元一个季度，感觉不是很值得，所以暂时还是使用的免费版。</p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;2024.6.14 update： 更新小众DNS服务，增加了一些小厂商的DNS服务。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;由于之前用的公共DNS开始变得不稳定，所以重新找一下目前市面上常见的和可能好用的DNS Server。&lt;/p&gt;
&lt;p&gt;选择适合的公共 DNS 对于在中国大陆使用互联网是非常重要的，因为它可以影响到你的网络连接速度、安全性和稳定性。&lt;/p&gt;
&lt;p&gt;主要需要考虑以下因素：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;速度和稳定性：选择一个能够提供良好速度和稳定性的公共 DNS 服务，以确保你的网络连接畅通。&lt;/li&gt;
&lt;li&gt;隐私和安全：一些公共 DNS 提供商可能会收集用户数据，因此你需要选择一个信誉良好、注重隐私保护的服务。&lt;/li&gt;
&lt;li&gt;支持的功能：一些公共 DNS 可能支持额外的功能，如安全过滤、家长控制等，根据你的需求选择合适的服务。&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="dns" scheme="https://zyha.cn/categories/dns/"/>
    
    
    <category term="dns" scheme="https://zyha.cn/tags/dns/"/>
    
    <category term="free" scheme="https://zyha.cn/tags/free/"/>
    
    <category term="安全" scheme="https://zyha.cn/tags/%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>使用Lambda监控Lightsail流量限额并超额自动关机</title>
    <link href="https://zyha.cn/use-lambda-to-monitor-lightsail-traffic-limit-and-auto-shutdown-when-exceeding-the-limit/"/>
    <id>https://zyha.cn/use-lambda-to-monitor-lightsail-traffic-limit-and-auto-shutdown-when-exceeding-the-limit/</id>
    <published>2024-03-01T01:03:23.000Z</published>
    <updated>2024-03-01T01:03:23.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>虽然之前写过一篇<a href="https://zyha.cn/">《如何最大限度避免AWS天价账单》</a>，但是这篇文章只做了流量超出提醒，没有提到如何自动关机<del>导致我没注意到邮件而被背刺了</del>。所以这次我打算写一篇关于如何使用Lambda监控Lightsail流量限额并超额自动关机的文章。</p><p>以此纪念上个月我被aws背刺的30刀。</p><span id="more"></span><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>利用Amazon的Lambda函数计算（100W次以内免费），配合Amazon提供的官方Lightsail API，设置定时任务，每10分钟获取当前流量限额和已使用流量，进行对比，如果达到限额的95%，则关闭Lightsail实例：</p><ul><li>利用 <code>Lightsail</code> 的 <code>API</code> 接口： <code>get_instance</code> ，获取账号下在当前区域里的所有 <code>Lightsail</code> 实例。</li><li>根据 <code>Lightsail</code> 实例的类型，获取每个实例每个月的网络流量配额。</li><li>根据实例的创建时间，计算出每个实例在当前这个计费周期内的流量配额。</li><li>通过 <code>API</code> 接口：<code>get_instance_metric_data</code>，获取每个实例已经使用的入站和出站流量总量。</li><li>如果流量超出当前计费周期的配额的<code>95%</code>，并关闭对应的 <code>Lightsail</code> 实例。</li><li>通过 <code>EventBridge</code> 以 <code>cron job</code> 的方式定时触发 <code>Lambda</code>，运行此检查逻辑。</li></ul><h2 id="正式开始"><a href="#正式开始" class="headerlink" title="正式开始"></a>正式开始</h2><h3 id="创建Lambda函数"><a href="#创建Lambda函数" class="headerlink" title="创建Lambda函数"></a>创建Lambda函数</h3><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://cdn.zyha.cn/blog/a357ffbb527587be4af3cf46b73d5a9d5b124997988e222f4ae4d9019c26adcd.png?x-oss-process=style/blog" alt="aws-lambda-create"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> boto3</span><br><span class="line"><span class="keyword">import</span> calendar</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, date, time,timedelta</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_current_month_first_day_zero_time</span>():</span><br><span class="line">    today = date.today()</span><br><span class="line">    first_day = today.replace(day=<span class="number">1</span>)</span><br><span class="line">    first_day_zero_time = datetime.combine(first_day, time.<span class="built_in">min</span>)</span><br><span class="line">    <span class="keyword">return</span> first_day_zero_time</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_current_month_last_day_last_time</span>():</span><br><span class="line">    today = date.today()</span><br><span class="line">    last_day = today.replace(day=calendar.monthrange(today.year, today.month)[<span class="number">1</span>])</span><br><span class="line">    last_day_last_time = datetime.combine(last_day, time(<span class="number">23</span>, <span class="number">59</span>, <span class="number">59</span>))</span><br><span class="line">    <span class="keyword">return</span> last_day_last_time</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">stop_instance</span>(<span class="params">instance_name</span>):</span><br><span class="line">    client = boto3.client(<span class="string">&#x27;lightsail&#x27;</span>)</span><br><span class="line">    response = client.stop_instance(</span><br><span class="line">        instanceName=instance_name,</span><br><span class="line">        force=<span class="literal">True</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">list_instances</span>(<span class="params">instances_list</span>):</span><br><span class="line">    client = boto3.client(<span class="string">&#x27;lightsail&#x27;</span>)</span><br><span class="line">    paginator = client.get_paginator(<span class="string">&#x27;get_instances&#x27;</span>)</span><br><span class="line">    <span class="comment"># Create a PageIterator from the Paginator</span></span><br><span class="line">    page_iterator = paginator.paginate()</span><br><span class="line">    <span class="keyword">for</span> page <span class="keyword">in</span> page_iterator:</span><br><span class="line">        <span class="keyword">for</span> instance <span class="keyword">in</span> page[<span class="string">&#x27;instances&#x27;</span>]:</span><br><span class="line">            <span class="built_in">print</span>(instance[<span class="string">&#x27;name&#x27;</span>])</span><br><span class="line">            instances_list.append(instance[<span class="string">&#x27;name&#x27;</span>])</span><br><span class="line">        </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_month_dto_quota</span>(<span class="params">instance_name</span>):</span><br><span class="line">    client = boto3.client(<span class="string">&#x27;lightsail&#x27;</span>)</span><br><span class="line">    response = client.get_instance(</span><br><span class="line">        instanceName=instance_name</span><br><span class="line">    )</span><br><span class="line">    <span class="comment">#print(&quot;response : &#123;&#125;&quot;.format(response))</span></span><br><span class="line">    dto_quota = response[<span class="string">&#x27;instance&#x27;</span>][<span class="string">&#x27;networking&#x27;</span>][<span class="string">&#x27;monthlyTransfer&#x27;</span>][<span class="string">&#x27;gbPerMonthAllocated&#x27;</span>]</span><br><span class="line">    current_datetime = datetime.now()</span><br><span class="line">    instance_created_datetime = response[<span class="string">&#x27;instance&#x27;</span>][<span class="string">&#x27;createdAt&#x27;</span>]</span><br><span class="line">    <span class="keyword">if</span> (instance_created_datetime.year == current_datetime.year) <span class="keyword">and</span> (instance_created_datetime.month == current_datetime.month):</span><br><span class="line">        month_ts = get_current_month_last_day_last_time().timestamp() - get_current_month_first_day_zero_time().timestamp()</span><br><span class="line">        instance_valide_ts = get_current_month_last_day_last_time().timestamp() - instance_created_datetime.timestamp()</span><br><span class="line">        dto_quota = (instance_valide_ts/month_ts) * dto_quota</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;created in current month, quota: &#123;&#125;GB&quot;</span>.<span class="built_in">format</span>(dto_quota))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        dto_quota = response[<span class="string">&#x27;instance&#x27;</span>][<span class="string">&#x27;networking&#x27;</span>][<span class="string">&#x27;monthlyTransfer&#x27;</span>][<span class="string">&#x27;gbPerMonthAllocated&#x27;</span>]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;created in previous month, full quota: &#123;&#125;GB&quot;</span>.<span class="built_in">format</span>(dto_quota))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> dto_quota</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_instance_data_usage</span>(<span class="params">instance_name, data_type</span>):</span><br><span class="line">    client = boto3.client(<span class="string">&#x27;lightsail&#x27;</span>)</span><br><span class="line">    current_time = datetime.utcnow()</span><br><span class="line">    start_time = get_current_month_first_day_zero_time()</span><br><span class="line">    end_time = get_current_month_last_day_last_time()</span><br><span class="line">    start_time_str = start_time.strftime(<span class="string">&#x27;%Y-%m-%dT%H:%M:%SZ&#x27;</span>)</span><br><span class="line">    end_time_str = end_time.strftime(<span class="string">&#x27;%Y-%m-%dT%H:%M:%SZ&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">    response = client.get_instance_metric_data(</span><br><span class="line">        instanceName=instance_name,</span><br><span class="line">        metricName=data_type,</span><br><span class="line">        period= <span class="number">6</span> * <span class="number">600</span> * <span class="number">24</span>,</span><br><span class="line">        unit=<span class="string">&#x27;Bytes&#x27;</span>,</span><br><span class="line">        statistics=[</span><br><span class="line">            <span class="string">&#x27;Sum&#x27;</span></span><br><span class="line">        ],</span><br><span class="line">        startTime=start_time_str,</span><br><span class="line">        endTime=end_time_str </span><br><span class="line">    )</span><br><span class="line"> </span><br><span class="line">    data_points = response[<span class="string">&#x27;metricData&#x27;</span>]</span><br><span class="line">    total_data_usage = <span class="built_in">sum</span>([data_point[<span class="string">&#x27;sum&#x27;</span>] <span class="keyword">for</span> data_point <span class="keyword">in</span> data_points])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;total &#123;&#125; usage: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(data_type, total_data_usage))</span><br><span class="line">    <span class="keyword">return</span> total_data_usage</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">push_notification</span>(<span class="params">arn, msg</span>):</span><br><span class="line">    sns_client = boto3.client(<span class="string">&#x27;sns&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;sqs arn: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(arn))</span><br><span class="line">    response = sns_client.publish(</span><br><span class="line">        TopicArn=arn,</span><br><span class="line">        Message=msg,</span><br><span class="line">        Subject=<span class="string">&#x27;Lightsail NetworkOut exceeded quota &#x27;</span></span><br><span class="line">    )</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lambda_handler</span>(<span class="params">event, context</span>):</span><br><span class="line">    instance_name= []</span><br><span class="line">    list_instances(instance_name)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> instance_name:</span><br><span class="line">        quota = get_month_dto_quota(i) * <span class="number">1000</span> * <span class="number">1000</span> * <span class="number">1000</span></span><br><span class="line">        total = get_instance_data_usage(i, <span class="string">&quot;NetworkOut&quot;</span>) + get_instance_data_usage(i, <span class="string">&quot;NetworkIn&quot;</span>) </span><br><span class="line">        msg = <span class="string">f&quot;instance_name: <span class="subst">&#123;i&#125;</span> \nusage: <span class="subst">&#123;total&#125;</span> Byte \nquota: <span class="subst">&#123;quota&#125;</span> Byte \nusage percent: <span class="subst">&#123;(total/quota)*<span class="number">100</span>&#125;</span> %&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(msg)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">int</span>(quota) * <span class="number">0.95</span>) &lt; <span class="built_in">int</span>(total):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;(quota * 0.95) &lt; total, soforce close instance: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="number">1</span>))</span><br><span class="line">            stop_instance(i)</span><br><span class="line">             </span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="string">&#x27;statusCode&#x27;</span>: <span class="number">200</span>,</span><br><span class="line">        <span class="string">&#x27;body&#x27;</span>: json.dumps(<span class="string">&#x27;total_data_usage from Lambda!&#x27;</span>)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>设置内存为512MB，超时时间为3分钟。</p><h3 id="创建新策略"><a href="#创建新策略" class="headerlink" title="创建新策略"></a>创建新策略</h3><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://cdn.zyha.cn/blog/20240301095032.png?x-oss-process=style/blog" alt="20240301095032"></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;Version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2012-10-17&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;Statement&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;Action&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;lightsail:GetInstance&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;lightsail:GetInstanceMetricData&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;lightsail:GetInstances&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;lightsail:StopInstance&quot;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Effect&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Allow&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Resource&quot;</span><span class="punctuation">:</span> <span class="string">&quot;*&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="创建触发器"><a href="#创建触发器" class="headerlink" title="创建触发器"></a>创建触发器</h3><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://cdn.zyha.cn/blog/20240301095802.png?x-oss-process=style/blog" alt="20240301095802"></p><p>时间设置为<code>cron(0/10 * * * ? *)</code>，每十分钟触发一次。</p><h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://cdn.zyha.cn/blog/20240301100535.png?x-oss-process=style/blog" alt="20240301100535"></p><p>此时就已经基本完成配置了。</p><p>Lambda函数每10分钟执行一次，符合条件就会自动关闭实例。</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://www.nodeseek.com/post-73756-1">https://www.nodeseek.com/post-73756-1</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;虽然之前写过一篇&lt;a href=&quot;https://zyha.cn/&quot;&gt;《如何最大限度避免AWS天价账单》&lt;/a&gt;，但是这篇文章只做了流量超出提醒，没有提到如何自动关机&lt;del&gt;导致我没注意到邮件而被背刺了&lt;/del&gt;。所以这次我打算写一篇关于如何使用Lambda监控Lightsail流量限额并超额自动关机的文章。&lt;/p&gt;
&lt;p&gt;以此纪念上个月我被aws背刺的30刀。&lt;/p&gt;</summary>
    
    
    
    <category term="aws" scheme="https://zyha.cn/categories/aws/"/>
    
    
    <category term="aws" scheme="https://zyha.cn/tags/aws/"/>
    
    <category term="lightsail" scheme="https://zyha.cn/tags/lightsail/"/>
    
    <category term="lambda" scheme="https://zyha.cn/tags/lambda/"/>
    
  </entry>
  
  <entry>
    <title>Web应用性能测试优化总结</title>
    <link href="https://zyha.cn/web-performance-test-summary/"/>
    <id>https://zyha.cn/web-performance-test-summary/</id>
    <published>2024-02-10T01:17:41.000Z</published>
    <updated>2024-02-10T01:17:41.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>最近某个 <code>Web</code> 项目处于开发阶段，要求设计支持上万用户在线的场景。因此需要对应用整体进行性能评估，以便确认应用整体的可容纳在线用户数，因此有性能测试的需要。</p><p>经过评估，我们的应用架构是典型的 <code>SPA (Vue)</code> + 后端 + 数据库应用，因此决定分开评测各自的性能，以便发现各自的性能问题，最终再集成整体评测。</p><p>因此我们分为了三个不同类型的性能测试:</p><ul><li>数据库(PostgreSQL)性能测试</li><li>后端(Nest.js)性能测试</li><li>前端(Vue+Vite)性能测试</li></ul><p>本文分别总结这三个不同场景的性能测试。</p><p>PS: 由于后端部署的环境是 <code>AWS Lightsail</code>，因此我们使用 <code>AWS</code> 提供的 <code>RDS</code> 作为数据库，国内云服务可能部分场景有不同，请考虑相关的替代品。</p><span id="more"></span><h2 id="数据库性能测试"><a href="#数据库性能测试" class="headerlink" title="数据库性能测试"></a>数据库性能测试</h2><p>我们测试的目的是为了发现我们的 <code>SQL</code> 是否会因为数据量大的情况下导致性能下降，因此我们需要先准备好大量的测试数据（填充数据库即可，无需在乎数据质量），然后大规模运行应用程序中可能用到的 <code>SQL</code>，以便发现数据库设计是否有缺陷，<code>SQL</code> 是否有性能问题等等。</p><p>我们使用的数据库为 <code>PostgreSQL</code>，而 <code>PostgreSQL</code> 官方本身就有个性能测试工具<code>pgbench</code>可以实现这一需求。我们直接使用它即可。</p><p><code>pgbench</code>是 <code>PostgreSQL</code> 官方的性能测试工具，它自带有一组脚本，可以默认创建一个数据库并填充自己的数据表，然后运行自己的 <code>SQL</code> 脚本跑测试。显然默认的脚本和配置只能评测数据库服务器本身的性能，并不能发现我们的数据库设计和应用使用的 <code>SQL</code> 的性能隐患，因此我们需要定制 <code>pgbench</code> 的脚本。</p><p>我们需要创建应用自己的数据库（借助 <code>prisma migration</code> 工具完成），然后填充大量的测试数据，最好有一定的随机性。我们自己写个<code>seed.sql</code>，大体内容如下:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 这里我们用generate_series函数生成大量的记录行</span></span><br><span class="line"><span class="comment">-- coln_expr可以使用一些诸如random()函数产生一些随机性</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> my_table (</span><br><span class="line">    col1,</span><br><span class="line">    col2,</span><br><span class="line">    col3,...</span><br><span class="line">    coln</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span> col1_expr, col2_expr, col3_expr, ..., coln_expr</span><br><span class="line"><span class="keyword">FROM</span> generate_series(<span class="number">1</span>, <span class="number">1000000</span>);</span><br></pre></td></tr></table></figure><p>我们生成了 100 万条随机记录，可以使用命令<code>psql -f ./seed.sql db</code>向目标数据库插入这 100 万条记录，作为数据准备。</p><p>然后我们需要准备性能测试过程运行的 SQL 语句，再写一个benchmark.sql:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 注意整个benchmark要求必须包裹在整个事务中，因此必须使用BEGIN-END包裹</span></span><br><span class="line"><span class="comment">-- \set是pgbench扩展，可以用于设置一些变量，方便构造随机参数</span></span><br><span class="line"><span class="comment">-- pgbench 可选函数和命令参考官方文档： https://www.postgresql.org/docs/current/pgbench.html</span></span><br><span class="line"></span><br><span class="line">\<span class="keyword">set</span> var1_random random(<span class="number">0</span>, <span class="number">2</span>)</span><br><span class="line">\<span class="keyword">set</span> var2_random random(<span class="number">0</span>, <span class="number">5</span>)</span><br><span class="line">\<span class="keyword">set</span> num random(<span class="number">1</span>, <span class="number">100000</span> <span class="operator">*</span> :scale)</span><br><span class="line">\<span class="keyword">set</span> var3_random random(<span class="number">0</span>, <span class="number">2</span>)</span><br><span class="line">\<span class="keyword">set</span> var4_random hash(:num)</span><br><span class="line"></span><br><span class="line"><span class="keyword">BEGIN</span>;</span><br><span class="line"><span class="keyword">SELECT</span> col1, col2 <span class="keyword">from</span> my_table <span class="keyword">WHERE</span> col1 <span class="operator">=</span> :var1 <span class="keyword">AND</span> col2 <span class="operator">=</span> :var2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">UPDATE</span> my_table <span class="keyword">SET</span> col3 <span class="operator">=</span> :var3 <span class="keyword">WHERE</span> col4 <span class="operator">=</span> :var4;</span><br><span class="line"></span><br><span class="line"><span class="keyword">UPDATE</span> my_table <span class="keyword">SET</span> col2 <span class="operator">=</span> :var2 <span class="keyword">WHERE</span> some_expr;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> my_table (</span><br><span class="line">        col1, col2, col3, col4, ... , coln</span><br><span class="line">    )</span><br><span class="line"><span class="keyword">VALUES</span> (...);</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure><p>我们的应用主要使用这几种 SQL 语句，构造好参数之后就可以运行了:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pgbench <span class="operator">-</span>r <span class="operator">-</span>j2 <span class="operator">-</span>c10 <span class="operator">-</span>T120 <span class="operator">-</span>n <span class="operator">-</span>f .<span class="operator">/</span>benchmark.sql db</span><br></pre></td></tr></table></figure><p>我们用 2 线程运行，每个线程运行 10 个客户端，总共运行 2 分钟（120 秒），最终得到的结果大体如下:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">pgbench (<span class="number">14.5</span> (Ubuntu <span class="number">14.5</span><span class="number">-0</span>ubuntu0<span class="number">.22</span><span class="number">.04</span><span class="number">.1</span>))</span><br><span class="line">transaction type: .<span class="operator">/</span>benchmark.sql</span><br><span class="line">scaling factor: <span class="number">1</span></span><br><span class="line">query mode: simple</span><br><span class="line">number <span class="keyword">of</span> clients: <span class="number">10</span></span><br><span class="line">number <span class="keyword">of</span> threads: <span class="number">2</span></span><br><span class="line">duration: <span class="number">600</span> s</span><br><span class="line">number <span class="keyword">of</span> transactions actually processed: <span class="number">6426</span></span><br><span class="line">latency average <span class="operator">=</span> <span class="number">934.322</span> ms</span><br><span class="line"><span class="keyword">initial</span> connection <span class="type">time</span> <span class="operator">=</span> <span class="number">171.960</span> ms</span><br><span class="line">tps <span class="operator">=</span> <span class="number">10.702950</span> (<span class="keyword">without</span> <span class="keyword">initial</span> connection <span class="type">time</span>)</span><br><span class="line">statement latencies <span class="keyword">in</span> milliseconds:</span><br><span class="line">         <span class="number">4.767</span>  <span class="keyword">BEGIN</span>;</span><br><span class="line">       <span class="number">160.203</span>  <span class="keyword">SELECT</span> xxx,</span><br><span class="line">       <span class="number">176.959</span>  <span class="keyword">UPDATE</span> xxx</span><br><span class="line">       <span class="number">188.223</span>  <span class="keyword">UPDATE</span> xx</span><br><span class="line">       <span class="number">188.389</span>  <span class="keyword">UPDATE</span> xxx</span><br><span class="line">       <span class="number">187.733</span>  <span class="keyword">UPDATE</span> xx</span><br><span class="line">        <span class="number">18.776</span>  <span class="keyword">INSERT</span> <span class="keyword">INTO</span> xxx (</span><br><span class="line">         <span class="number">9.352</span>  <span class="keyword">END</span>;</span><br></pre></td></tr></table></figure><p>可以清楚的看到每个 SQL 大体上的延迟是多少，就能发现是否存在慢查询以及需要优化的部分了。</p><p>最初我们发现 INSERT 语句延迟较低，而其他 SELECT 和 UPDATE 延迟非常高，因此推断 RDS 实例性能较低，于是升级 RDS 实例规格，并且存储改为 <code>SSD</code> 存储实例之后，性能显著提升，问题得到解决。</p><p>PS: 大部分情况下，升级配置是很好的性能优化手段：）</p><h2 id="后端性能测试"><a href="#后端性能测试" class="headerlink" title="后端性能测试"></a>后端性能测试</h2><p>在数据库的性能测试完成之后，我们可以将数据准备部分复用，直接给后端性能测试的准备数据阶段使用。</p><p>后端性能测试过程中，我们需要模拟大量用户访问后端 API 的情况，以便发现后端 API 处理过程中的性能问题。</p><p>特别注意如果后端有调用第三方接口的情况，需要在测试前进行屏蔽相关功能，或者进行 Mock 接口，防止压力测试中对第三方接口请求量太大从而耗尽配额或者被 ban。</p><p>这里我们选用了 <code>artillery</code> 这个开源工具跑压力测试，因为它使用比较简单，而且未来会有云服务，方便跑分布式压测场景。不过当前版本已经支持运行在 <code>AWS Lambda</code>，我们可以利用这个特性跑简单的分布式压力测试场景。</p><p>我们需要编写好 artillery 的 yaml 配置文件，这里建议参考官方文档，有大量的范例可供参考： <code>https://github.com/artilleryio/artillery/tree/main/examples</code></p><p>我们在 lambda 上运行，启动 40 个 lambda 实例跑测试:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">artillery run --platform aws:lambda --platform-opt region=us-west-1 --count=40 -o result.json config.yml</span><br></pre></td></tr></table></figure><p>得到结果</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">--------------------------------</span><br><span class="line">Summary report @ 11:50:26(+0800)</span><br><span class="line">--------------------------------</span><br><span class="line"></span><br><span class="line">http.codes.200: ................................................................ 37927</span><br><span class="line">http.codes.201: ................................................................ 60978</span><br><span class="line">http.codes.400: ................................................................ 23046</span><br><span class="line">http.codes.502: ................................................................ 2</span><br><span class="line">http.request_rate: ............................................................. 144/sec</span><br><span class="line">http.requests: ................................................................. 121953</span><br><span class="line">http.response_time:</span><br><span class="line">  min: ......................................................................... 4</span><br><span class="line">  max: ......................................................................... 11839</span><br><span class="line">  median: ...................................................................... 1085.9</span><br><span class="line">  p95: ......................................................................... 5944.6</span><br><span class="line">  p99: ......................................................................... 7407.5</span><br><span class="line">http.responses: ................................................................ 121953</span><br><span class="line">plugins.metrics-by-endpoint.GET /endpoint1/:argument.codes.200: ................ 30441</span><br><span class="line">plugins.metrics-by-endpoint.POST /endpoint1 (offchain).codes.201: .............. 30590</span><br><span class="line">plugins.metrics-by-endpoint.POST /endpoint1 (offchain).codes.502: .............. 1</span><br><span class="line">plugins.metrics-by-endpoint.POST /endpoint1 (onchain).codes.201: ............... 30388</span><br><span class="line">plugins.metrics-by-endpoint.POST /endpoint1 (onchain).codes.502: ............... 1</span><br><span class="line">plugins.metrics-by-endpoint.POST /endpoint2.codes.200: ......................... 7486</span><br><span class="line">plugins.metrics-by-endpoint.POST /endpoint2.codes.400: ......................... 23046</span><br><span class="line">plugins.metrics-by-endpoint.response_time.GET /endpoint1/:targetToken:</span><br><span class="line">  min: ......................................................................... 5</span><br><span class="line">  max: ......................................................................... 5966</span><br><span class="line">  median: ...................................................................... 645.6</span><br><span class="line">  p95: ......................................................................... 2018.7</span><br><span class="line">  p99: ......................................................................... 3464.1</span><br><span class="line">plugins.metrics-by-endpoint.response_time.POST /endpoint1 (offchain):</span><br><span class="line">  min: ......................................................................... 59</span><br><span class="line">  max: ......................................................................... 10607</span><br><span class="line">  median: ...................................................................... 2725</span><br><span class="line">  p95: ......................................................................... 6064.7</span><br><span class="line">  p99: ......................................................................... 7260.8</span><br><span class="line">plugins.metrics-by-endpoint.response_time.POST /endpoint1 (onchain):</span><br><span class="line">  min: ......................................................................... 68</span><br><span class="line">  max: ......................................................................... 11839</span><br><span class="line">  median: ...................................................................... 3464.1</span><br><span class="line">  p95: ......................................................................... 7117</span><br><span class="line">  p99: ......................................................................... 8024.5</span><br><span class="line">plugins.metrics-by-endpoint.response_time.POST /endpoint2:</span><br><span class="line">  min: ......................................................................... 4</span><br><span class="line">  max: ......................................................................... 10146</span><br><span class="line">  median: ...................................................................... 391.6</span><br><span class="line">  p95: ......................................................................... 3752.7</span><br><span class="line">  p99: ......................................................................... 5944.6</span><br><span class="line">vusers.completed: .............................................................. 121953</span><br><span class="line">vusers.created: ................................................................ 121953</span><br><span class="line">vusers.created_by_name.GET /endpoint1/:targetToken: ............................ 30441</span><br><span class="line">vusers.created_by_name.POST /endpoint1 (offchain): ............................. 30591</span><br><span class="line">vusers.created_by_name.POST /endpoint1 (onchain): .............................. 30389</span><br><span class="line">vusers.created_by_name.POST /endpoint2: ........................................ 30532</span><br><span class="line">vusers.failed: ................................................................. 0</span><br><span class="line">vusers.session_length:</span><br><span class="line">  min: ......................................................................... 11</span><br><span class="line">  max: ......................................................................... 11847.7</span><br><span class="line">  median: ...................................................................... 1176.4</span><br><span class="line">  p95: ......................................................................... 5944.6</span><br><span class="line">  p99: ......................................................................... 7407.5</span><br><span class="line">vusers.skipped: ................................................................ 35146</span><br><span class="line">Log file: result.json</span><br><span class="line"></span><br><span class="line">Estimated AWS Lambda cost <span class="keyword">for</span> this <span class="built_in">test</span>: <span class="variable">$0</span>.1833</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>通过测试结果，发现了某些 <code>endpoint</code> 接口运行较慢，经过进一步排查最终定位到性能下降的原因进行优化即可。</p><p>最初通过测试报告发现，不请求数据库的 API 性能很高，反之如果 API 有数据库的调用，则压测之后延迟非常高，甚至还有超时错误。最终排查之后发现还是是数据库连接池的库性能较差，更换新的数据库 driver，并且优化部分 SQL 之后性能问题得到很大的改善。</p><h2 id="前端性能测试"><a href="#前端性能测试" class="headerlink" title="前端性能测试"></a>前端性能测试</h2><p>前端性能测试主要包含用户的加载页面速度和页面渲染的速度两方面，我们可以通过配合 <code>lighthouse</code> 和 <code>artillery + playwright</code> 实现。</p><p><code>lighthouse</code> 可以重点帮助分析页面渲染方面的最佳实践，而 <code>artillery + playwright</code> 的组合可以方便的模拟大量用户反复点击某些页面之后，页面加载速度的情况，可以更准确的得到页面相关的 FCP 等重要参数。</p><p>特别注意 <code>playwright</code> 运行浏览器的时候，如果需要加载浏览器插件，无法通过访问在线商店的方式进行安装，必须将插件下载到本地之后使用 <code>playwright API</code>进行加载。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">--------------------------------</span><br><span class="line">Summary report @ 17:24:38(+0000)</span><br><span class="line">--------------------------------</span><br><span class="line"></span><br><span class="line">browser.http_requests: ......................................................... 4392</span><br><span class="line">browser.page.CLS.e2e <span class="built_in">test</span>:</span><br><span class="line">  min: ......................................................................... 0</span><br><span class="line">  max: ......................................................................... 0</span><br><span class="line">  median: ...................................................................... 0</span><br><span class="line">  p95: ......................................................................... 0</span><br><span class="line">  p99: ......................................................................... 0</span><br><span class="line">browser.page.FCP.e2e <span class="built_in">test</span>:</span><br><span class="line">  min: ......................................................................... 311.1</span><br><span class="line">  max: ......................................................................... 1307.7</span><br><span class="line">  median: ...................................................................... 415.8</span><br><span class="line">  p95: ......................................................................... 925.4</span><br><span class="line">  p99: ......................................................................... 1249.1</span><br><span class="line">browser.page.FID.e2e <span class="built_in">test</span>:</span><br><span class="line">  min: ......................................................................... 1.7</span><br><span class="line">  max: ......................................................................... 22.2</span><br><span class="line">  median: ...................................................................... 2.5</span><br><span class="line">  p95: ......................................................................... 9.5</span><br><span class="line">  p99: ......................................................................... 12.6</span><br><span class="line">browser.page.LCP.e2e <span class="built_in">test</span>:</span><br><span class="line">  min: ......................................................................... 726.6</span><br><span class="line">  max: ......................................................................... 2226.1</span><br><span class="line">  median: ...................................................................... 788.5</span><br><span class="line">  p95: ......................................................................... 2018.7</span><br><span class="line">  p99: ......................................................................... 2143.5</span><br><span class="line">browser.page.TTFB.e2e <span class="built_in">test</span>:</span><br><span class="line">  min: ......................................................................... 35.5</span><br><span class="line">  max: ......................................................................... 494</span><br><span class="line">  median: ...................................................................... 48.9</span><br><span class="line">  p95: ......................................................................... 125.2</span><br><span class="line">  p99: ......................................................................... 478.3</span><br><span class="line">vusers.completed: .............................................................. 28</span><br><span class="line">vusers.created: ................................................................ 36</span><br><span class="line">vusers.created_by_name.e2e <span class="built_in">test</span>: ............................................... 36</span><br><span class="line">vusers.failed: ................................................................. 8</span><br><span class="line">vusers.session_length:</span><br><span class="line">  min: ......................................................................... 3314.8</span><br><span class="line">  max: ......................................................................... 6396.5</span><br><span class="line">  median: ...................................................................... 3534.1</span><br><span class="line">  p95: ......................................................................... 5826.9</span><br><span class="line">  p99: ......................................................................... 6187.2</span><br><span class="line">vusers.skipped: ................................................................ 204</span><br><span class="line">Log file: result.json</span><br></pre></td></tr></table></figure><p>特别注意 <code>playwright</code> 当前无法在 <code>lambda</code> 环境下运行。</p><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>本文我们大体总结了一个 Web 应用在性能测试方面的套路，以便指导发现应用的性能问题，从而优化应用本身。</p>]]></content>
    
    
    <summary type="html">本文总结了一个 Web 应用在性能测试方面的套路，以便指导发现应用的性能问题，从而优化应用本身。</summary>
    
    
    
    <category term="优化" scheme="https://zyha.cn/categories/%E4%BC%98%E5%8C%96/"/>
    
    
    <category term="性能测试" scheme="https://zyha.cn/tags/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/"/>
    
    <category term="web" scheme="https://zyha.cn/tags/web/"/>
    
    <category term="sql" scheme="https://zyha.cn/tags/sql/"/>
    
  </entry>
  
  <entry>
    <title>prisma使用3个月有感</title>
    <link href="https://zyha.cn/prisma-has-been-used-for-3-months/"/>
    <id>https://zyha.cn/prisma-has-been-used-for-3-months/</id>
    <published>2023-10-08T14:46:04.000Z</published>
    <updated>2024-06-07T03:06:04.000Z</updated>
    
    <content type="html"><![CDATA[<p>用了3个月的prisma，作为和TypeOrm可以说占据了大部分的node后端orm份额，但实际我个人用起来，虽然在参数类型上比较方便，但其他还有值得改进的点，但官方给人的感觉就很傲慢，就这个态度，在我看来目前还称不上<code>下一代ORM</code>。</p><p>因为本人主要做前端开发，写后端只是顺带，所以一定会有不了解的地方。以下为个人使用过程中遇到的，仅作记录。</p><ul><li>2024.4.21 更新： <code>5.12.0</code> 发布，sqlite支持了<code>createMany</code>方法。</li><li>2024.6.7 更新： <code>5.15.0</code> 发布，支持拆分配置文件<span id="more"></span></li></ul><h2 id="不错的点"><a href="#不错的点" class="headerlink" title="不错的点"></a>不错的点</h2><h3 id="提供操作的类型可以直接使用"><a href="#提供操作的类型可以直接使用" class="headerlink" title="提供操作的类型可以直接使用"></a>提供操作的类型可以直接使用</h3><p>比如，我想插入一条user数据，我可以直接使用<code>Prisma.UserCreateInput</code>，而不需要自己定义一个<code>interface</code>，这点我觉得非常不错。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="title function_">create</span>(<span class="attr">data</span>: <span class="title class_">Prisma</span>.<span class="property">UserCreateInput</span>): <span class="title class_">Promise</span>&lt;<span class="title class_">User</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      data.<span class="property">password</span> = <span class="keyword">await</span> <span class="title function_">hashPassword</span>(data.<span class="property">password</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">prisma</span>.<span class="property">user</span>.<span class="title function_">create</span>(&#123;</span><br><span class="line">        data,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">HttpExceptionFilter</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>除了<code>Prisma.UserCreateInput</code>，还有<code>Prisma.UserUpdateInput</code>，<code>Prisma.UserWhereUniqueInput</code>等等，这些都是prisma自动生成的，非常方便。但是仍然有不完美的地方就是，自动生成的类型无法在swagger中直接使用，</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiBody</span>(&#123; <span class="attr">type</span>: <span class="function">() =&gt;</span> <span class="title class_">Prisma</span>.<span class="property">UserUpdateInput</span> &#125;)</span><br><span class="line"><span class="comment">// error TS2339: Property &#x27;UserCreateInput&#x27; does not exist on type &#x27;typeof Prisma&#x27;.</span></span><br></pre></td></tr></table></figure><p>需要自己去implements一下。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">CreateUserDto</span> <span class="keyword">implements</span> <span class="title class_">Prisma</span>.<span class="property">UserCreateInput</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ApiBody</span>(&#123; <span class="attr">type</span>: <span class="function">() =&gt;</span> <span class="title class_">CreateUserDto</span> &#125;)</span><br></pre></td></tr></table></figure><h2 id="社区认为值得改进但官方并不重视"><a href="#社区认为值得改进但官方并不重视" class="headerlink" title="社区认为值得改进但官方并不重视"></a>社区认为值得改进但官方并不重视</h2><h3 id="issue及pr处理不积极"><a href="#issue及pr处理不积极" class="headerlink" title="issue及pr处理不积极"></a>issue及pr处理不积极</h3><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://cdn.zyha.cn/blog/20240607130914.png?x-oss-process=style/blog" alt="20240607130914"></p><p>官方仓库<a href="https://github.com/prisma/prisma">prisma&#x2F;prisma</a>的<code>issue</code>及<code>pr</code>处理速度非常慢，而且很多<code>issue</code>都没有回复，且已经提了的pr也长期不处理。</p><p>在issue提出的问题，如果官方认为社区可以解决是会马上被转移至Discussion区的，所以可见接近3k的issue是值得官方来进行解决和说明的。</p><h3 id="核心功能缺失"><a href="#核心功能缺失" class="headerlink" title="核心功能缺失"></a><del>核心功能缺失</del></h3><p><strong>prisma 5.12.0 版本，sqlite已经支持<code>createMany</code>方法。猜测一下，多半是因为其竞品<code>drizzle</code>以及<code>cloudflare D1</code>正式发布的原因</strong></p><p>我开始的时候使用<code>SQLite</code>进行开发，但是在使用过程中发现<code>prisma</code>的<code>Sqlite</code>支持非常不完善，甚至可以说是部分功能完全不可用，比如说：</p><ul><li><code>createMany</code>，作为<code>ORM</code>，我个人认为这是最核心这个功能，然而在<code>Sqlite</code>中是不支持的，很久的<code>issue</code>了。<ul><li><a href="https://github.com/prisma/prisma/issues/21206">createMany is a very worth considering for testing in sqlite development mode #21206</a></li><li><a href="https://github.com/prisma/prisma/issues/10710">Add the createMany method to SQLite #10710</a></li><li><a href="https://github.com/prisma/prisma/issues/11507">prisma.model.createMany is not a function #11507</a></li></ul></li></ul><p><code>prisma</code>团队以性能问题，一直没有解决，这个功能在我看来是非常基础的功能。开发者也明确说明了不需要在乎性能，就是想做开发测试，但是<code>prisma</code>却仍然没有支持，这让我非常不解，最后不得不换到了<code>postgres</code>上。</p><h3 id="提出的优秀feat官方并不进行支持"><a href="#提出的优秀feat官方并不进行支持" class="headerlink" title="提出的优秀feat官方并不进行支持"></a>提出的优秀feat官方并不进行支持</h3><ul><li><del>不支持拆分配置文件。<code>prisma</code>的数据模型设计文件并非<code>.ts</code>，而是自定义的<code>*.prisma</code>。以我正在开发中的项目为例子，目前只设计了<code>62</code>张表，<code>schema.prisma</code>（<code>prisma</code>默认存放表结构的文件）已经<code>800+</code>行。</del> 最新版本已经支持。<ul><li><del><a href="https://github.com/prisma/prisma/issues/2377">Support for splitting Prisma schema into multiple files #2377</a></del></li></ul></li><li>不提供<code>@default(nanoid())</code>，只支持<code>@default(uuid())</code>。<ul><li><a href="https://github.com/prisma/prisma/issues/18612">Implement nanoid() #18612</a></li><li><a href="https://github.com/prisma/prisma/issues/17294">Make @default(nanoid()) alphabet configurable #17294</a></li></ul></li></ul><h3 id="Bug年久失修"><a href="#Bug年久失修" class="headerlink" title="Bug年久失修"></a>Bug年久失修</h3><ul><li>schema.prisma中定义，</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">model Answer &#123;</span><br><span class="line">  id String @id @default(cuid())</span><br><span class="line">  question Question @relation(fields: [questionId], references: [id], onDelete: Cascade)</span><br><span class="line">  questionId String</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后在代码中使用</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">create</span>(<span class="params">questionId: <span class="built_in">string</span>, input: AnswerInput</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">prisma</span>.<span class="property">answer</span>.<span class="title function_">create</span>(&#123;</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">    ...input,</span><br><span class="line">    questionId,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以上，看起来没错，但是， <a href="https://github.com/prisma/prisma/issues/15946">Type ‘string’ is not assignable to type ‘never’ #15946 - @DiogoMarques2003 opened this issue on Oct 24, 2022</a></p><h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>希望prisma能够越来越好，但是目前来看，我个人认为prisma还不够成熟，还有很多需要完善的feat。</p>]]></content>
    
    
    <summary type="html">prisma使用3个月有感,prisma是什么,prisma的优缺点</summary>
    
    
    
    <category term="后端" scheme="https://zyha.cn/categories/%E5%90%8E%E7%AB%AF/"/>
    
    
    <category term="sql" scheme="https://zyha.cn/tags/sql/"/>
    
    <category term="orm" scheme="https://zyha.cn/tags/orm/"/>
    
    <category term="api" scheme="https://zyha.cn/tags/api/"/>
    
  </entry>
  
</feed>
